"use strict";(globalThis.webpackChunkblog=globalThis.webpackChunkblog||[]).push([[414],{2987:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"\u4e2a\u4eba\u77e5\u8bc6\u5e93/\u8bed\u8a00\u77e5\u8bc6/Go/Go\u6a21\u5757\u5b66\u4e60/GoLand-net.http","title":"02.GoLand-net.http.md","description":"|\u4f5c\u8005|\u4fee\u8ba2\u65f6\u95f4|","source":"@site/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/05.\u8bed\u8a00\u77e5\u8bc6/03.Go/02.Go\u6a21\u5757\u5b66\u4e60/02.GoLand-net.http.md","sourceDirName":"\u4e2a\u4eba\u77e5\u8bc6\u5e93/05.\u8bed\u8a00\u77e5\u8bc6/03.Go/02.Go\u6a21\u5757\u5b66\u4e60","slug":"/\u4e2a\u4eba\u77e5\u8bc6\u5e93/\u8bed\u8a00\u77e5\u8bc6/Go/Go\u6a21\u5757\u5b66\u4e60/GoLand-net.http","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/\u8bed\u8a00\u77e5\u8bc6/Go/Go\u6a21\u5757\u5b66\u4e60/GoLand-net.http","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/05.\u8bed\u8a00\u77e5\u8bc6/03.Go/02.Go\u6a21\u5757\u5b66\u4e60/02.GoLand-net.http.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"fmt","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/\u8bed\u8a00\u77e5\u8bc6/Go/Go\u6a21\u5757\u5b66\u4e60/GoLang-fmt"},"next":{"title":"goflags","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/\u8bed\u8a00\u77e5\u8bc6/Go/Go\u6a21\u5757\u5b66\u4e60/GoLang-goflags"}}');var s=r(4848),l=r(8453);const d={},i="02.GoLand-net.http.md",o={},a=[{value:"net/http\u4ecb\u7ecd",id:"nethttp\u4ecb\u7ecd",level:2},{value:"HTTP\u534f\u8bae",id:"http\u534f\u8bae",level:3},{value:"HTTP\u5ba2\u6237\u7aef",id:"http\u5ba2\u6237\u7aef",level:2},{value:"\u57fa\u672c\u7684HTTP/HTTPS\u8bf7\u6c42",id:"\u57fa\u672c\u7684httphttps\u8bf7\u6c42",level:3},{value:"GET\u8bf7\u6c42\u793a\u4f8b",id:"get\u8bf7\u6c42\u793a\u4f8b",level:3},{value:"\u5e26\u53c2\u6570\u7684GET\u8bf7\u6c42\u793a\u4f8b",id:"\u5e26\u53c2\u6570\u7684get\u8bf7\u6c42\u793a\u4f8b",level:3},{value:"Post\u8bf7\u6c42\u793a\u4f8b",id:"post\u8bf7\u6c42\u793a\u4f8b",level:3},{value:"\u81ea\u5b9a\u4e49Client",id:"\u81ea\u5b9a\u4e49client",level:3},{value:"\u81ea\u5b9a\u4e49Transport",id:"\u81ea\u5b9a\u4e49transport",level:3},{value:"\u670d\u52a1\u7aef",id:"\u670d\u52a1\u7aef",level:2},{value:"\u9ed8\u8ba4\u7684Server",id:"\u9ed8\u8ba4\u7684server",level:3},{value:"\u9ed8\u8ba4\u7684Server\u793a\u4f8b",id:"\u9ed8\u8ba4\u7684server\u793a\u4f8b",level:3},{value:"\u81ea\u5b9a\u4e49Server",id:"\u81ea\u5b9a\u4e49server",level:3},{value:"\u6a21\u5757\u4ecb\u7ecd",id:"\u6a21\u5757\u4ecb\u7ecd",level:2},{value:"Request",id:"request",level:3},{value:"Response",id:"response",level:3},{value:"Client",id:"client",level:3},{value:"Server \u670d\u52a1\u7aef",id:"server-\u670d\u52a1\u7aef",level:3},{value:"\u81ea\u5b9a\u4e49\u5904\u7406\u5668\uff08Custom Handlers\uff09",id:"\u81ea\u5b9a\u4e49\u5904\u7406\u5668custom-handlers",level:3},{value:"\u5c06\u51fd\u6570\u4f5c\u4e3a\u5904\u7406\u5668",id:"\u5c06\u51fd\u6570\u4f5c\u4e3a\u5904\u7406\u5668",level:3},{value:"\u4e2d\u95f4\u4ef6Middleware",id:"\u4e2d\u95f4\u4ef6middleware",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"02goland-nethttpmd",children:"02.GoLand-net.http.md"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f5c\u8005"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4fee\u8ba2\u65f6\u95f4"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.img,{src:"https://img.shields.io/badge/wjlin0-%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93-green",alt:"wjlin0"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2025-10-15 00:58:49"})]})})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u672c\u7bc7\u6587\u7ae0\u53c2\u8003\u5982\u4e0b\uff0c\u5982\u6709\u4fb5\u6743\uff0c\u8bf7\u8054\u7cfb\u6211\u5220\u9664\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wizardforcel.gitbooks.io/go42/content/content/42_36_http.html",children:"\u7b2c\u4e09\u5341\u516d\u7ae0 net/http\u5305 \xb7 Go \u8bed\u8a00 42 \u7ae0\u7ecf"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.liwenzhou.com/posts/Go/http/#autoid-0-1-1",children:"Go\u8bed\u8a00\u57fa\u7840\u4e4bnet/http | \u674e\u6587\u5468\u7684\u535a\u5ba2"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Go\u8bed\u8a00\u5185\u7f6e\u7684",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u5341\u5206\u7684\u4f18\u79c0\uff0c\u63d0\u4f9b\u4e86HTTP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u5b9e\u73b0\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"nethttp\u4ecb\u7ecd",children:"net/http\u4ecb\u7ecd"}),"\n",(0,s.jsxs)(n.p,{children:["Go\u8bed\u8a00\u5185\u7f6e\u7684",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u63d0\u4f9b\u4e86HTTP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u5b9e\u73b0\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"http\u534f\u8bae",children:"HTTP\u534f\u8bae"}),"\n",(0,s.jsx)(n.p,{children:"\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff08HTTP\uff0cHyperText Transfer Protocol)\u662f\u4e92\u8054\u7f51\u4e0a\u5e94\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u4e00\u79cd\u7f51\u7edc\u4f20\u8f93\u534f\u8bae\uff0c\u6240\u6709\u7684WWW\u6587\u4ef6\u90fd\u5fc5\u987b\u9075\u5b88\u8fd9\u4e2a\u6807\u51c6\u3002\u8bbe\u8ba1HTTP\u6700\u521d\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u63d0\u4f9b\u4e00\u79cd\u53d1\u5e03\u548c\u63a5\u6536HTML\u9875\u9762\u7684\u65b9\u6cd5\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"http\u5ba2\u6237\u7aef",children:"HTTP\u5ba2\u6237\u7aef"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u672c\u7684httphttps\u8bf7\u6c42",children:"\u57fa\u672c\u7684HTTP/HTTPS\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.p,{children:"Get\u3001Head\u3001Post\u548cPostForm\u51fd\u6570\u53d1\u51faHTTP/HTTPS\u8bf7\u6c42\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'resp, err := http.Get("http://example.com/")\n...\nresp, err := http.Post("http://example.com/upload", "image/jpeg", &buf)\n...\nresp, err := http.PostForm("http://example.com/form",\n\turl.Values{"key": {"Value"}, "id": {"123"}})\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u7a0b\u5e8f\u5728\u4f7f\u7528\u5b8cresponse\u540e\u5fc5\u987b\u5173\u95ed\u56de\u590d\u7684\u4e3b\u4f53\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'resp, err := http.Get("http://example.com/")\nif err != nil {\n\t// handle error\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\n// ...\n'})}),"\n",(0,s.jsx)(n.h3,{id:"get\u8bf7\u6c42\u793a\u4f8b",children:"GET\u8bf7\u6c42\u793a\u4f8b"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u53d1\u9001HTTP\u8bf7\u6c42\u7684Client\u7aef\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"io/ioutil"\n\t"net/http"\n)\n\nfunc main() {\n\tresp, err := http.Get("https://www.liwenzhou.com/")\n\tif err != nil {\n\t\tfmt.Printf("get failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tdefer resp.Body.Close()\n\tbody, err := ioutil.ReadAll(resp.Body)\n\tif err != nil {\n\t\tfmt.Printf("read from resp.Body failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tfmt.Print(string(body))\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u4fdd\u5b58\u4e4b\u540e\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6267\u884c\u4e4b\u540e\u5c31\u80fd\u5728\u7ec8\u7aef\u6253\u5370",(0,s.jsx)(n.code,{children:"liwenzhou.com"}),"\u7f51\u7ad9\u9996\u9875\u7684\u5185\u5bb9\u4e86\uff0c\u6211\u4eec\u7684\u6d4f\u89c8\u5668\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u53d1\u9001\u548c\u63a5\u6536HTTP\u534f\u8bae\u6570\u636e\u7684\u5ba2\u6237\u7aef\uff0c\u6211\u4eec\u5e73\u65f6\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee\u7f51\u9875\u5176\u5b9e\u5c31\u662f\u4ece\u7f51\u7ad9\u7684\u670d\u52a1\u5668\u63a5\u6536HTTP\u6570\u636e\uff0c\u7136\u540e\u6d4f\u89c8\u5668\u4f1a\u6309\u7167HTML\u3001CSS\u7b49\u89c4\u5219\u5c06\u7f51\u9875\u6e32\u67d3\u5c55\u793a\u51fa\u6765\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5e26\u53c2\u6570\u7684get\u8bf7\u6c42\u793a\u4f8b",children:"\u5e26\u53c2\u6570\u7684GET\u8bf7\u6c42\u793a\u4f8b"}),"\n",(0,s.jsxs)(n.p,{children:["\u5173\u4e8eGET\u8bf7\u6c42\u7684\u53c2\u6570\u9700\u8981\u4f7f\u7528Go\u8bed\u8a00\u5185\u7f6e\u7684",(0,s.jsx)(n.code,{children:"net/url"}),"\u8fd9\u4e2a\u6807\u51c6\u5e93\u6765\u5904\u7406\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func main() {\n\tapiUrl := "http://127.0.0.1:9090/get"\n\t// URL param\n\tdata := url.Values{}\n\tdata.Set("name", "\u5c0f\u738b\u5b50")\n\tdata.Set("age", "18")\n\tu, err := url.ParseRequestURI(apiUrl)\n\tif err != nil {\n\t\tfmt.Printf("parse url requestUrl failed, err:%v\\n", err)\n\t}\n\tu.RawQuery = data.Encode() // URL encode\n\tfmt.Println(u.String())\n\tresp, err := http.Get(u.String())\n\tif err != nil {\n\t\tfmt.Printf("post failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tdefer resp.Body.Close()\n\tb, err := ioutil.ReadAll(resp.Body)\n\tif err != nil {\n\t\tfmt.Printf("get resp failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tfmt.Println(string(b))\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u5e94\u7684Server\u7aefHandlerFunc\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func getHandler(w http.ResponseWriter, r *http.Request) {\n\tdefer r.Body.Close()\n\tdata := r.URL.Query()\n\tfmt.Println(data.Get("name"))\n\tfmt.Println(data.Get("age"))\n\tanswer := `{"status": "ok"}`\n\tw.Write([]byte(answer))\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"post\u8bf7\u6c42\u793a\u4f8b",children:"Post\u8bf7\u6c42\u793a\u4f8b"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0a\u9762\u6f14\u793a\u4e86\u4f7f\u7528",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u53d1\u9001",(0,s.jsx)(n.code,{children:"GET"}),"\u8bf7\u6c42\u7684\u793a\u4f8b\uff0c\u53d1\u9001",(0,s.jsx)(n.code,{children:"POST"}),"\u8bf7\u6c42\u7684\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"io/ioutil"\n\t"net/http"\n\t"strings"\n)\n\n// net/http post demo\n\nfunc main() {\n\turl := "http://127.0.0.1:9090/post"\n\t// \u8868\u5355\u6570\u636e\n\t//contentType := "application/x-www-form-urlencoded"\n\t//data := "name=\u5c0f\u738b\u5b50&age=18"\n\t// json\n\tcontentType := "application/json"\n\tdata := `{"name":"\u5c0f\u738b\u5b50","age":18}`\n\tresp, err := http.Post(url, contentType, strings.NewReader(data))\n\tif err != nil {\n\t\tfmt.Printf("post failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tdefer resp.Body.Close()\n\tb, err := ioutil.ReadAll(resp.Body)\n\tif err != nil {\n\t\tfmt.Printf("get resp failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tfmt.Println(string(b))\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u5e94\u7684Server\u7aefHandlerFunc\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func postHandler(w http.ResponseWriter, r *http.Request) {\n\tdefer r.Body.Close()\n\t// 1. \u8bf7\u6c42\u7c7b\u578b\u662fapplication/x-www-form-urlencoded\u65f6\u89e3\u6790form\u6570\u636e\n\tr.ParseForm()\n\tfmt.Println(r.PostForm) // \u6253\u5370form\u6570\u636e\n\tfmt.Println(r.PostForm.Get("name"), r.PostForm.Get("age"))\n\t// 2. \u8bf7\u6c42\u7c7b\u578b\u662fapplication/json\u65f6\u4ecer.Body\u8bfb\u53d6\u6570\u636e\n\tb, err := ioutil.ReadAll(r.Body)\n\tif err != nil {\n\t\tfmt.Printf("read request.Body failed, err:%v\\n", err)\n\t\treturn\n\t}\n\tfmt.Println(string(b))\n\tanswer := `{"status": "ok"}`\n\tw.Write([]byte(answer))\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49client",children:"\u81ea\u5b9a\u4e49Client"}),"\n",(0,s.jsx)(n.p,{children:"\u8981\u7ba1\u7406HTTP\u5ba2\u6237\u7aef\u7684\u5934\u57df\u3001\u91cd\u5b9a\u5411\u7b56\u7565\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u521b\u5efa\u4e00\u4e2aClient\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'client := &http.Client{\n\tCheckRedirect: redirectPolicyFunc,\n}\nresp, err := client.Get("http://example.com")\n// ...\nreq, err := http.NewRequest("GET", "http://example.com", nil)\n// ...\nreq.Header.Add("If-None-Match", `W/"wyzzy"`)\nresp, err := client.Do(req)\n// ...\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49transport",children:"\u81ea\u5b9a\u4e49Transport"}),"\n",(0,s.jsx)(n.p,{children:"\u8981\u7ba1\u7406\u4ee3\u7406\u3001TLS\u914d\u7f6e\u3001keep-alive\u3001\u538b\u7f29\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u521b\u5efa\u4e00\u4e2aTransport\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'tr := &http.Transport{\n\tTLSClientConfig:    &tls.Config{RootCAs: pool},\n\tDisableCompression: true,\n}\nclient := &http.Client{Transport: tr}\nresp, err := client.Get("https://example.com")\n'})}),"\n",(0,s.jsx)(n.p,{children:"Client\u548cTransport\u7c7b\u578b\u90fd\u53ef\u4ee5\u5b89\u5168\u7684\u88ab\u591a\u4e2agoroutine\u540c\u65f6\u4f7f\u7528\u3002\u51fa\u4e8e\u6548\u7387\u8003\u8651\uff0c\u5e94\u8be5\u4e00\u6b21\u5efa\u7acb\u3001\u5c3d\u91cf\u91cd\u7528\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u670d\u52a1\u7aef",children:"\u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.h3,{id:"\u9ed8\u8ba4\u7684server",children:"\u9ed8\u8ba4\u7684Server"}),"\n",(0,s.jsx)(n.p,{children:"ListenAndServe\u4f7f\u7528\u6307\u5b9a\u7684\u76d1\u542c\u5730\u5740\u548c\u5904\u7406\u5668\u542f\u52a8\u4e00\u4e2aHTTP\u670d\u52a1\u7aef\u3002\u5904\u7406\u5668\u53c2\u6570\u901a\u5e38\u662fnil\uff0c\u8fd9\u8868\u793a\u91c7\u7528\u5305\u53d8\u91cfDefaultServeMux\u4f5c\u4e3a\u5904\u7406\u5668\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Handle\u548cHandleFunc\u51fd\u6570\u53ef\u4ee5\u5411DefaultServeMux\u6dfb\u52a0\u5904\u7406\u5668\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'http.Handle("/foo", fooHandler)\nhttp.HandleFunc("/bar", func(w http.ResponseWriter, r *http.Request) {\n\tfmt.Fprintf(w, "Hello, %q", html.EscapeString(r.URL.Path))\n})\nlog.Fatal(http.ListenAndServe(":8080", nil))\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u9ed8\u8ba4\u7684server\u793a\u4f8b",children:"\u9ed8\u8ba4\u7684Server\u793a\u4f8b"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528Go\u8bed\u8a00\u4e2d\u7684",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u6765\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u63a5\u6536HTTP\u8bf7\u6c42\u7684Server\u7aef\u793a\u4f8b\uff0c",(0,s.jsx)(n.code,{children:"net/http"}),"\u5305\u662f\u5bf9net\u5305\u7684\u8fdb\u4e00\u6b65\u5c01\u88c5\uff0c\u4e13\u95e8\u7528\u6765\u5904\u7406HTTP\u534f\u8bae\u7684\u6570\u636e\u3002\u5177\u4f53\u7684\u4ee3\u7801\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// http server\n\nfunc sayHello(w http.ResponseWriter, r *http.Request) {\n\tfmt.Fprintln(w, "Hello \u6c99\u6cb3\uff01")\n}\n\nfunc main() {\n\thttp.HandleFunc("/", sayHello)\n\terr := http.ListenAndServe(":9090", nil)\n\tif err != nil {\n\t\tfmt.Printf("http server failed, err:%v\\n", err)\n\t\treturn\n\t}\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5c06\u4e0a\u9762\u7684\u4ee3\u7801\u7f16\u8bd1\u4e4b\u540e\u6267\u884c\uff0c\u6253\u5f00\u4f60\u7535\u8111\u4e0a\u7684\u6d4f\u89c8\u5668\u5728\u5730\u5740\u680f\u8f93\u5165",(0,s.jsx)(n.code,{children:"127.0.0.1:9090"}),"\u56de\u8f66\uff0c\u6b64\u65f6\u5c31\u80fd\u591f\u770b\u5230\u5982\u4e0b\u9875\u9762\u4e86\u3002",(0,s.jsx)(n.img,{alt:"hello\u9875\u9762",src:r(3268).A+"",width:"1322",height:"850"})]}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49server",children:"\u81ea\u5b9a\u4e49Server"}),"\n",(0,s.jsx)(n.p,{children:"\u8981\u7ba1\u7406\u670d\u52a1\u7aef\u7684\u884c\u4e3a\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684Server\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'s := &http.Server{\n\tAddr:           ":8080",\n\tHandler:        myHandler,\n\tReadTimeout:    10 * time.Second,\n\tWriteTimeout:   10 * time.Second,\n\tMaxHeaderBytes: 1 << 20,\n}\nlog.Fatal(s.ListenAndServe())\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u6a21\u5757\u4ecb\u7ecd",children:"\u6a21\u5757\u4ecb\u7ecd"}),"\n",(0,s.jsx)(n.h3,{id:"request",children:"Request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'// \u5229\u7528\u6307\u5b9a\u7684method, url\u4ee5\u53ca\u53ef\u9009\u7684body\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u8bf7\u6c42.\u5982\u679cbody\u53c2\u6570\u5b9e\u73b0\u4e86\n// io.Closer\u63a5\u53e3\uff0cRequest\u8fd4\u56de\u503c\u7684Body \u5b57\u6bb5\u4f1a\u88ab\u8bbe\u7f6e\u4e3abody\uff0c\u5e76\u4f1a\u88abClient\n// \u7c7b\u578b\u7684Do\u3001Post\u548cPostForm\u65b9\u6cd5\u4ee5\u53caTransport.RoundTrip\u65b9\u6cd5\u5173\u95ed\u3002 \nfunc NewRequest(method, urlStr string, body io.Reader) (*Request, error) \n\n// \u4eceb\u4e2d\u8bfb\u53d6\u548c\u89e3\u6790\u4e00\u4e2a\u8bf7\u6c42. \nfunc ReadRequest(b *bufio.Reader) (req *Request, err error)\n\n// \u7ed9request\u6dfb\u52a0cookie, AddCookie\u5411\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u4e00\u4e2acookie.\u6309\u7167RFC 6265 \n// section 5.4\u7684\u89c4\u5219, AddCookie\u4e0d\u4f1a\u6dfb\u52a0\u8d85\u8fc7\u4e00\u4e2aCookie\u5934\u5b57\u6bb5.\n// \u8fd9\u8868\u793a\u6240\u6709\u7684cookie\u90fd\u5199\u5728\u540c\u4e00\u884c, \u7528\u5206\u53f7\u5206\u9694\uff08cookie\u5185\u90e8\u7528\u9017\u53f7\u5206\u9694\u5c5e\u6027\uff09 \nfunc (r *Request) AddCookie(c *Cookie)\n\n// \u8fd4\u56derequest\u4e2d\u6307\u5b9a\u540dname\u7684cookie\uff0c\u5982\u679c\u6ca1\u6709\u53d1\u73b0\uff0c\u8fd4\u56deErrNoCookie \nfunc (r *Request) Cookie(name string) (*Cookie, error)\n\n// \u8fd4\u56de\u8be5\u8bf7\u6c42\u7684\u6240\u6709cookies \nfunc (r *Request) Cookies() []*Cookie\n\n// \u5229\u7528\u63d0\u4f9b\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ed9http\u57fa\u672c\u6743\u9650\u63d0\u4f9b\u5177\u6709\u4e00\u5b9a\u6743\u9650\u7684header\u3002\n// \u5f53\u4f7f\u7528http\u57fa\u672c\u6388\u6743\u65f6\uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u662f\u4e0d\u52a0\u5bc6\u7684 \nfunc (r *Request) SetBasicAuth(username, password string)\n\n// \u5982\u679c\u5728request\u4e2d\u53d1\u9001\uff0c\u8be5\u51fd\u6570\u8fd4\u56de\u5ba2\u6237\u7aef\u7684user-Agent\nfunc (r *Request) UserAgent() string\n\n// \u5bf9\u4e8e\u6307\u5b9a\u683c\u5f0f\u7684key\uff0cFormFile\u8fd4\u56de\u7b26\u5408\u6761\u4ef6\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u6709\u5fc5\u8981\u7684\u8bdd\uff0c\n// \u8be5\u51fd\u6570\u4f1a\u8c03\u7528ParseMultipartForm\u548cParseForm\u3002 \nfunc (r *Request) FormFile(key string) (multipart.File, *multipart.FileHeader, error)\n\n// \u8fd4\u56dekey\u83b7\u53d6\u7684\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u503c\u3002\u5728\u67e5\u8be2\u8fc7\u7a0b\u4e2dpost\u548cput\u4e2d\u7684\u4e3b\u9898\u53c2\u6570\u4f18\u5148\u7ea7\n// \u9ad8\u4e8eurl\u4e2d\u7684value\u3002\u4e3a\u4e86\u8bbf\u95ee\u76f8\u540ckey\u7684\u591a\u4e2a\u503c\uff0c\u8c03\u7528ParseForm\u7136\u540e\u76f4\u63a5\n// \u68c0\u67e5RequestForm\u3002 \nfunc (r *Request) FormValue(key string) string\n\n// \u5982\u679c\u8fd9\u662f\u4e00\u4e2a\u6709\u591a\u90e8\u5206\u7ec4\u6210\u7684post\u8bf7\u6c42\uff0c\u8be5\u51fd\u6570\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2aMIME \u591a\u90e8\u5206reader\uff0c\n// \u5426\u5219\u7684\u8bdd\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2anil\u548cerror\u3002\u4f7f\u7528\u672c\u51fd\u6570\u4ee3\u66ffParseMultipartForm\n// \u53ef\u4ee5\u5c06\u8bf7\u6c42body\u5f53\u505a\u6d41stream\u6765\u5904\u7406\u3002 \nfunc (r *Request) MultipartReader() (*multipart.Reader, error)\n\n// \u89e3\u6790URL\u4e2d\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff0c\u5e76\u5c06\u89e3\u6790\u7ed3\u679c\u66f4\u65b0\u5230r.Form\u5b57\u6bb5\u3002\u5bf9\u4e8ePOST\u6216PUT\n// \u8bf7\u6c42\uff0cParseForm\u8fd8\u4f1a\u5c06body\u5f53\u4f5c\u8868\u5355\u89e3\u6790\uff0c\u5e76\u5c06\u7ed3\u679c\u65e2\u66f4\u65b0\u5230r.PostForm\u4e5f\n// \u66f4\u65b0\u5230r.Form\u3002\u89e3\u6790\u7ed3\u679c\u4e2d\uff0cPOST\u6216PUT\u8bf7\u6c42\u4e3b\u4f53\u8981\u4f18\u5148\u4e8eURL\u67e5\u8be2\u5b57\u7b26\u4e32\n// \uff08\u540c\u540d\u53d8\u91cf\uff0c\u4e3b\u4f53\u7684\u503c\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u7684\u503c\u524d\u9762\uff09\u3002\u5982\u679c\u8bf7\u6c42\u7684\u4e3b\u4f53\u7684\u5927\u5c0f\u6ca1\u6709\u88ab\n// MaxBytesReader\u51fd\u6570\u8bbe\u5b9a\u9650\u5236\uff0c\u5176\u5927\u5c0f\u9ed8\u8ba4\u9650\u5236\u4e3a\u5f00\u593410MB\u3002\n// ParseMultipartForm\u4f1a\u81ea\u52a8\u8c03\u7528ParseForm\u3002\u91cd\u590d\u8c03\u7528\u672c\u65b9\u6cd5\u662f\u65e0\u610f\u4e49\u7684\u3002\nfunc (r *Request) ParseForm() error \n\n// ParseMultipartForm\u5c06\u8bf7\u6c42\u7684\u4e3b\u4f53\u4f5c\u4e3amultipart/form-data\u89e3\u6790\u3002\n// \u8bf7\u6c42\u7684\u6574\u4e2a\u4e3b\u4f53\u90fd\u4f1a\u88ab\u89e3\u6790\uff0c\u5f97\u5230\u7684\u6587\u4ef6\u8bb0\u5f55\u6700\u591a maxMemery\u5b57\u8282\u4fdd\u5b58\u5728\u5185\u5b58\uff0c\n// \u5176\u4f59\u90e8\u5206\u4fdd\u5b58\u5728\u786c\u76d8\u7684temp\u6587\u4ef6\u91cc\u3002\u5982\u679c\u5fc5\u8981\uff0cParseMultipartForm\u4f1a\n// \u81ea\u884c\u8c03\u7528 ParseForm\u3002\u91cd\u590d\u8c03\u7528\u672c\u65b9\u6cd5\u662f\u65e0\u610f\u4e49\u7684\u3002\nfunc (r *Request) ParseMultipartForm(maxMemory int64) error \n\n// \u8fd4\u56depost\u6216\u8005put\u8bf7\u6c42body\u6307\u5b9a\u5143\u7d20\u7684\u7b2c\u4e00\u4e2a\u503c\uff0c\u5176\u4e2durl\u4e2d\u7684\u53c2\u6570\u88ab\u5ffd\u7565\u3002\nfunc (r *Request) PostFormValue(key string) string \n\n// \u68c0\u6d4b\u5728request\u4e2d\u4f7f\u7528\u7684http\u534f\u8bae\u662f\u5426\u81f3\u5c11\u662fmajor.minor \nfunc (r *Request) ProtoAtLeast(major\uff0cminor int) bool\n\n// \u5982\u679crequest\u4e2d\u6709refer\uff0c\u90a3\u4e48refer\u8fd4\u56de\u76f8\u5e94\u7684url\u3002Referer\u5728request\n// \u4e2d\u662f\u62fc\u9519\u7684\uff0c\u8fd9\u4e2a\u9519\u8bef\u4ecehttp\u521d\u671f\u5c31\u5df2\u7ecf\u5b58\u5728\u4e86\u3002\u8be5\u503c\u4e5f\u53ef\u4ee5\u4eceHeadermap\u4e2d\n// \u5229\u7528Header["Referer"]\u83b7\u53d6\uff1b\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u5229\u7528Referer\u8fd9\u4e2a\u65b9\u6cd5\u800c\n// \u4e0d\u662fmap\u7684\u5f62\u5f0f\u7684\u597d\u5904\u662f\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u68c0\u67e5\u65b9\u6cd5\u7684\u9519\u8bef\uff0c\u800c\u65e0\u6cd5\u68c0\u67e5map\u4e2d\n// key\u7684\u9519\u8bef\u3002\nfunc (r *Request) Referer() string \n\n// Write\u65b9\u6cd5\u4ee5\u6709\u7ebf\u683c\u5f0f\u5c06HTTP/1.1\u8bf7\u6c42\u5199\u5165w\uff08\u7528\u4e8e\u5c06\u8bf7\u6c42\u5199\u5165\u4e0b\u5c42TCPConn\u7b49\uff09\n// \u3002\u672c\u65b9\u6cd5\u4f1a\u8003\u8651\u8bf7\u6c42\u7684\u5982\u4e0b\u5b57\u6bb5\uff1aHost URL Method (defaults to "GET")\n//  Header ContentLength TransferEncoding Body\u5982\u679c\u5b58\u5728Body\uff0c\n// ContentLength\u5b57\u6bb5<= 0\u4e14TransferEncoding\u5b57\u6bb5\u672a\u663e\u5f0f\u8bbe\u7f6e\u4e3a\n// ["identity"]\uff0cWrite\u65b9\u6cd5\u4f1a\u663e\u5f0f\u6dfb\u52a0\u201dTransfer-Encoding: chunked\u201d\n// \u5230\u8bf7\u6c42\u7684\u5934\u57df\u3002Body\u5b57\u6bb5\u4f1a\u5728\u53d1\u9001\u5b8c\u8bf7\u6c42\u540e\u5173\u95ed\u3002\nfunc (r *Request) Write(w io.Writer) error \n\n// \u8be5\u51fd\u6570\u4e0eWrite\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u4f46\u662f\u8be5\u65b9\u6cd5\u5199\u7684request\u662f\u6309\u7167http\u4ee3\u7406\u7684\u683c\u5f0f\u53bb\u5199\u3002\n// \u5c24\u5176\u662f\uff0c\u6309\u7167RFC 2616 Section 5.1.2\uff0cWriteProxy\u4f1a\u4f7f\u7528\u7edd\u5bf9URI\n// \uff08\u5305\u62ec\u534f\u8bae\u548c\u4e3b\u673a\u540d\uff09\u6765\u521d\u59cb\u5316\u8bf7\u6c42\u7684\u7b2c1\u884c\uff08Request-URI\u884c\uff09\u3002\u65e0\u8bba\u4f55\u79cd\u60c5\u51b5\uff0c\n// WriteProxy\u90fd\u4f1a\u4f7f\u7528r.Host\u6216r.URL.Host\u8bbe\u7f6eHost\u5934\u3002\nfunc (r *Request) WriteProxy(w io.Writer) error\n'})}),"\n",(0,s.jsx)(n.h3,{id:"response",children:"Response"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// \u6ce8\u610f\u662f\u5728response.go\u4e2d\u5b9a\u4e49\u7684\uff0c\u800c\u5728server.go\u6709\u4e00\u4e2a\n// type response struct  \uff0c\u6ce8\u610f\u5927\u5c0f\u5199\u3002\u8fd9\u4e2a\u7ed3\u6784\u662f\u4f53\u73b0\u5728server\u7aef\u7684\u529f\u80fd\u3002\ntype Response struct \n\n// ReadResponse\u4ecer\u8bfb\u53d6\u5e76\u8fd4\u56de\u4e00\u4e2aHTTP \u56de\u590d\u3002req\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u6307\u5b9a\u8be5\u56de\u590d\n// \u5bf9\u5e94\u7684\u8bf7\u6c42\uff08\u5373\u662f\u5bf9\u8be5\u8bf7\u6c42\u7684\u56de\u590d\uff09\u3002\u5982\u679c\u662fnil\uff0c\u5c06\u5047\u8bbe\u8bf7 \u6c42\u662fGET\u8bf7\u6c42\u3002\n// \u5ba2\u6237\u7aef\u5fc5\u987b\u5728\u7ed3\u675fresp.Body\u7684\u8bfb\u53d6\u540e\u5173\u95ed\u5b83\u3002\u8bfb\u53d6\u5b8c\u6bd5\u5e76\u5173\u95ed\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\n// \u68c0\u67e5resp.Trailer\u5b57\u6bb5\u83b7\u53d6\u56de\u590d\u7684 trailer\u7684\u952e\u503c\u5bf9\u3002\nfunc ReadResponse(r *bufio.Reader, req *Request) (*Response, error)\n\n// \u89e3\u6790cookie\u5e76\u8fd4\u56de\u5728header\u4e2d\u5229\u7528set-Cookie\u8bbe\u5b9a\u7684cookie\u503c\u3002\nfunc (r *Response) Cookies() []*Cookie \n\n// \u8fd4\u56deresponse\u4e2dLocation\u7684header\u503c\u7684url\u3002\u5982\u679c\u8be5\u503c\u5b58\u5728\u7684\u8bdd\uff0c\u5219\u5bf9\u4e8e\n// \u8bf7\u6c42\u95ee\u9898\u53ef\u4ee5\u89e3\u51b3\u76f8\u5bf9\u91cd\u5b9a\u5411\u7684\u95ee\u9898\uff0c\u5982\u679c\u8be5\u503c\u4e3anil\uff0c\u5219\u8fd4\u56deErrNOLocation\u3002\nfunc (r *Response) Location() (*url.URL\uff0cerror) \n\n// \u5224\u5b9a\u5728response\u4e2d\u4f7f\u7528\u7684http\u534f\u8bae\u662f\u5426\u81f3\u5c11\u662fmajor.minor\u7684\u5f62\u5f0f\u3002\nfunc (r *Response) ProtoAtLeast(major, minor int) bool \n\n// \u5c06response\u4e2d\u4fe1\u606f\u6309\u7167\u7ebf\u6027\u683c\u5f0f\u5199\u5165w\u4e2d\u3002\nfunc (r *Response) Write(w io.Writer) error\n"})}),"\n",(0,s.jsx)(n.h3,{id:"client",children:"Client"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Client\u5177\u6709Do\uff0cGet\uff0cHead\uff0cPost\u4ee5\u53caPostForm\u7b49\u65b9\u6cd5\u3002 \u5176\u4e2dDo\u65b9\u6cd5\u53ef\u4ee5\u5bf9\n// Request\u8fdb\u884c\u4e00\u7cfb\u5217\u7684\u8bbe\u5b9a\uff0c\u800c\u5176\u4ed6\u7684\u5bf9request\u8bbe\u5b9a\u8f83\u5c11\u3002\u5982\u679cClient\u4f7f\u7528\u9ed8\u8ba4\u7684\n// Client\uff0c\u5219\u5176\u4e2d\u7684Get\uff0cHead\uff0cPost\u4ee5\u53caPostForm\u65b9\u6cd5\u76f8\u5f53\u4e8e\u9ed8\u8ba4\u7684http.Get, \n// http.Post, http.Head\u4ee5\u53cahttp.PostForm\u51fd\u6570\u3002\ntype Client struct\n\n// \u5229\u7528GET\u65b9\u6cd5\u5bf9\u4e00\u4e2a\u6307\u5b9a\u7684URL\u8fdb\u884c\u8bf7\u6c42\uff0c\u5982\u679cresponse\u662f\u5982\u4e0b\u91cd\u5b9a\u5411\u4e2d\u7684\u4e00\u4e2a\n// \u4ee3\u7801\uff0c\u5219Get\u4e4b\u540e\u5c06\u4f1a\u8c03\u7528\u91cd\u5b9a\u5411\u5185\u5bb9\uff0c\u6700\u591a10\u6b21\u91cd\u5b9a\u5411\u3002 \n// 301 (\u6c38\u4e45\u91cd\u5b9a\u5411\uff0c\u544a\u8bc9\u5ba2\u6237\u7aef\u4ee5\u540e\u5e94\u8be5\u4ece\u65b0\u5730\u5740\u8bbf\u95ee) \n// 302 (\u6682\u65f6\u6027\u91cd\u5b9a\u5411\uff0c\u4f5c\u4e3aHTTP1.0\u7684\u6807\u51c6\uff0cPHP\u7684\u9ed8\u8ba4Location\u91cd\u5b9a\u5411\u7528\u5230\n// \u4e5f\u662f302)\uff0c\u6ce8\uff1a303\u548c307\u5176\u5b9e\u662f\u5bf9302\u7684\u7ec6\u5316\u3002 \n// 303 (\u5bf9\u4e8ePost\u8bf7\u6c42\uff0c\u5b83\u8868\u793a\u8bf7\u6c42\u5df2\u7ecf\u88ab\u5904\u7406\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u63a5\u7740\u4f7f\u7528GET\u65b9\u6cd5\u53bb\n// \u8bf7\u6c42Location\u91cc\u7684URl) \n// 307 (\u4e34\u65f6\u91cd\u5b9a\u5411\uff0c\u5bf9\u4e8ePost\u8bf7\u6c42\uff0c\u8868\u793a\u8bf7\u6c42\u8fd8\u6ca1\u6709\u88ab\u5904\u7406\uff0c\u5ba2\u6237\u7aef\u5e94\u8be5\u5411\n// Location\u91cc\u7684URL\u91cd\u65b0\u53d1\u8d77Post\u8bf7\u6c42)\nfunc Get(url string) (resp *Response, err error) \n\n// \u8be5\u51fd\u6570\u529f\u80fd\u89c1net\u4e2dHead\u65b9\u6cd5\u529f\u80fd\u3002\u8be5\u65b9\u6cd5\u4e0e\u9ed8\u8ba4\u7684defaultClient\u4e2d\n// Head\u65b9\u6cd5\u4e00\u81f4\u3002\nfunc Head(url string) (resp *Response, err error) \n\n// \u8be5\u65b9\u6cd5\u4e0e\u9ed8\u8ba4\u7684defaultClient\u4e2dPost\u65b9\u6cd5\u4e00\u81f4\u3002\nfunc Post(url string, bodyType string, body io.Reader) (resp *Response, err error)\n\n// \u8be5\u65b9\u6cd5\u4e0e\u9ed8\u8ba4\u7684defaultClient\u4e2dPostForm\u65b9\u6cd5\u4e00\u81f4\u3002 \nfunc PostForm(url string, data url.Values) (resp *Response, err error)\n\n// Do\u53d1\u9001http\u8bf7\u6c42\u5e76\u4e14\u8fd4\u56de\u4e00\u4e2ahttp\u54cd\u5e94, \u9075\u5b88client\u7684\u7b56\u7565, \u5982\u91cd\u5b9a\u5411, \n// cookies\u4ee5\u53caauth\u7b49.\u9519\u8bef\u7ecf\u5e38\u662f\u7531\u4e8e\u7b56\u7565\u5f15\u8d77\u7684, \u5f53err\u662fnil\u65f6, resp\n// \u603b\u4f1a\u5305\u542b\u4e00\u4e2a\u975enil\u7684resp.body.\u5f53\u8c03\u7528\u8005\u8bfb\u5b8cresp.body\u4e4b\u540e\u5e94\u8be5\u5173\u95ed\u5b83, \n// \u5982\u679cresp.body\u6ca1\u6709\u5173\u95ed, \u5219Client\u5e95\u5c42RoundTripper\u5c06\u65e0\u6cd5\u91cd\u7528\u5b58\u5728\u7684\n// TCP\u8fde\u63a5\u53bb\u670d\u52a1\u63a5\u4e0b\u6765\u7684\u8bf7\u6c42, \u5982\u679cresp.body\u975enil, \u5219\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u5173\u95ed.\n// \u901a\u5e38\u6765\u8bf4, \u7ecf\u5e38\u4f7f\u7528Get, Post, \u6216\u8005PostForm\u6765\u66ff\u4ee3Do. \nfunc (c *Client) Do(req *Request) (resp *Response, err error)\n\n// \u5229\u7528get\u65b9\u6cd5\u8bf7\u6c42\u6307\u5b9a\u7684url.Get\u8bf7\u6c42\u6307\u5b9a\u7684\u9875\u9762\u4fe1\u606f\uff0c\u5e76\u8fd4\u56de\u5b9e\u4f53\u4e3b\u4f53\u3002\nfunc (c *Client) Get(url string) (resp *Response, err error) \n\n// \u5229\u7528head\u65b9\u6cd5\u8bf7\u6c42\u6307\u5b9a\u7684url\uff0cHead\u53ea\u8fd4\u56de\u9875\u9762\u7684\u9996\u90e8\u3002\nfunc (c *Client) Head(url string) (resp *Response, err error) \n\n// post\u65b9\u6cd5\u8bf7\u6c42\u6307\u5b9a\u7684URl, \u5982\u679cbody\u4e5f\u662f\u4e00\u4e2aio.Closer, \u5219\u5728\u8bf7\u6c42\u4e4b\u540e\u5173\u95ed\u5b83 \nfunc (c *Client) Post(url string, bodyType string, body io.Reader) (resp *Response, err error)\n\n// \u5229\u7528post\u65b9\u6cd5\u8bf7\u6c42\u6307\u5b9a\u7684url, \u5229\u7528data\u7684key\u548cvalue\u4f5c\u4e3a\u8bf7\u6c42\u4f53. \nfunc (c *Client) PostForm(url string, data url.Values) (resp *Response, err error)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"server-\u670d\u52a1\u7aef",children:"Server \u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.p,{children:"http Server\u670d\u52a1\u7aef\u7528\u6765\u63a5\u6536\u5e76\u54cd\u5e94http Client\u7aef\u53d1\u51fa\u7684http Request\u8bf7\u6c42\uff0c\u662fnet/http\u5305\u4e2d\u975e\u5e38\u91cd\u8981\u548c\u5173\u952e\u7684\u4e00\u4e2a\u529f\u80fd\u3002\u6211\u4eec\u5728Go\u8bed\u8a00\u4e2d\u7b80\u5355\u5c31\u80fd\u642d\u5efaHTTP\u670d\u52a1\u5668\uff0c\u5c31\u662f\u56e0\u4e3a\u5b83\u7684\u5b58\u5728\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5728server.go\u6587\u4ef6\u4e2d\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u63a5\u53e3\uff1aHandler\uff0c\u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u7ed3\u6784\u4f53response\uff0c\u8fd9\u548chttp.Response\u7ed3\u6784\u4f53\u53ea\u6709\u9996\u5b57\u6bcd\u5927\u5c0f\u5199\u4e0d\u4e00\u81f4\uff0c\u4e0d\u8fc7\u8fd9\u4e2aresponse \u4e5f\u662f\u54cd\u5e94\uff0c\u53ea\u4e0d\u8fc7\u662f\u4e13\u95e8\u7528\u5728\u670d\u52a1\u7aef\uff0c\u548chttp.Response\u7ed3\u6784\u4f53\u662f\u5b8c\u5168\u4e24\u56de\u4e8b\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"type Handler interface {\n    ServeHTTP(ResponseWriter, *Request)\n}\n\ntype Server struct\n\n// \u76d1\u542cTCP\u7f51\u7edc\u5730\u5740srv.Addr\u7136\u540e\u8c03\u7528Serve\u6765\u5904\u7406\u63a5\u4e0b\u6765\u8fde\u63a5\u7684\u8bf7\u6c42\u3002\n// \u5982\u679csrv.Addr\u662f\u7a7a\u7684\u8bdd\uff0c\u5219\u4f7f\u7528\u201c:http\u201d\u3002\nfunc (srv *Server) ListenAndServe() error \n\n// ListenAndServeTLS\u76d1\u542csrv.Addr\u786e\u5b9a\u7684TCP\u5730\u5740\uff0c\u5e76\u4e14\u4f1a\u8c03\u7528Serve\n// \u65b9\u6cd5\u5904\u7406\u63a5\u6536\u5230\u7684\u8fde\u63a5\u3002\u5fc5\u987b\u63d0\u4f9b\u8bc1\u4e66\u6587\u4ef6\u548c\u5bf9\u5e94\u7684\u79c1\u94a5\u6587 \u4ef6\u3002\u5982\u679c\u8bc1\u4e66\u662f\u7531\n// \u6743\u5a01\u673a\u6784\u7b7e\u53d1\u7684\uff0ccertFile\u53c2\u6570\u5fc5\u987b\u662f\u987a\u5e8f\u4e32\u8054\u7684\u670d\u52a1\u7aef\u8bc1\u4e66\u548cCA\u8bc1\u4e66\u3002\n// \u5982\u679csrv.Addr\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u4f1a\u4f7f \u7528\u201d:https\u201d\u3002\nfunc (srv *Server) ListenAndServeTLS(certFile, keyFile string) error \n\n// \u63a5\u53d7Listener l\u7684\u8fde\u63a5\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u534f\u7a0b\u3002\u8be5\u670d\u52a1\u534f\u7a0b\u8bfb\u53d6\u8bf7\u6c42\u7136\u540e\u8c03\u7528\n// srv.Handler\u6765\u5e94\u7b54\u3002\u5b9e\u9645\u4e0a\u5c31\u662f\u5b9e\u73b0\u4e86\u5bf9\u67d0\u4e2a\u7aef\u53e3\u8fdb\u884c\u76d1\u542c\uff0c\u7136\u540e\u521b\u5efa\u76f8\u5e94\u7684\u8fde\u63a5\u3002 \nfunc (srv *Server) Serve(l net.Listener) error\n\n// \u8be5\u51fd\u6570\u63a7\u5236\u662f\u5426http\u7684keep-alives\u80fd\u591f\u4f7f\u7528\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ckeep-alives\u603b\u662f\u53ef\u7528\u7684\u3002\n// \u53ea\u6709\u8d44\u6e90\u975e\u5e38\u7d27\u5f20\u7684\u73af\u5883\u6216\u8005\u670d\u52a1\u7aef\u5728\u5173\u95ed\u8fdb\u7a0b\u4e2d\u65f6\uff0c\u624d\u5e94\u8be5\u5173\u95ed\u8be5\u529f\u80fd\u3002 \nfunc (s *Server) SetKeepAlivesEnabled(v bool)\n\n// \u662f\u4e00\u4e2ahttp\u8bf7\u6c42\u591a\u8def\u590d\u7528\u5668\uff0c\u5b83\u5c06\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u7684URL\u548c\n// \u4e00\u4e2a\u6ce8\u518c\u6a21\u5f0f\u7684\u5217\u8868\u8fdb\u884c\u5339\u914d\uff0c\u7136\u540e\u8c03\u7528\u548cURL\u6700\u5339\u914d\u7684\u6a21\u5f0f\u7684\u5904\u7406\u5668\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c\u3002\ntype ServeMux\n\n// \u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684ServeMux \nfunc NewServeMux() *ServeMux\n\n// \u5c06handler\u6ce8\u518c\u4e3a\u6307\u5b9a\u7684\u6a21\u5f0f\uff0c\u5982\u679c\u8be5\u6a21\u5f0f\u5df2\u7ecf\u6709\u4e86handler\uff0c\u5219\u4f1a\u51fa\u9519panic\u3002\nfunc (mux *ServeMux) Handle(pattern string, handler Handler) \n\n// \u5c06handler\u6ce8\u518c\u4e3a\u6307\u5b9a\u7684\u6a21\u5f0f \nfunc (mux *ServeMux) HandleFunc(pattern string, handler func(ResponseWriter, *Request))\n\n// \u6839\u636e\u6307\u5b9a\u7684r.Method, r.Host\u4ee5\u53car.RUL.Path\u8fd4\u56de\u4e00\u4e2a\u7528\u6765\u5904\u7406\u7ed9\u5b9a\u8bf7\u6c42\u7684handler\u3002\n// \u8be5\u51fd\u6570\u603b\u662f\u8fd4\u56de\u4e00\u4e2a\u975enil\u7684 handler\uff0c\u5982\u679cpath\u4e0d\u662f\u4e00\u4e2a\u89c4\u8303\u683c\u5f0f\uff0c\u5219handler\u4f1a\n// \u91cd\u5b9a\u5411\u5230\u5176\u89c4\u8303path\u3002Handler\u603b\u662f\u8fd4\u56de\u5339\u914d\u8be5\u8bf7\u6c42\u7684\u7684\u5df2\u6ce8\u518c\u6a21\u5f0f\uff1b\u5728\u5185\u5efa\u91cd\u5b9a\u5411\n// \u5904\u7406\u5668\u7684\u60c5\u51b5\u4e0b\uff0cpattern\u4f1a\u5728\u91cd\u5b9a\u5411\u540e\u8fdb\u884c\u5339\u914d\u3002\u5982\u679c\u6ca1\u6709\u5df2\u6ce8\u518c\u6a21\u5f0f\u53ef\u4ee5\u5e94\u7528\u4e8e\u8be5\u8bf7\u6c42\uff0c\n// \u672c\u65b9\u6cd5\u5c06\u8fd4\u56de\u4e00\u4e2a\u5185\u5efa\u7684\u201d404 page not found\u201d\u5904\u7406\u5668\u548c\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u6a21\u5f0f\u3002\nfunc (mux *ServeMux) Handler(r *Request) (h Handler, pattern string) \n\n// \u8be5\u51fd\u6570\u7528\u4e8e\u5c06\u6700\u63a5\u8fd1\u8bf7\u6c42url\u6a21\u5f0f\u7684handler\u5206\u914d\u7ed9\u6307\u5b9a\u7684\u8bf7\u6c42\u3002 \nfunc (mux *ServeMux) ServeHTTP(w ResponseWriter, r *Request)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Handler\u63a5\u53e3\u5e94\u8be5\u7b97\u662fserver.go\u4e2d\u6700\u5173\u952e\u7684\u63a5\u53e3\u4e86\uff0c\u5982\u679c\u6211\u4eec\u4ed4\u7ec6\u770b\u8fd9\u4e2a\u6587\u4ef6\u7684\u6e90\u4ee3\u7801\uff0c\u5c06\u4f1a\u53d1\u73b0\u5f88\u591a\u7ed3\u6784\u4f53\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u63a5\u53e3\u7684ServeHTTP\u65b9\u6cd5\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\u8fd9\u4e2a\u63a5\u53e3\u7684\u6ce8\u91ca\uff1aHandler\u54cd\u5e94HTTP\u8bf7\u6c42\u3002\u6ca1\u9519\uff0c\u6700\u7ec8\u6211\u4eec\u7684http\u670d\u52a1\u662f\u901a\u8fc7\u5b9e\u73b0ServeHTTP(ResponseWriter, *Request)\u6765\u8fbe\u5230\u670d\u52a1\u7aef\u63a5\u6536\u5ba2\u6237\u7aef\u8bf7\u6c42\u5e76\u54cd\u5e94\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7406\u89e3 HTTP \u6784\u5efa\u7684\u7f51\u7edc\u5e94\u7528\u53ea\u8981\u5173\u6ce8\u4e24\u4e2a\u7aef---\u5ba2\u6237\u7aef\uff08Clinet\uff09\u548c\u670d\u52a1\u7aef\uff08Server\uff09\uff0c\u4e24\u4e2a\u7aef\u7684\u4ea4\u4e92\u6765\u81ea Clinet \u7684 Request\uff0c\u4ee5\u53caServer\u7aef\u7684Response\u3002HTTP\u670d\u52a1\u5668\uff0c\u4e3b\u8981\u5728\u4e8e\u5982\u4f55\u63a5\u53d7 Clinet\u7aef\u7684 Request\uff0cServer\u7aef\u5411Client\u7aef\u8fd4\u56deResponse\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u90a3\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u4ec0\u4e48\u6837\u7684\u5462\uff1f\u8981\u8bb2\u6e05\u695a\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u8fd8\u9700\u8981\u56de\u5230\u5f00\u59cb\u7684HTTP\u670d\u52a1\u5668\u7a0b\u5e8f\u3002\u8fd9\u91cc\u4ee5\u524d\u9762\u6211\u4eec\u4e86\u89e3\u5230\u7684http Request\u3001http Response\u3001http Client\u4f5c\u4e3a\u57fa\u7840\uff0c\u5e76\u91cd\u70b9\u5206\u6790server.go\u6e90\u4ee3\u7801\u624d\u80fd\u8bb2\u6e05\u695a\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func main() {\n    http.HandleFunc("/", myfunc)\n    http.ListenAndServe(":8080", nil)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u4ee5\u4e0a\u4e24\u884c\u4ee3\u7801\uff0c\u5c31\u6210\u529f\u542f\u52a8\u4e86\u4e00\u4e2aHTTP\u670d\u52a1\u5668\u3002\u6211\u4eec\u901a\u8fc7net/http \u5305\u6e90\u4ee3\u7801\u5206\u6790\u53d1\u73b0\uff0c\u8c03\u7528Http.HandleFunc\uff0c\u6309\u987a\u5e8f\u505a\u4e86\u51e0\u4ef6\u4e8b\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"1.Http.HandleFunc\u8c03\u7528\u4e86DefaultServeMux\u7684HandleFunc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"func HandleFunc(pattern string, handler func(ResponseWriter, *Request)) {\n    DefaultServeMux.HandleFunc(pattern, handler)\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"2.DefaultServeMux.HandleFunc\u8c03\u7528\u4e86DefaultServeMux\u7684Handle\uff0cDefaultServeMux\u662f\u4e00\u4e2aServeMux \u6307\u9488\u53d8\u91cf\u3002\u800cServeMux \u662fGo\u8bed\u8a00\u4e2d\u7684Multiplexer\uff08\u591a\u8def\u590d\u7528\u5668\uff09\uff0c\u901a\u8fc7Handle\u5339\u914dpattern \u548c\u6211\u4eec\u5b9a\u4e49\u7684handler\uff08\u5176\u5b9e\u5c31\u662fhttp.HandlerFunc\u51fd\u6570\u7c7b\u578b\u53d8\u91cf\uff09\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"var DefaultServeMux = &defaultServeMux\nvar defaultServeMux ServeMux\n\nfunc (mux *ServeMux) HandleFunc(pattern string, handler func(ResponseWriter, *Request)) {\n    mux.Handle(pattern, HandlerFunc(handler))\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\uff1a \u4e0a\u9762\u7684\u65b9\u6cd5\u547d\u540dHandle\uff0cHandleFunc\u548cHandlerFunc\uff0cHandler\uff08\u63a5\u53e3\uff09\uff0c\u4ed6\u4eec\u5f88\u76f8\u4f3c\uff0c\u5bb9\u6613\u6df7\u6dc6\u3002\u8bb0\u4f4fHandle\u548cHandleFunc\u548cpattern \u5339\u914d\u6709\u5173\uff0c\u4e5f\u5373\u5f80DefaultServeMux\u7684map[string]muxEntry\u4e2d\u589e\u52a0\u5bf9\u5e94\u7684handler\u548c\u8def\u7531\u89c4\u5219\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u7740\u6211\u4eec\u770b\u770bmyfunc\u7684\u58f0\u660e\u548c\u5b9a\u4e49\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func myfunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, "hi")\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u800c",(0,s.jsx)(n.code,{children:"type HandlerFunc func(ResponseWriter, *Request) "}),"\u662f\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\uff0c\u800c\u6211\u4eec\u5b9a\u4e49\u7684myfunc\u7684\u51fd\u6570\u7b7e\u540d\u521a\u597d\u7b26\u5408\u8fd9\u4e2a\u51fd\u6570\u7c7b\u578b\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u4ee5",(0,s.jsx)(n.code,{children:'http.HandleFunc("/", myfunc)'}),"\uff0c\u5b9e\u9645\u4e0a\u662f",(0,s.jsx)(n.code,{children:'mux.Handle("/", HandlerFunc(myfunc))'}),"\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"HandlerFunc(myfunc) \u8ba9myfunc\u6210\u4e3a\u4e86HandlerFunc\u7c7b\u578b\uff0c\u6211\u4eec\u79f0myfunc\u4e3ahandler\u3002\u800cHandlerFunc\u7c7b\u578b\u662f\u5177\u6709ServeHTTP\u65b9\u6cd5\u7684\uff0c\u800c\u6709\u4e86ServeHTTP\u65b9\u6cd5\u4e5f\u5c31\u662f\u5b9e\u73b0\u4e86Handler\u63a5\u53e3\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"func (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\n    f(w, r) // \u8fd9\u76f8\u5f53\u4e8e\u81ea\u8eab\u7684\u8c03\u7528\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u73b0\u5728ServeMux\u548cHandler\u90fd\u548c\u6211\u4eec\u7684myfunc\u8054\u7cfb\u4e0a\u4e86\uff0cmyfunc\u662f\u4e00\u4e2aHandler\u63a5\u53e3\u53d8\u91cf\u4e5f\u662fHandlerFunc\u7c7b\u578b\u53d8\u91cf\uff0c\u63a5\u4e0b\u6765\u548c\u7ed3\u6784\u4f53server\u6709\u5173\u4e86\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4ecehttp.ListenAndServe\u7684\u6e90\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u5b83\u521b\u5efa\u4e86\u4e00\u4e2aserver\u5bf9\u8c61\uff0c\u5e76\u8c03\u7528server\u5bf9\u8c61\u7684ListenAndServe\u65b9\u6cd5\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"func ListenAndServe(addr string, handler Handler) error {\n    server := &Server{Addr: addr, Handler: handler}\n    return server.ListenAndServe()\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u800c\u6211\u4eecHTTP\u670d\u52a1\u5668\u4e2d\u7b2c\u4e8c\u884c\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'http.ListenAndServe(":8080", nil)\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u521b\u5efa\u4e86\u4e00\u4e2aserver\u5bf9\u8c61\uff0c\u5e76\u8c03\u7528server\u5bf9\u8c61\u7684ListenAndServe\u65b9\u6cd5\uff0c\u8fd9\u91cc\u6ca1\u6709\u76f4\u63a5\u4f20\u9012Handler\uff0c\u800c\u662f\u9ed8\u8ba4\u4f7f\u7528DefautServeMux\u4f5c\u4e3amultiplexer\uff0cmyfunc\u662f\u5b58\u5728\u4e8ehandler\u548c\u8def\u7531\u89c4\u5219\u4e2d\u7684\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Server\u7684ListenAndServe\u65b9\u6cd5\u4e2d\uff0c\u4f1a\u521d\u59cb\u5316\u76d1\u542c\u5730\u5740Addr\uff0c\u540c\u65f6\u8c03\u7528Listen\u65b9\u6cd5\u8bbe\u7f6e\u76d1\u542c\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"for {\n    rw, e := l.Accept()\n    ...\n    c := srv.newConn(rw)\nc.setState(c.rwc, StateNew) \ngo c.serve(ctx)\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u76d1\u542c\u5f00\u542f\u4e4b\u540e\uff0c\u4e00\u65e6\u5ba2\u6237\u7aef\u8bf7\u6c42\u8fc7\u6765\uff0cGo\u5c31\u5f00\u542f\u4e00\u4e2a\u534f\u7a0bgo c.serve(ctx)\u5904\u7406\u8bf7\u6c42\uff0c\u4e3b\u8981\u903b\u8f91\u90fd\u5728serve\u65b9\u6cd5\u4e4b\u4e2d\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["func (c *conn) serve(ctx context.Context)\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5f88\u957f\uff0c\u91cc\u9762\u4e3b\u8981\u7684\u4e00\u53e5\uff1a",(0,s.jsx)(n.code,{children:"serverHandler{c.server}.ServeHTTP(w, w.req)"}),"\u3002\u5176\u4e2dw\u7531w, err := c.readRequest(ctx)\u5f97\u5230\uff0c\u56e0\u4e3a\u6709\u4f20\u9012context\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd8\u662f\u6765\u770b\u6e90\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'type serverHandler struct {\nsrv *Server\n}\n\nfunc (sh serverHandler) ServeHTTP(rw ResponseWriter, req Request) {\nhandler := sh.srv.Handler\nif handler == nil {\nhandler = DefaultServeMux\n}\nif req.RequestURI == "" && req.Method == "OPTIONS" {\nhandler = globalOptionsHandler{}\n}\nhandler.ServeHTTP(rw, req)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:'\u4ecehttp.ListenAndServe(":8080", nil)\u5f00\u59cb\uff0chandler\u662fnil\uff0c\u6240\u4ee5\u6700\u540e\u5b9e\u9645ServeHTTP\u65b9\u6cd5\u662fDefaultServeMux.ServeHTTP(rw, req)\u3002'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func (mux *ServeMux) ServeHTTP(w ResponseWriter, r *Request) {\n    if r.RequestURI == "*" {\n        if r.ProtoAtLeast(1, 1) {\n            w.Header().Set("Connection", "close")\n        }\n        w.WriteHeader(StatusBadRequest)\n        return\n    }\n    h, _ := mux.Handler(r)\n    h.ServeHTTP(w, r)\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u901a\u8fc7func (mux ",(0,s.jsx)(n.em,{children:"ServeMux) Handler(r"}),' Request) (h Handler, pattern string)\uff0c\u6211\u4eec\u5f97\u5230Handler h\uff0c\u7136\u540e\u6267\u884ch.ServeHTTP(w, r)\u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f\u6267\u884c\u6211\u4eec\u7684myfunc\u51fd\u6570\uff08\u522b\u5fd8\u4e86myfunc\u662fHandlerFunc\u7c7b\u578b\uff0c\u800c\u4ed6\u7684ServeHTTP(w, r)\u65b9\u6cd5\u8fd9\u91cc\u5176\u5b9e\u5c31\u662f\u81ea\u5df1\u8c03\u7528\u81ea\u5df1\uff09\uff0c\u628aresponse\u5199\u5230http.ResponseWriter\u5bf9\u8c61\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0cfmt.Fprintf(w, "hi")\uff0c\u6211\u4eec\u5728\u5ba2\u6237\u7aef\u4f1a\u63a5\u6536\u5230hi \u3002\u81f3\u6b64\u6574\u4e2aHTTP\u670d\u52a1\u6267\u884c\u5b8c\u6210\u3002']}),"\n",(0,s.jsx)(n.p,{children:"\u603b\u7ed3\u4e0b\uff0cHTTP\u670d\u52a1\u6574\u4e2a\u8fc7\u7a0b\u5927\u6982\u662f\u8fd9\u6837\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:"Request -> ServeMux(Multiplexer) -> handler-> Response\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u518d\u770b\u4e0b\u9762\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'http.ListenAndServe(":8080", nil)\nfunc ListenAndServe(addr string, handler Handler) error {\n    server := &Server{Addr: addr, Handler: handler}\n    return server.ListenAndServe()\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0a\u9762\u4ee3\u7801\u5b9e\u9645\u4e0a\u5c31\u662fserver.ListenAndServe()\u6267\u884c\u7684\u5b9e\u9645\u6548\u679c\uff0c\u53ea\u4e0d\u8fc7\u7b80\u5355\u58f0\u660e\u4e86\u4e00\u4e2a\u7ed3\u6784\u4f53",(0,s.jsx)(n.code,{children:"Server{Addr: addr, Handler: handler}"}),"\u5b9e\u4f8b\u3002\u5982\u679c\u6211\u4eec\u58f0\u660e\u4e00\u4e2aServer\u5b9e\u4f8b\uff0c\u5b8c\u5168\u53ef\u4ee5\u8fbe\u5230\u6df1\u5ea6\u81ea\u5b9a\u4e49 http.Server\u7684\u76ee\u7684\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'package main\n\nimport (\n    "fmt"\n    "net/http"\n)\n\nfunc myfunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, "hi")\n}\n\nfunc main() {\n    // \u66f4\u591ahttp.Server\u7684\u5b57\u6bb5\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u521d\u59cb\u5316\n    server := http.Server{\n        Addr:         ":8080",\n        ReadTimeout:  0,\n        WriteTimeout: 0,\n    }\n    http.HandleFunc("/", myfunc)\n    server.ListenAndServe()\n}\n\n\u8fd9\u6837\u670d\u52a1\u4e5f\u80fd\u8dd1\u8d77\u6765\uff0c\u800c\u4e14\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u6765\u81ea\u5b9a\u4e49\u6211\u4eec\u7684Server\uff01\n\n\u8fd8\u53ef\u4ee5\u6307\u5b9aServemux\u7684\u7528\u6cd5:\n\nGOPATH\\src\\go42\\chapter-15\\15.3\\7\\main.go\n\npackage main\n\nimport (\n    "fmt"\n    "net/http"\n)\n\nfunc myfunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, "hi")\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n\n    mux.HandleFunc("/", myfunc)\n    http.ListenAndServe(":8080", mux)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u65e2\u6307\u5b9aServemux\u53c8\u81ea\u5b9a\u4e49 http.Server\uff0c\u56e0\u4e3aServer\u4e2d\u6709\u5b57\u6bb5Handler\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628aServemux\u53d8\u91cf\u4f5c\u4e3aServer.Handler\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'package main\n\nimport (\n    "fmt"\n    "net/http"\n)\n\nfunc myfunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, "hi")\n}\n\nfunc main() {\n    server := http.Server{\n        Addr:         ":8080",\n        ReadTimeout:  0,\n        WriteTimeout: 0,\n    }\n    mux := http.NewServeMux()\n    server.Handler = mux\n\n    mux.HandleFunc("/", myfunc)\n    server.ListenAndServe()\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u524d\u9762pprof \u5305\u7684\u5185\u5bb9\u4e2d\u6211\u4eec\u4e5f\u7528\u4e86\u672c\u7ae0\u5f00\u5934\u8fd9\u6bb5\u4ee3\u7801\uff0c\u5f53\u6211\u4eec\u8bbf\u95ee",(0,s.jsx)(n.a,{href:"http://localhost:8080/debug/pprof/",children:"http://localhost:8080/debug/pprof/"}),' \u65f6\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684\u6027\u80fd\u5206\u6790\u62a5\u544a\u3002 \u56e0\u4e3a\u6211\u4eec\u8fd9\u6837\u5bfc\u5165 _"net/http/pprof" \u5305\u65f6\uff0c\u5728\u6587\u4ef6 pprof.go \u6587\u4ef6\u4e2dinit \u51fd\u6570\u5df2\u7ecf\u5b9a\u4e49\u597d\u4e86handler\uff1a']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func init() {\n    http.HandleFunc("/debug/pprof/", Index)\n    http.HandleFunc("/debug/pprof/cmdline", Cmdline)\n    http.HandleFunc("/debug/pprof/profile", Profile)\n    http.HandleFunc("/debug/pprof/symbol", Symbol)\n    http.HandleFunc("/debug/pprof/trace", Trace)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee\u4e0a\u9762\u5730\u5740\u6765\u770b\u5230\u62a5\u544a\u3002\u73b0\u5728\u518d\u6765\u770b\u8fd9\u4e9b\u4ee3\u7801\uff0c\u6211\u4eec\u5c31\u660e\u767d\u600e\u4e48\u56de\u4e8b\u4e86\uff01"}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u5904\u7406\u5668custom-handlers",children:"\u81ea\u5b9a\u4e49\u5904\u7406\u5668\uff08Custom Handlers\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u7684Handler\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u6807\u51c6\u5e93http\u63d0\u4f9b\u4e86Handler\u63a5\u53e3\uff0c\u7528\u4e8e\u5f00\u53d1\u8005\u5b9e\u73b0\u81ea\u5df1\u7684handler\u3002\u53ea\u8981\u5b9e\u73b0\u63a5\u53e3\u7684ServeHTTP\u65b9\u6cd5\u5373\u53ef\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'package main\n\nimport (\n    "log"\n    "net/http"\n    "time"\n)\n\ntype timeHandler struct {\n    format string\n}\n\nfunc (th *timeHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    tm := time.Now().Format(th.format)\n    w.Write([]byte("The time is: " + tm))\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n\n    th := &timeHandler{format: time.RFC1123}\n    mux.Handle("/time", th)\n\n    log.Println("Listening...")\n    http.ListenAndServe(":3000", mux)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u77e5\u9053\uff0cNewServeMux\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aServeMux\u5b9e\u4f8b\uff0cServeMux\u540c\u65f6\u4e5f\u5b9e\u73b0\u4e86ServeHTTP\u65b9\u6cd5\uff0c\u56e0\u6b64\u4ee3\u7801\u4e2d\u7684mux\u4e5f\u662f\u4e00\u79cdhandler\u3002\u628a\u5b83\u5f53\u6210\u53c2\u6570\u4f20\u7ed9http.ListenAndServe\u65b9\u6cd5\uff0c\u540e\u8005\u4f1a\u628amux\u4f20\u7ed9Server\u5b9e\u4f8b\u3002\u56e0\u4e3a\u6307\u5b9a\u4e86handler\uff0c\u56e0\u6b64\u6574\u4e2ahttp\u670d\u52a1\u5c31\u4e0d\u518d\u662fDefaultServeMux\uff0c\u800c\u662fmux\uff0c\u65e0\u8bba\u662f\u5728\u6ce8\u518c\u8def\u7531\u8fd8\u662f\u63d0\u4f9b\u8bf7\u6c42\u670d\u52a1\u7684\u65f6\u5019\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4efb\u4f55\u6709 func(http.ResponseWriter\uff0c*http.Request) \u7b7e\u540d\u7684\u51fd\u6570\u90fd\u80fd\u8f6c\u5316\u4e3a\u4e00\u4e2a HandlerFunc \u7c7b\u578b\u3002\u8fd9\u5f88\u6709\u7528\uff0c\u56e0\u4e3a HandlerFunc \u5bf9\u8c61\u5185\u7f6e\u4e86 ServeHTTP \u65b9\u6cd5\uff0c\u540e\u8005\u53ef\u4ee5\u806a\u660e\u53c8\u65b9\u4fbf\u7684\u8c03\u7528\u6211\u4eec\u6700\u521d\u63d0\u4f9b\u7684\u51fd\u6570\u5185\u5bb9\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u5c06\u51fd\u6570\u4f5c\u4e3a\u5904\u7406\u5668",children:"\u5c06\u51fd\u6570\u4f5c\u4e3a\u5904\u7406\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'package main\n\nimport (\n    "log"\n    "net/http"\n    "time"\n)\n\nfunc timeHandler(w http.ResponseWriter, r *http.Request) {\n    tm := time.Now().Format(time.RFC1123)\n    w.Write([]byte("The time is: " + tm))\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n\n    // Convert the timeHandler function to a HandlerFunc type\n    th := http.HandlerFunc(timeHandler)\n    // And add it to the ServeMux\n    mux.Handle("/time", th)\n\n    log.Println("Listening...")\n    http.ListenAndServe(":3000", mux)\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u521b\u5efa\u65b0\u7684server\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func index(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set("Content-Type", "text/html")\n\n    html := `<doctype html>\n        <html>\n        <head>\n          <title>Hello World</title>\n        </head>\n        <body>\n        <p>\n          Welcome\n        </p>\n        </body>\n</html>`\n    fmt.Fprintln(w, html)\n}\n\nfunc main(){\n    http.HandleFunc("/", index)\n\n    server := &http.Server{\n        Addr: ":8000", \n        ReadTimeout: 60 * time.Second, \n        WriteTimeout: 60 * time.Second, \n    }\n    server.ListenAndServe()\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u4e2d\u95f4\u4ef6middleware",children:"\u4e2d\u95f4\u4ef6Middleware"}),"\n",(0,s.jsx)(n.p,{children:"\u6240\u8c13\u4e2d\u95f4\u4ef6\uff0c\u5c31\u662f\u8fde\u63a5\u4e0a\u4e0b\u7ea7\u4e0d\u540c\u529f\u80fd\u7684\u51fd\u6570\u6216\u8005\u8f6f\u4ef6\uff0c\u901a\u5e38\u8fdb\u884c\u4e00\u4e9b\u5305\u88f9\u51fd\u6570\u7684\u884c\u4e3a\uff0c\u4e3a\u88ab\u5305\u88f9\u51fd\u6570\u63d0\u4f9b\u6dfb\u52a0\u4e00\u4e9b\u529f\u80fd\u6216\u884c\u4e3a\u3002\u524d\u6587\u7684HandleFunc\u5c31\u80fd\u628a\u7b7e\u540d\u4e3a func(w http.ResponseWriter, r *http.Reqeust)\u7684\u51fd\u6570\u5305\u88f9\u6210handler\u3002\u8fd9\u4e2a\u51fd\u6570\u4e5f\u7b97\u662f\u4e2d\u95f4\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Go\u7684http\u4e2d\u95f4\u4ef6\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u5b9e\u73b0\u4e00\u4e2a\u51fd\u6570\u7b7e\u540d\u4e3afunc(http.Handler) http.Handler\u7684\u51fd\u6570\u5373\u53ef\u3002http.Handler\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u63a5\u53e3\u65b9\u6cd5\u6211\u4eec\u719f\u6089\u7684\u4e3aserveHTTP\u3002\u8fd4\u56de\u4e5f\u662f\u4e00\u4e2ahandler\u3002\u56e0\u4e3aGo\u4e2d\u7684\u51fd\u6570\u4e5f\u53ef\u4ee5\u5f53\u6210\u53d8\u91cf\u4f20\u9012\u6216\u8005\u6216\u8005\u8fd4\u56de\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u5728\u4e2d\u95f4\u4ef6\u51fd\u6570\u4e2d\u4f20\u9012\u5b9a\u4e49\u597d\u7684\u51fd\u6570\uff0c\u53ea\u8981\u8fd9\u4e2a\u51fd\u6570\u662f\u4e00\u4e2ahandler\u5373\u53ef\uff0c\u5373\u5b9e\u73b0\u6216\u8005\u88abhandlerFunc\u5305\u88f9\u6210\u4e3ahandler\u5904\u7406\u5668\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Go",children:'func index(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set("Content-Type", "text/html")\n\n    html := `<doctype html>\n        <html>\n        <head>\n          <title>Hello World</title>\n        </head>\n        <body>\n        <p>\n          Welcome\n        </p>\n        </body>\n</html>`\n    fmt.Fprintln(w, html)\n}\n\nfunc middlewareHandler(next http.Handler) http.Handler{\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n        // \u6267\u884chandler\u4e4b\u524d\u7684\u903b\u8f91\n        next.ServeHTTP(w, r)\n        // \u6267\u884c\u5b8c\u6bd5handler\u540e\u7684\u903b\u8f91\n    })\n}\n\nfunc loggingHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        start := time.Now()\n        log.Printf("Started %s %s", r.Method, r.URL.Path)\n        next.ServeHTTP(w, r)\n        log.Printf("Completed %s in %v", r.URL.Path, time.Since(start))\n    })\n}\n\nfunc main() {\n    http.Handle("/", loggingHandler(http.HandlerFunc(index)))\n\n    http.ListenAndServe(":8000", nil)\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},3268:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/hello-fad9ba7343b4d8ae8e8f478597c0a1d2.png"},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>i});var t=r(6540);const s={},l=t.createContext(s);function d(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);