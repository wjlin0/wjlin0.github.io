<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-个人知识库/渗透测试/WEB漏洞/SQL注入/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">SQL注入 | wjlin0</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blog.wjlin0.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blog.wjlin0.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blog.wjlin0.com/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SQL注入 | wjlin0"><meta data-rh="true" name="description" content="介绍"><meta data-rh="true" property="og:description" content="介绍"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.wjlin0.com/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/"><link data-rh="true" rel="alternate" href="https://blog.wjlin0.com/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/" hreflang="zh"><link data-rh="true" rel="alternate" href="https://blog.wjlin0.com/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.wjlin0.com/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"SQL注入","item":"https://blog.wjlin0.com/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/"}]}</script><link rel="stylesheet" href="/en/assets/css/styles.b3fb48aa.css">
<script src="/en/assets/js/runtime~main.13522329.js" defer="defer"></script>
<script src="/en/assets/js/main.24108175.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/en/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">知识库</b></a><a href="https://www.wjlin0.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">博客<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://icp.wjlin0.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ICP备案查询<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/wjlin0/wjlin0.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/intro"><span title="intro" class="linkLabel_WmDU">intro</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en/docs/个人知识库/渗透测试/信息收集/"><span title="个人知识库" class="categoryLinkLabel_W154">个人知识库</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/en/docs/个人知识库/渗透测试/信息收集/"><span title="渗透测试" class="categoryLinkLabel_W154">渗透测试</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/en/docs/个人知识库/渗透测试/信息收集/"><span title="信息收集" class="categoryLinkLabel_W154">信息收集</span></a><button aria-label="Expand sidebar category &#x27;信息收集&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/"><span title="WEB漏洞" class="categoryLinkLabel_W154">WEB漏洞</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/"><span title="SQL注入" class="categoryLinkLabel_W154">SQL注入</span></a><button aria-label="Collapse sidebar category &#x27;SQL注入&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/注入判断"><span title="注入判断" class="linkLabel_WmDU">注入判断</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/数据库识别"><span title="数据库识别" class="linkLabel_WmDU">数据库识别</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/Oracle"><span title="Oracle" class="linkLabel_WmDU">Oracle</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/MySQL"><span title="MySQL" class="linkLabel_WmDU">MySQL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/PostgreSQL"><span title="PostgreSQL" class="linkLabel_WmDU">PostgreSQL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/SQLite"><span title="SQLite" class="linkLabel_WmDU">SQLite</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/MSSQL"><span title="MSSQL" class="linkLabel_WmDU">MSSQL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/HQL"><span title="HQL" class="linkLabel_WmDU">HQL</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/DB2"><span title="DB2" class="linkLabel_WmDU">DB2</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/Cassandra"><span title="Cassandra" class="linkLabel_WmDU">Cassandra</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/BigQuery"><span title="BigQuery" class="linkLabel_WmDU">BigQuery</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/XSS注入/"><span title="XSS注入" class="categoryLinkLabel_W154">XSS注入</span></a><button aria-label="Expand sidebar category &#x27;XSS注入&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SSRF/"><span title="SSRF漏洞" class="linkLabel_WmDU">SSRF漏洞</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/渗透测试/工具使用/PathScan"><span title="工具使用" class="categoryLinkLabel_W154">工具使用</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/渗透测试/内网渗透/MSF提权"><span title="内网渗透" class="categoryLinkLabel_W154">内网渗透</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/渗透测试/渗透手法/某大学渗透测试/"><span title="渗透手法" class="categoryLinkLabel_W154">渗透手法</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/渗透测试/免杀/fscan免杀/"><span title="免杀" class="categoryLinkLabel_W154">免杀</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/个人知识库/渗透测试/基线检查/"><span title="基线检查" class="linkLabel_WmDU">基线检查</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/漏洞复现/Thinkphp/Thinkphp5.0.22远程代码执行"><span title="漏洞复现" class="categoryLinkLabel_W154">漏洞复现</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/代码审计/Java/基础审计/JAVA反序列化漏洞"><span title="代码审计" class="categoryLinkLabel_W154">代码审计</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/疑难杂症/k3s/Traefik资源跨命名空间调用/"><span title="疑难杂症" class="categoryLinkLabel_W154">疑难杂症</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/en/docs/个人知识库/语言知识/"><span title="语言知识" class="categoryLinkLabel_W154">语言知识</span></a><button aria-label="Expand sidebar category &#x27;语言知识&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/pathScan-doc/下载安装"><span title="pathScan-doc" class="categoryLinkLabel_W154">pathScan-doc</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/CTF/Knownsec/knownsec-ctf-09/"><span title="CTF" class="categoryLinkLabel_W154">CTF</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/工具分享/RAGFlow安装/"><span title="工具分享" class="categoryLinkLabel_W154">工具分享</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/en/docs/个人知识库/漏洞合集/中间件/Apache/Kafka Connect任意文件读取漏洞（CVE-2025-27817）"><span title="漏洞合集" class="categoryLinkLabel_W154">漏洞合集</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/更新日志"><span title="更新日志" class="linkLabel_WmDU">更新日志</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">个人知识库</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">渗透测试</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">WEB漏洞</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">SQL注入</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SQL注入</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="Direct link to 介绍" title="Direct link to 介绍" translate="no">​</a></h2>
<p>SQL是操作<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93/103728?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">数据库</a>数据的结构化查询语言，网页的应用数据和后台数据库中的数据进行交互时会采用SQL。而SQL注入是将Web页面的原<a href="https://baike.baidu.com/item/URL/110640?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">URL</a>、表单域或数据包输入的参数，修改拼接成SQL语句，传递给Web服务器，进而传给<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1%E5%99%A8/613818?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">数据库服务器</a>以执行数据库命令。如Web应用程序的开发人员对用户所输入的数据或cookie等内容不进行过滤或验证(即存在注入点)就直接传输给数据库，就可能导致拼接的SQL被执行，获取对数据库的信息以及提权，发生<a href="https://baike.baidu.com/item/SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/4766224?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">SQL注入攻击</a>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="产生原因">产生原因<a href="#产生原因" class="hash-link" aria-label="Direct link to 产生原因" title="Direct link to 产生原因" translate="no">​</a></h2>
<p>SQL注入产生的原因是网站应用程序在编写时未对用户提交至服务器的数据进行合法性校验（类型、长度、业务参数合法性、敏感字符等），同时没有对用户输入数据进行有效地特殊字符过滤，使得用户的输入直接带入数据库执行，超出了SQL语句原来设计的预期结果，导致了SQL注入漏洞。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="注入举例">注入举例<a href="#注入举例" class="hash-link" aria-label="Direct link to 注入举例" title="Direct link to 注入举例" translate="no">​</a></h2>
<blockquote>
<p>通过万能密码的举例，来简单讲解SQL注入</p>
</blockquote>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$conn = mysqli_connect($servername, $username, $password, $dbname);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (!$conn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(&quot;Connection failed: &quot; . mysqli_connect_error());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$username = @$_POST[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$password = @$_POST[&#x27;password&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sql = &quot;select * from users where username = &#x27;$username&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$rs = mysqli_query($conn,$sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if($rs-&gt;fetch_row()){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;success&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;fail&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>用户名<code>username</code>和密码<code>password</code>均来自于用户的直接传入，无任何过滤，后直接拼接到SQL语句中。</p>
<p>正常用户登录是，正常sql语句为：</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> username </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><br></span></code></pre></div></div>
<p>攻击者带恶意的SQL语句输入的用户名为<code>admin</code>，密码为<code>123&#x27; or 1 = 1 --+ </code>，因为 1=1 永真，所以也就会登录成功</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="应用场景">应用场景<a href="#应用场景" class="hash-link" aria-label="Direct link to 应用场景" title="Direct link to 应用场景" translate="no">​</a></h2>
<p><strong>SQL注入漏洞可能出现在一切与数据库交互的地方</strong>，常见举例如下（主要还是存在于<strong>增删改查</strong>四个字上）：</p>
<blockquote>
<p>简而言之：所有和数据库交互的点均可能存在SQL注入</p>
</blockquote>
<table><thead><tr><th style="text-align:left">关键字</th><th style="text-align:left">功能举例</th></tr></thead><tbody><tr><td style="text-align:left">增</td><td style="text-align:left">注册新用户、创建订单、添加文章……</td></tr><tr><td style="text-align:left">删</td><td style="text-align:left">删除用户、删除订单……</td></tr><tr><td style="text-align:left">改</td><td style="text-align:left">修改订单、更新用户信息……</td></tr><tr><td style="text-align:left">查</td><td style="text-align:left">查询信息、筛选订单、搜索文章……</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="关系非关系数据库">关系、非关系数据库<a href="#关系非关系数据库" class="hash-link" aria-label="Direct link to 关系、非关系数据库" title="Direct link to 关系、非关系数据库" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="关系型数据库sql">关系型数据库（SQL）<a href="#关系型数据库sql" class="hash-link" aria-label="Direct link to 关系型数据库（SQL）" title="Direct link to 关系型数据库（SQL）" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="什么是sql关系型数据库">什么是（SQL）关系型数据库<a href="#什么是sql关系型数据库" class="hash-link" aria-label="Direct link to 什么是（SQL）关系型数据库" title="Direct link to 什么是（SQL）关系型数据库" translate="no">​</a></h4>
<blockquote>
<p>关系型数据库指的是使用关系模型（二维表格模型）来组织数据的数据库。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="什么是关系模型">什么是关系模型<a href="#什么是关系模型" class="hash-link" aria-label="Direct link to 什么是关系模型" title="Direct link to 什么是关系模型" translate="no">​</a></h4>
<blockquote>
<p>关系模型可以简单理解为二维表格模型，而一个关系型数据库就是由二维表及其之间的关系组成的一个数据组织。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="常见关系型数据库管理系统ordbms">常见关系型数据库管理系统(<a href="https://baike.baidu.com/item/ORDBMS/870762" target="_blank" rel="noopener noreferrer">ORDBMS</a>)<a href="#常见关系型数据库管理系统ordbms" class="hash-link" aria-label="Direct link to 常见关系型数据库管理系统ordbms" title="Direct link to 常见关系型数据库管理系统ordbms" translate="no">​</a></h4>
<ol>
<li>Oracle</li>
<li>MySql</li>
<li>Microsoft SQL Server</li>
<li>SQLite</li>
<li>PostgreSQL</li>
<li>IBM DB2</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="关系型数据库的优势">关系型数据库的优势<a href="#关系型数据库的优势" class="hash-link" aria-label="Direct link to 关系型数据库的优势" title="Direct link to 关系型数据库的优势" translate="no">​</a></h4>
<ol>
<li>采用二维表结构非常贴近正常开发逻辑（关系型数据模型相对层次型数据模型和网状型数据模型等其他模型来说更容易理解）；</li>
<li>支持通用的SQL（结构化查询语言）语句；</li>
<li>丰富的完整性大大减少了数据冗余和数据不一致的问题。并且全部由表结构组成，文件格式一致；</li>
<li>可以用SQL句子多个表之间做非常繁杂的查询；</li>
<li>关系型数据库提供对事务的支持，能保证系统中事务的正确执行，同时提供事务的恢复、回滚、并发控制和死锁问题的解决。</li>
<li>数据存储在磁盘中，安全可靠。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="关系型数据库的劣势">关系型数据库的劣势<a href="#关系型数据库的劣势" class="hash-link" aria-label="Direct link to 关系型数据库的劣势" title="Direct link to 关系型数据库的劣势" translate="no">​</a></h4>
<blockquote>
<p><strong>随着互联网企业的不断发展，数据日益增多，因此关系型数据库面对海量的数据会存在很多的不足。</strong></p>
</blockquote>
<ol>
<li>高并发读写能力差：网站类用户的并发性访问非常高，而一台数据库的最大连接数有限，且硬盘 I/O 有限，不能满足很多人同时连接。</li>
<li>海量数据情况下读写效率低：对<a href="https://cloud.tencent.com/solution/bigdata?from=10680" target="_blank" rel="noopener noreferrer">大数据</a>量的表进行读写操作时，需要等待较长的时间等待响应。</li>
<li>可扩展性不足：不像web server和app server那样简单的添加硬件和服务节点来拓展性能和负荷工作能力。</li>
<li>数据模型灵活度低：关系型数据库的数据模型定义严格，无法快速容纳新的数据类型（需要提前知道需要存储什么样类型的数据）。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="非关系型数据库nosql">非关系型数据库（NOSQL）<a href="#非关系型数据库nosql" class="hash-link" aria-label="Direct link to 非关系型数据库（NOSQL）" title="Direct link to 非关系型数据库（NOSQL）" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="什么是nosql非关系型数据库">什么是（NOSQL）非关系型数据库：<a href="#什么是nosql非关系型数据库" class="hash-link" aria-label="Direct link to 什么是（NOSQL）非关系型数据库：" title="Direct link to 什么是（NOSQL）非关系型数据库：" translate="no">​</a></h4>
<blockquote>
<p>非关系型数据库又被称为 NoSQL（Not Only SQL )，意为不仅仅是 SQL。通常指数据以对象的形式存储在数据库中，而对象之间的关系通过每个对象自身的属性来决定，常用于存储非结构化的数据。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="常见的nosql数据库">常见的NOSQL数据库<a href="#常见的nosql数据库" class="hash-link" aria-label="Direct link to 常见的NOSQL数据库" title="Direct link to 常见的NOSQL数据库" translate="no">​</a></h4>
<ol>
<li>键值数据库：Redis、Memcached、Riak</li>
<li>列族数据库：Bigtable、<a href="https://cloud.tencent.com/product/hbase?from=10680" target="_blank" rel="noopener noreferrer">HBase</a>、Cassandra</li>
<li>文档数据库：MongoDB、CouchDB、MarkLogic</li>
<li>图形数据库：Neo4j、InfoGrid</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="非关系型数据库的优势">非关系型数据库的优势<a href="#非关系型数据库的优势" class="hash-link" aria-label="Direct link to 非关系型数据库的优势" title="Direct link to 非关系型数据库的优势" translate="no">​</a></h4>
<ol>
<li>非关系型数据库存储数据的格式可以是 key-value 形式、文档形式、图片形式等。使用灵活，应用场景广泛，而关系型数据库则只支持基础类型。</li>
<li>速度快，效率高。 NoSQL 可以使用硬盘或者随机存储器作为载体，而关系型数据库只能使用硬盘。</li>
<li>海量数据的维护和处理非常轻松，成本低。</li>
<li>非关系型数据库具有扩展简单、高并发、高稳定性、成本低廉的优势。</li>
<li>可以实现数据的分布式处理。</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="非关系型数据库的劣势">非关系型数据库的劣势<a href="#非关系型数据库的劣势" class="hash-link" aria-label="Direct link to 非关系型数据库的劣势" title="Direct link to 非关系型数据库的劣势" translate="no">​</a></h4>
<ol>
<li>非关系型数据库暂时不提供 SQL 支持，学习和使用成本较高。</li>
<li>非关系数据库没有事务处理，无法保证数据的完整性和安全性。适合处理海量数据，但是不一定安全。</li>
<li>功能没有关系型数据库完善。</li>
<li>复杂表关联查询不容易实现。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="漏洞危害">漏洞危害<a href="#漏洞危害" class="hash-link" aria-label="Direct link to 漏洞危害" title="Direct link to 漏洞危害" translate="no">​</a></h2>
<ol>
<li>获取数据库访问权限，甚至获得DBA权限，从而获取数据库中的所有数据，造成信息泄漏；（<strong>可获取数据</strong>）</li>
<li>对数据库的数据进行增加、删除、修改操作，例如删除数据库中重要数据的表（<strong>可进行增删改操作</strong>）</li>
<li>通过构造特殊的数据库语句，可操作数据库进入后台或者插入木马，以获取整个网站和数据库的控制权限，篡改网页，发布不良信息等；（<strong>可获取网站权限</strong>）</li>
<li>获取服务器最高权限，远程控制服务器，甚至导致局域网(内网)被入侵；（<strong>可获取服务器权限</strong>）</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="修复建议">修复建议<a href="#修复建议" class="hash-link" aria-label="Direct link to 修复建议" title="Direct link to 修复建议" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="代码层面">代码层面<a href="#代码层面" class="hash-link" aria-label="Direct link to 代码层面" title="Direct link to 代码层面" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="输入过滤正则过滤">输入过滤（正则过滤）<a href="#输入过滤正则过滤" class="hash-link" aria-label="Direct link to 输入过滤（正则过滤）" title="Direct link to 输入过滤（正则过滤）" translate="no">​</a></h4>
<ol>
<li>严格控制输入数据的类型；如通过id获取用户信息时，仅允许传入的id为整型</li>
<li>严格控制输入数据的长度；如限制用户名长度应小于20</li>
<li>输入合法性判断；禁止出现一些特殊字符或关键词，如<code>&#x27;</code>，<code>&quot;</code>，<code>\</code>，<code>&lt;</code>，<code>&gt;</code>，<code>&amp;</code>，<code>*</code>，<code>;</code>，<code>#</code>，<code>select</code>，<code>from</code>，<code>where</code>，<code>sub</code>，<code>if</code>，<code>union</code>，<code>sleep</code>，<code>and</code>，<code>or</code>等</li>
<li>对所有可能的输入点进行判断检测，如UA、IP、Cookie等</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="预编译sql语句参数化查询">预编译SQL语句(参数化查询)<a href="#预编译sql语句参数化查询" class="hash-link" aria-label="Direct link to 预编译SQL语句(参数化查询)" title="Direct link to 预编译SQL语句(参数化查询)" translate="no">​</a></h4>
<p>参数化查询是一种查询类型，其中占位符用于填充参数，参数值在执行时提供。原理是采用了预编译的方法，先将SQL语句中可被用户控制的参数集进行编译，生成对应的临时变量集，再使用对应的设置方法，为临时变量集里面的元素进行赋值，赋值过程中会对传入的参数进行强制类型检查和安全检查。</p>
<p>所有与数据库交互的业务接口均采用参数化查询，参数化的语句使用参数而不是将用户输入变量直接嵌入到SQL语句中，参数化查询是防御SQL注入的最佳方法，比如：Java中的<code>PreparedStatement</code>，PHP中的<code>PDO</code>等。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="预编译以及原理">预编译以及原理<a href="#预编译以及原理" class="hash-link" aria-label="Direct link to 预编译以及原理" title="Direct link to 预编译以及原理" translate="no">​</a></h5>
<p>预编译是指在创建数据库对象时就将指定的SQL语句编译完成，这时SQL语句已经被<code>解析、审查</code>，所以相对传统的执行方式(每处理一个SQL语句就要解析SQL语句、检查语法和语义)，预编译方式在执行数据插入、更新或者删除操作的时候，执行效率更高。</p>
<p><code>为什么预编译能让传入的数据只能是数据，它的底层原理是怎样的？</code></p>
<p>通常来说，一条SQL语句从传入到运行经历了生成<code>语法树、执行计划优化、执行</code>这几个阶段。在预编译过程中，数据库首先接收到带有预编译占位符<code>?</code>的SQL语句，解析<code>生成语法树(Lex)</code>，并缓存在<code>cache</code>中，然后接收对应的参数信息，从<code>cache</code>中取出语法树设置参数，然后再进行优化和执行。由于参数信息传入前语法树就已生成，执行的语法结构也就无法因参数而改变，自然也就杜绝了SQL注入的出现.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="pdo">PDO<a href="#pdo" class="hash-link" aria-label="Direct link to PDO" title="Direct link to PDO" translate="no">​</a></h5>
<p>PDO针对预编译提供了两种模式：本地预编译和模拟预编译。</p>
<p>模拟预编译：本身不是一种真正的预编译，它是为了兼容不支持预编译的数据库，将用户输入的参数进行转义，拼接到数据库，由<code>数据库正常解析执行</code>。所以它的<code>预编译</code> 操作是由pdo 完成的 数据库本身没有参与预编译 <strong>并且这是PDO的默认模式</strong></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="演示">演示<a href="#演示" class="hash-link" aria-label="Direct link to 演示" title="Direct link to 演示" translate="no">​</a></h5>
<p>1、开启MySQL日志，查看日志</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$hostname =&#x27;127.0.0.1&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$dbname=&#x27;ctf&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$conn = new PDO( &quot;mysql:host=$hostname;dbname=$dbname&quot;,&#x27;root&#x27;,&#x27;root123456&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//$sql = &#x27;select * from admin where id =\&#x27;&#x27;.$id.&#x27;\&#x27;&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sql =&quot;select * from admin where id =?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos = $conn -&gt;prepare($sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos-&gt;bindParam(1,$_GET[&#x27;id&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos-&gt;execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var_dump($pdos-&gt;fetchAll());</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:29:59.198823Z	    9 Connect	root@localhost on ctf using TCP/IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:29:59.199095Z	    9 Query	select * from admin where id =&#x27;\&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:29:59.199806Z	    9 Quit	</span><br></span></code></pre></div></div>
<p>如日志所示，mysql本身没有预编译操作，只有<code>连接</code>，<code>查询</code>，<code>关闭</code> 三个操作。</p>
<p>2、开启本地预编译模式</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$hostname =&#x27;127.0.0.1&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$dbname=&#x27;ctf&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$conn = new PDO( &quot;mysql:host=$hostname;dbname=$dbname&quot;,&#x27;root&#x27;,&#x27;root123456&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$conn -&gt; setAttribute(PDO::ATTR_EMULATE_PREPARES, false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//$sql = &#x27;select * from admin where id =\&#x27;&#x27;.$id.&#x27;\&#x27;&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sql =&quot;select * from admin where id =?&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos = $conn -&gt;prepare($sql);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos-&gt;bindParam(1,$_GET[&#x27;id&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$pdos-&gt;execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var_dump($pdos-&gt;fetchAll());</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:36:24.438190Z	   10 Connect	root@localhost on ctf using TCP/IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:36:24.439940Z	   10 Prepare	select * from admin where id =?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:36:24.440013Z	   10 Execute	select * from admin where id =&#x27;\&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:36:24.440433Z	   10 Close stmt	</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-28T05:36:24.440474Z	   10 Quit	</span><br></span></code></pre></div></div>
<p>如日志所示，整个流程分为五部 <code>连接</code>，<code>预编译</code>，<code>传入参数执行</code>，<code>关闭预编译语句</code>，<code>关闭数据库</code></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="0x04-危害">0x04 危害<a href="#0x04-危害" class="hash-link" aria-label="Direct link to 0x04 危害" title="Direct link to 0x04 危害" translate="no">​</a></h5>
<p>如果使用模拟预编译模式 ，则可能会导致出现<code>宽字节注入漏洞</code>,<code>二次注入漏洞</code>(之前文章写到)</p>
<p>1、<a href="https://wjlin0.com/archives/sql%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5" target="_blank" rel="noopener noreferrer">sql二次注入 - wjlin0</a></p>
<p>2、<a href="https://wjlin0.com/archives/sql%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5" target="_blank" rel="noopener noreferrer">sql宽字节注入 - wjlin0</a></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="0x05-总结">0x05 总结<a href="#0x05-总结" class="hash-link" aria-label="Direct link to 0x05 总结" title="Direct link to 0x05 总结" translate="no">​</a></h5>
<p>1、本次了解mysql的预编译处理能够使用户传入的数据只能是数据，而预编译是提前生成<strong>语法树</strong> 使其用户不能改变原有的语法结构，从而预防了SQL注入的产生。</p>
<p>2、了解了PHP的PDO两种预编译模式  <code>本地预编译</code>，<code>模拟预编译</code> 后者只是由pdo代执行‘预编译操作‘ ，不能算真正意义上的预编译，就会出现<code>宽字节注入</code>和<code>二次注入</code>的风险。而PDO默认模式就是模拟预编译，所以再执行时，最好设置</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$PDO -&gt; setAttribute(PDO::ATTR_EMULATE_PREPARES, false);</span><br></span></code></pre></div></div>
<p>3、同样的JAVA也存在类似的问题，以后学习后再补充。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据库层面">数据库层面<a href="#数据库层面" class="hash-link" aria-label="Direct link to 数据库层面" title="Direct link to 数据库层面" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="最小权限原则">最小权限原则<a href="#最小权限原则" class="hash-link" aria-label="Direct link to 最小权限原则" title="Direct link to 最小权限原则" translate="no">​</a></h4>
<p>遵循最小化权限原则，严格限制网站用户的数据库的操作权限，禁止将任何高权限帐户（sa，dba、root等）用于应用程序数据库访问，从而最大限度的减少注入攻击对数据库的危害。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="禁用敏感函数">禁用敏感函数<a href="#禁用敏感函数" class="hash-link" aria-label="Direct link to 禁用敏感函数" title="Direct link to 禁用敏感函数" translate="no">​</a></h4>
<p>防止攻击者通过SQL注入获取到除数据库外的其他更高权限，如系统权限等；</p>
<p>比如MSSQL中，拒绝用户访问敏感的系统存储过程，如<code>xp_dirtree</code>、<code>xp_cmdshell</code>等。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="权限控制">权限控制<a href="#权限控制" class="hash-link" aria-label="Direct link to 权限控制" title="Direct link to 权限控制" translate="no">​</a></h4>
<p>限制用户仅能够访问必须使用的数据库表。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="统一编码">统一编码<a href="#统一编码" class="hash-link" aria-label="Direct link to 统一编码" title="Direct link to 统一编码" translate="no">​</a></h4>
<p>网站与数据层的编码统一，建议全部使用UTF-8编码，避免因上下层编码不一致导致一些过滤模型被绕过，比如宽字节注入等。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="其他层面">其他层面<a href="#其他层面" class="hash-link" aria-label="Direct link to 其他层面" title="Direct link to 其他层面" translate="no">​</a></h3>
<ol>
<li>网站应避免抛出SQL语句执行过程中的错误信息，如类型错误、字段不匹配等，防止攻击者利用这些错误信息进行一些判断；</li>
<li>使用通用防注入系统，或者部署WAF等。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="靶场">靶场<a href="#靶场" class="hash-link" aria-label="Direct link to 靶场" title="Direct link to 靶场" translate="no">​</a></h2>
<ul>
<li>
<p><a href="https://github.com/digininja/DVWA" target="_blank" rel="noopener noreferrer">DVWA</a></p>
</li>
<li>
<p><a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="noopener noreferrer">sqli-labs</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考">参考<a href="#参考" class="hash-link" aria-label="Direct link to 参考" title="Direct link to 参考" translate="no">​</a></h2>
<ul>
<li>
<p><a href="https://blog.nowcoder.net/n/be73b8f592504ae8b1d00368433061be" target="_blank" rel="noopener noreferrer">深入理解SQL注入与预编译（下）_牛客博客 (nowcoder.net)</a></p>
</li>
<li>
<p><a href="https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/02.WEB%E6%BC%8F%E6%B4%9E/01.SQL%E6%B3%A8%E5%85%A5/" target="_blank" rel="noopener noreferrer">SQL注入 · d4m1ts 知识库</a></p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/个人知识库/01.渗透测试/02.WEB漏洞/01.SQL注入/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/个人知识库/渗透测试/信息收集/资产收集/主域名收集/google查询"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">google查询</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/个人知识库/渗透测试/WEB漏洞/SQL注入/注入判断"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">注入判断</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#介绍" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#产生原因" class="table-of-contents__link toc-highlight">产生原因</a></li><li><a href="#注入举例" class="table-of-contents__link toc-highlight">注入举例</a></li><li><a href="#应用场景" class="table-of-contents__link toc-highlight">应用场景</a></li><li><a href="#关系非关系数据库" class="table-of-contents__link toc-highlight">关系、非关系数据库</a><ul><li><a href="#关系型数据库sql" class="table-of-contents__link toc-highlight">关系型数据库（SQL）</a></li><li><a href="#非关系型数据库nosql" class="table-of-contents__link toc-highlight">非关系型数据库（NOSQL）</a></li></ul></li><li><a href="#漏洞危害" class="table-of-contents__link toc-highlight">漏洞危害</a></li><li><a href="#修复建议" class="table-of-contents__link toc-highlight">修复建议</a><ul><li><a href="#代码层面" class="table-of-contents__link toc-highlight">代码层面</a></li><li><a href="#数据库层面" class="table-of-contents__link toc-highlight">数据库层面</a></li><li><a href="#其他层面" class="table-of-contents__link toc-highlight">其他层面</a></li></ul></li><li><a href="#靶场" class="table-of-contents__link toc-highlight">靶场</a></li><li><a href="#参考" class="table-of-contents__link toc-highlight">参考</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">内容导航</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><rect x="3" y="4" width="14" height="16" rx="2" fill="currentColor"></rect><rect x="5" y="6" width="10" height="1.5" fill="white" opacity="0.9"></rect><rect x="5" y="9" width="10" height="1.5" fill="white" opacity="0.9"></rect></svg>个人知识库</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/更新日志"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2"></circle><polyline points="12,7 12,12 16,14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>日志更新</a></li><li class="footer__item"><a class="footer__link-item" href="https://www.wjlin0.com/links"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="8,5 16,12 8,19" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>友链</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">实用工具</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="8,5 16,12 8,19" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>微信公众号写文章助手</a></li><li class="footer__item"><a class="footer__link-item" href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="8,5 16,12 8,19" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>GTFOBins</a></li><li class="footer__item"><a class="footer__link-item" href="https://revshells.com" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="8,5 16,12 8,19" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>红队工具</a></li><li class="footer__item"><a class="footer__link-item" href="https://regex-vis.com/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="8,5 16,12 8,19" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>正则可视化</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">关注我</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://github.com/wjlin0" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><polyline points="7,8 4,12 7,16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline><polyline points="17,8 20,12 17,16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline><line x1="10" y1="18" x2="14" y2="6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="mailto:admin@wjlin0.com" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><rect x="3" y="6" width="18" height="12" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"></rect><polyline points="4,7 12,13 20,7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></polyline></svg>联系我</a></li><li class="footer__item"><a class="footer__link-item" href="https://www.wjlin0.com/links#add"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px;vertical-align:text-bottom"><circle cx="12" cy="12" r="8" stroke="currentColor" stroke-width="2" fill="none"></circle><line x1="12" y1="8" x2="12" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line><line x1="8" y1="12" x2="16" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line></svg>添加友链</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 wjlin0 知识库</div></div></div></footer></div>
</body>
</html>